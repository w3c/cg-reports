<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 35.2.0">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
pre.idl{padding:1em;position:relative}
pre.idl>code{color:#000;color:var(--text,#000)}
@media print{
pre.idl{white-space:pre-wrap}
}
.idlHeader{display:block;width:150px;background:#8ccbf2;background:var(--def-border,#8ccbf2);color:#fff;color:var(--defrow-border,#fff);font-family:sans-serif;font-weight:700;margin:-1em 0 1em -1em;height:28px;line-height:28px}
.idlHeader a.self-link{margin-left:.3cm;text-decoration:none;border-bottom:none;color:inherit}
.idlID{font-weight:700;color:#005a9c}
.idlType{color:#005a9c}
.idlName{color:#ff4500}
.idlName a{color:#ff4500;border-bottom:1px dotted #ff4500;text-decoration:none}
a.idlEnumItem{color:#000;border-bottom:1px dotted #ccc;text-decoration:none}
.idlSuperclass{font-style:italic;color:#005a9c}
.idlDefaultValue,.idlParamName{font-style:italic}
.extAttr{color:#666}
.idlSectionComment{color:gray}
.idlIncludes a{font-weight:700}
.respec-button-copy-paste:focus{text-decoration:none;border-color:#51a7e8;outline:0;box-shadow:0 0 5px rgba(81,167,232,.5)}
.respec-button-copy-paste:is(:focus:hover,.selected:focus){border-color:#51a7e8}
.respec-button-copy-paste:is(:hover,:active,.zeroclipboard-is-hover,.zeroclipboard-is-active){text-decoration:none;background-color:#ddd;background-image:linear-gradient(#eee,#ddd);border-color:#ccc}
.respec-button-copy-paste:is(:active,.selected,.zeroclipboard-is-active){background-color:#dcdcdc;background-image:none;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}
.respec-button-copy-paste.selected:hover{background-color:#cfcfcf}
.respec-button-copy-paste:is(:disabled,:disabled:hover,.disabled,.disabled:hover){color:rgba(102,102,102,.5);cursor:default;background-color:rgba(229,229,229,.5);background-image:none;border-color:rgba(197,197,197,.5);box-shadow:none}
@media print{
.respec-button-copy-paste{visibility:hidden}
}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
<title>Timing Object</title>
    
    
    
    
<style type="text/css">

      table { border-collapse: collapse; border-style: hidden hidden none hidden; }
      table thead, table tbody { border-bottom: solid; }
      table td, table th { border-left: solid; border-right: solid; border-bottom: solid thin; vertical-align: top; padding: 0.2em; }
    
</style>
  
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<meta name="color-scheme" content="light">
<meta name="description" content="This specification defines the timing object. The timing object is a local object that may be used by Web clients to ensure precisely timed operation as well as flexible timing control. If multiple timing-sensitive components take direction from the same timing object, their behaviour will be precisely aligned in time (synchronized). Crucially, this is also the case in distributed settings. A central motivation for the timing object is that it may be connected to an online timing resource. This way, the local timing object is a gateway to precisely timed operations, both in single-device and multi-device scenarios.">
<link rel="canonical" href="https://www.w3.org/community/reports/webtiming/CG-FINAL-timingobject-20241203/">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#222}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#222;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "CG-FINAL",
  "latestVersion": "https://www.w3.org/community/reports/webtiming/CG-FINAL-timingobject-20241203/",
  "edDraftURI": "https://webtiming.github.io/timingobject",
  "shortName": "timingobject",
  "editors": [
    {
      "name": "Ingar M. Arntzen",
      "company": "Norut Northern Research Institute and Motion Corporation",
      "companyURL": "https://motioncorporation.com/",
      "mailto": "ingar.arntzen@motioncorporation.com",
      "url": "mailto:ingar.arntzen@motioncorporation.com"
    },
    {
      "name": "François Daoust",
      "company": "W3C",
      "companyURL": "https://www.w3.org",
      "mailto": "fd@w3.org",
      "url": "mailto:fd@w3.org"
    }
  ],
  "authors": [
    {
      "name": "Njål T. Borch",
      "company": "Norut Northern Research Institute and Motion Corporation",
      "companyURL": "https://motioncorporation.com/",
      "mailto": "njaal.borch@motioncorporation.com",
      "url": "mailto:njaal.borch@motioncorporation.com"
    }
  ],
  "group": "webtiming",
  "github": "webtiming/timingobject",
  "xref": [
    "dom",
    "webidl",
    "html"
  ],
  "localBiblio": {
    "LINEARCOMPOSITION": {
      "title": "Multi-device Linear Composition on the Web: Enabling Multi-device Linear Media with HTMLTimingObject and Shared Motion",
      "href": "https://sites.google.com/site/mediasynchronization/Paper4_Arntzen_webComposition_CR.pdf?attredirects=0&d=1",
      "authors": [
        "Ingar M. Arntzen",
        "Njål T. Borch",
        "François Daoust",
        "Dominique Hazaël-Massieux"
      ],
      "id": "linearcomposition"
    },
    "MSV": {
      "title": "The Media State Vector: A unifying concept for multi-device media navigation",
      "href": "https://dl.acm.org/citation.cfm?doid=2457413.2457427",
      "authors": [
        "Ingar M. Arntzen",
        "Njål T. Borch",
        "Christopher P. Needham"
      ],
      "id": "msv"
    },
    "DVB-CSS": {
      "title": "ETSI TS 103 286-2 V1.1.1 Digital Video Broadcasting (DVB); Companion Screens and Streams; Part 2: Content Identification and Media Synchronization",
      "href": "https://www.etsi.org/deliver/etsi_ts/103200_103299/10328602/01.01.01_60/ts_10328602v010101p.pdf",
      "id": "dvb-css"
    },
    "SHAREDMOTION": {
      "title": "Shared Motion",
      "href": "https://motioncorporation.com"
    },
    "MEDIASYNC": {
      "title": "MediaSync",
      "href": "https://github.com/webtiming/mediasync",
      "id": "mediasync"
    },
    "SEQUENCER": {
      "title": "Open-source sequencer library",
      "href": "https://github.com/webtiming/sequencer",
      "id": "sequencer"
    }
  },
  "publishISODate": "2024-12-03T00:00:00.000Z",
  "generatedSubtitle": "Final Community Group Report 03 December 2024"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/cg-final"></head>
  <body class="h-entry" data-cite="WEBIDL dom webidl html"><div class="head">
    
    <h1 id="title" class="title">Timing Object</h1> 
    <p id="w3c-state">
      <a href="https://www.w3.org/standards/types#reports">Final Community Group Report</a>
      <time class="dt-published" datetime="2024-12-03">03 December 2024</time>
    </p>
    <dl>
      <dt>This version:</dt><dd>
              <a class="u-url" href="https://www.w3.org/community/reports/webtiming/CG-FINAL-timingobject-20241203/">https://www.w3.org/community/reports/webtiming/CG-FINAL-timingobject-20241203/</a>
            </dd>
      <dt>Latest published version:</dt><dd>
              <a href="https://www.w3.org/community/reports/webtiming/CG-FINAL-timingobject-20241203/">https://www.w3.org/community/reports/webtiming/CG-FINAL-timingobject-20241203/</a>
            </dd>
      <dt>Latest editor's draft:</dt><dd><a href="https://webtiming.github.io/timingobject">https://webtiming.github.io/timingobject</a></dd>
      
      
      
      
      <dt>Editors:</dt><dd class="editor p-author h-card vcard">
    <a class="ed_mailto u-email email p-name" href="mailto:ingar.arntzen@motioncorporation.com">Ingar M. Arntzen</a> (<a class="p-org org h-org" href="https://motioncorporation.com/">Norut Northern Research Institute and Motion Corporation</a>)
  </dd><dd class="editor p-author h-card vcard">
    <a class="ed_mailto u-email email p-name" href="mailto:fd@w3.org">François Daoust</a> (<a class="p-org org h-org" href="https://www.w3.org">W3C</a>)
  </dd>
      
      <dt>Author:</dt><dd class="editor p-author h-card vcard">
    <a class="ed_mailto u-email email p-name" href="mailto:njaal.borch@motioncorporation.com">Njål T. Borch</a> (<a class="p-org org h-org" href="https://motioncorporation.com/">Norut Northern Research Institute and Motion Corporation</a>)
  </dd>
      <dt>Feedback:</dt><dd>
        <a href="https://github.com/webtiming/timingobject/">GitHub webtiming/timingobject</a>
        (<a href="https://github.com/webtiming/timingobject/pulls/">pull requests</a>,
        <a href="https://github.com/webtiming/timingobject/issues/new/choose">new issue</a>,
        <a href="https://github.com/webtiming/timingobject/issues/">open issues</a>)
      </dd>
      
    </dl>
    
    <p class="copyright">
          <a href="https://www.w3.org/policies/#copyright">Copyright</a>
          ©
          2024
          
          the Contributors to the Timing Object
          Specification, published by the
          <a href="https://www.w3.org/groups/cg/webtiming">Multi-device Timing Community Group</a> under the
          <a href="https://www.w3.org/community/about/agreements/fsa/">W3C Community Final Specification Agreement (FSA)</a>. A human-readable
                <a href="https://www.w3.org/community/about/agreements/fsa-deed/">summary</a>
                is available.
              
        </p>
    <hr title="Separator for header">
  </div>



    

    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
        This specification defines the timing object. The timing object is a local object that may be used by Web clients to ensure precisely timed operation as well as flexible timing control. If multiple timing-sensitive components take direction from the same timing object, their behaviour will be precisely aligned in time (synchronized). Crucially, this is also the case in distributed settings. A central motivation for the timing object is that it may be connected to an online timing resource. This way, the local timing object is a gateway to precisely timed operations, both in single-device and multi-device scenarios.
      </p>
  

      <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="3"><span>Note</span></div><p class="">
        This timing object is not to be confused with concepts proposed by 
        <a href="https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/NavigationTiming/Overview.html">Navigation Timing</a>, an initiative targeting precise measurement of time consumption in Web browsers.
      </p></div>

    </section>




    

    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>
      This specification was published by the
      <a href="https://www.w3.org/groups/cg/webtiming">Multi-device Timing Community Group</a>. It is not a W3C Standard nor is it
      on the W3C Standards Track.
      
            Please note that under the
            <a href="https://www.w3.org/community/about/agreements/final/">W3C Community Final Specification Agreement (FSA)</a>
            other conditions apply.
          
      Learn more about
      <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>.
    </p>
      <div class="advisement">
        <p>
          This specification is incomplete. Some procedures are either missing or described as <em>similar to procedures defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>]</em>. The main goal of this draft is to propose a technical solution and show how it could be integrated in [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>].
        </p>
        <p>
          <strong>Work on this document has been discontinued</strong>. This document is provided as-is in the hope that it may prove a useful basis for renewed discussions on a timing model for the Web in the future. Interested parties are encouraged to reach out to the <a href="https://www.w3.org/groups/ig/me/">Media and Entertainment Interest Group</a> for coordination, through its <a href="mailto:public-web-and-tv@w3.org">public-web-and-tv@w3.org</a> mailing-list (<a href="https://lists.w3.org/Archives/Public/public-web-and-tv/">archives</a>).
        </p>
      </div>
    </section>
    <nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#linear-composition"><bdi class="secno">1.1 </bdi>Linear composition</a></li><li class="tocline"><a class="tocxref" href="#design-goals"><bdi class="secno">1.2 </bdi>Design goals</a></li><li class="tocline"><a class="tocxref" href="#the-timing-object"><bdi class="secno">1.3 </bdi>The timing object</a></li><li class="tocline"><a class="tocxref" href="#programming-with-timing-objects"><bdi class="secno">1.4 </bdi>Programming with timing objects</a></li><li class="tocline"><a class="tocxref" href="#connecting-the-timing-object"><bdi class="secno">1.5 </bdi>Connecting the timing object</a></li><li class="tocline"><a class="tocxref" href="#media-capture-and-playback"><bdi class="secno">1.6 </bdi>Media capture and playback</a></li><li class="tocline"><a class="tocxref" href="#reference-point-in-capture-and-playback"><bdi class="secno">1.7 </bdi>Reference point in capture and playback</a></li><li class="tocline"><a class="tocxref" href="#naming"><bdi class="secno">1.8 </bdi>Naming</a></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">2. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">3. </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#examples"><bdi class="secno">4. </bdi>Examples</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#query"><bdi class="secno">4.1 </bdi>Query</a></li><li class="tocline"><a class="tocxref" href="#update"><bdi class="secno">4.2 </bdi>Update</a></li><li class="tocline"><a class="tocxref" href="#polling"><bdi class="secno">4.3 </bdi>Polling</a></li><li class="tocline"><a class="tocxref" href="#update-event"><bdi class="secno">4.4 </bdi>Update Event</a></li><li class="tocline"><a class="tocxref" href="#connect-to-a-media-element"><bdi class="secno">4.5 </bdi>Connect to a media element</a></li><li class="tocline"><a class="tocxref" href="#connect-to-a-timing-text-track"><bdi class="secno">4.6 </bdi>Connect to a timing text track</a></li><li class="tocline"><a class="tocxref" href="#connect-to-a-timing-provider"><bdi class="secno">4.7 </bdi>Connect to a timing provider</a></li></ol></li><li class="tocline"><a class="tocxref" href="#timing-object"><bdi class="secno">5. </bdi>Timing Object</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#create-a-new-timing-object"><bdi class="secno">5.1 </bdi>Create a new timing object</a></li><li class="tocline"><a class="tocxref" href="#process-a-query-operation"><bdi class="secno">5.2 </bdi>Process a query operation</a></li><li class="tocline"><a class="tocxref" href="#process-an-update-operation"><bdi class="secno">5.3 </bdi>Process an update operation</a></li><li class="tocline"><a class="tocxref" href="#set-the-internal-timeout"><bdi class="secno">5.4 </bdi>Set the internal timeout</a></li><li class="tocline"><a class="tocxref" href="#cover-a-position"><bdi class="secno">5.5 </bdi>Cover a position</a></li><li class="tocline"><a class="tocxref" href="#process-vector-change"><bdi class="secno">5.6 </bdi>Process Vector Change</a></li><li class="tocline"><a class="tocxref" href="#process-skew-change"><bdi class="secno">5.7 </bdi>Process Skew Change</a></li><li class="tocline"><a class="tocxref" href="#translate-timestamp-from-user-agent-to-timing-resource-provider-timeline"><bdi class="secno">5.8 </bdi>Translate timestamp from user agent to timing resource provider timeline</a></li><li class="tocline"><a class="tocxref" href="#translate-timestamp-from-timing-resource-provider-to-user-agent-timeline"><bdi class="secno">5.9 </bdi>Translate timestamp from timing resource provider to user agent timeline</a></li><li class="tocline"><a class="tocxref" href="#calculate-skew-adjustment"><bdi class="secno">5.10 </bdi>Calculate skew adjustment</a></li><li class="tocline"><a class="tocxref" href="#connection-states"><bdi class="secno">5.11 </bdi>Connection states</a></li><li class="tocline"><a class="tocxref" href="#event-handlers"><bdi class="secno">5.12 </bdi>Event handlers</a></li></ol></li><li class="tocline"><a class="tocxref" href="#timing-provider-object"><bdi class="secno">6. </bdi>Timing Provider Object</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#process-an-update-operation-0"><bdi class="secno">6.1 </bdi>Process an update operation</a></li><li class="tocline"><a class="tocxref" href="#report-new-conditions-of-the-current-motion"><bdi class="secno">6.2 </bdi>Report new conditions of the current motion</a></li><li class="tocline"><a class="tocxref" href="#report-a-state-change"><bdi class="secno">6.3 </bdi>Report a state change</a></li><li class="tocline"><a class="tocxref" href="#report-a-skew-change"><bdi class="secno">6.4 </bdi>Report a skew change</a></li><li class="tocline"><a class="tocxref" href="#report-an-error"><bdi class="secno">6.5 </bdi>Report an error</a></li></ol></li><li class="tocline"><a class="tocxref" href="#state-vector"><bdi class="secno">7. </bdi>State Vector</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#create-a-new-state-vector"><bdi class="secno">7.1 </bdi>Create a new state vector</a></li></ol></li><li class="tocline"><a class="tocxref" href="#media-elements-and-the-timing-object"><bdi class="secno">8. </bdi><span class="formerLink" data-link-type="dfn">Media elements</span> and the <span class="formerLink" data-link-type="dfn">timing object</span></a><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction-0"><bdi class="secno">8.1 </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#procedure-set-the-current-timing-object-for-media-element"><bdi class="secno">8.2 </bdi>Procedure: Set the current <span class="formerLink" data-link-type="dfn">timing object</span> for <span class="formerLink" data-link-type="dfn">media element</span>.</a></li><li class="tocline"><a class="tocxref" href="#procedure-set-the-current-media-controller-for-media-element"><bdi class="secno">8.3 </bdi>Procedure: Set the current media controller for <span class="formerLink" data-link-type="dfn">media element</span></a></li><li class="tocline"><a class="tocxref" href="#procedure-set-the-current-position-for-media-element"><bdi class="secno">8.4 </bdi>Procedure: Set the current position for <span class="formerLink" data-link-type="dfn">media element</span></a></li><li class="tocline"><a class="tocxref" href="#procedure-check-error-in-time-alignment-for-media-element"><bdi class="secno">8.5 </bdi>Procedure: Check error in time-alignment for <span class="formerLink" data-link-type="dfn">media element</span></a></li><li class="tocline"><a class="tocxref" href="#procedure-time-align-media-element-with-timing-object"><bdi class="secno">8.6 </bdi>Procedure: Time-align <span class="formerLink" data-link-type="dfn">media element</span> with <span class="formerLink" data-link-type="dfn">timing object</span></a></li></ol></li><li class="tocline"><a class="tocxref" href="#timed-data-and-the-timing-object"><bdi class="secno">9. </bdi>Timed data and the timing object</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction-1"><bdi class="secno">9.1 </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#timing-text-track"><bdi class="secno">9.2 </bdi>Timing text track</a></li><li class="tocline"><a class="tocxref" href="#procedure-create-a-new-timing-text-track"><bdi class="secno">9.3 </bdi>Procedure: Create a new <span class="formerLink" data-link-type="dfn">timing text track</span></a></li><li class="tocline"><a class="tocxref" href="#procedure-associate-timing-text-track-with-a-timing-object"><bdi class="secno">9.4 </bdi>Procedure: Associate <span class="formerLink" data-link-type="dfn">timing text track</span> with a <span class="formerLink" data-link-type="dfn">timing object</span></a></li><li class="tocline"><a class="tocxref" href="#procedure-track-marches-on"><bdi class="secno">9.5 </bdi>Procedure: Track marches on</a></li></ol></li><li class="tocline"><a class="tocxref" href="#implementation-guidelines-multi-device-synchronization"><bdi class="secno">A. </bdi>Implementation guidelines multi-device synchronization</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#state-vector-synchronization"><bdi class="secno">A.1 </bdi>State vector synchronization</a></li><li class="tocline"><a class="tocxref" href="#clock-synchronization"><bdi class="secno">A.2 </bdi>Clock synchronization</a></li></ol></li><li class="tocline"><a class="tocxref" href="#use-cases-and-requirements"><bdi class="secno">B. </bdi>Use cases and requirements</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#social-viewing-and-media-control"><bdi class="secno">B.1 </bdi> Social Viewing and Media Control</a></li><li class="tocline"><a class="tocxref" href="#broadcasting-time-consistent-live-web-productions"><bdi class="secno">B.2 </bdi> Broadcasting - Time-consistent, Live Web Productions </a></li><li class="tocline"><a class="tocxref" href="#broadcasting-time-shifted-live-web-productions"><bdi class="secno">B.3 </bdi> Broadcasting - Time-shifted, Live Web productions </a></li><li class="tocline"><a class="tocxref" href="#broadcasting-timed-web-based-secondary-device"><bdi class="secno">B.4 </bdi> Broadcasting - Timed, Web-based Secondary Device </a></li><li class="tocline"><a class="tocxref" href="#online-education-timed-multi-device-web-presentations"><bdi class="secno">B.5 </bdi> Online Education - Timed, Multi-device Web Presentations </a></li><li class="tocline"><a class="tocxref" href="#multi-screen-data-visualization"><bdi class="secno">B.6 </bdi> Multi-Screen Data Visualization </a></li><li class="tocline"><a class="tocxref" href="#seamless-workflows"><bdi class="secno">B.7 </bdi> Seamless Workflows </a></li><li class="tocline"><a class="tocxref" href="#alternative-soundtracks"><bdi class="secno">B.8 </bdi> Alternative Soundtracks </a></li><li class="tocline"><a class="tocxref" href="#timing-interoperability-between-independent-providers"><bdi class="secno">B.9 </bdi> Timing Interoperability between Independent Providers </a></li><li class="tocline"><a class="tocxref" href="#linear-content-adaptation"><bdi class="secno">B.10 </bdi> Linear Content Adaptation </a></li><li class="tocline"><a class="tocxref" href="#distributed-capture-and-replayability"><bdi class="secno">B.11 </bdi> Distributed Capture and Replayability </a></li><li class="tocline"><a class="tocxref" href="#distributed-music-production-and-playback"><bdi class="secno">B.12 </bdi> Distributed Music Production and Playback  </a></li><li class="tocline"><a class="tocxref" href="#ad-insertion-and-time-sensitive-ads"><bdi class="secno">B.13 </bdi> Ad-insertion and Time-sensitive Ads </a></li></ol></li><li class="tocline"><a class="tocxref" href="#idl-index"><bdi class="secno">C. </bdi>IDL Index</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">D. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">D.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">D.2 </bdi>Informative references</a></li></ol></li></ol></nav>
    



    

    <section class="informative" id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div><p><em>This section is non-normative.</em></p>
      
      
      <p>
        Timing mechanisms allow operations to be executed at the correct time. The Web already has several mechanisms supporting timed operations, including <code>setTimeout</code>, <code>setInterval</code>, as well as media frameworks and animation frameworks for timed media presentation. Unfortunately, these mechanisms are limited in scope as they only apply to timed operations within a single web page. The <a href="https://www.w3.org/community/webtiming/">W3C Multi-device Timing Community Group</a> has been formed with the goal of extending the Web with native support for precisely timed operation across Web pages hosted by different devices, as well as providing a unifying timing model to which all frameworks for timed operation may integrate. The timing object is the central concept in this initiative.
      </p>

      <p>
        Synchronized playback of multi-device linear media is an important use-case for multi-device timing. However, multi-device timing has wide utility for a variety of timing related challenges, including distributed media control and remote control, distributed synchronization, distributed time-shifting, distributed time-ordering and distributed capture/recording (time-stamping). This way, multi-device timing has applicability in many application domains, including TV and radio (broadcast and IP-based), secondary device applications, online education, VoD services, social and collaborative media, data visualization, music etc.
      </p>
      <p>
        For a more detailed list of use cases that this specification enables, see <a href="#use-cases-and-requirements" class="sec-ref"><bdi class="secno">B. </bdi>Use cases and requirements</a>.
      </p>


      <section id="linear-composition"><div class="header-wrapper"><h3 id="x1-1-linear-composition"><bdi class="secno">1.1 </bdi>Linear composition</h3><a class="self-link" href="#linear-composition" aria-label="Permalink for Section 1.1"></a></div>
        

        <p>
          <dfn data-lt="linear composition|linear composability|Linear composition" id="dfn-linear-composition" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Linear composition</dfn> or <dfn class="lint-ignore" id="dfn-temporal-composition" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">temporal composition</dfn> is simply the idea that complex linear media can be built from simpler, independent linear components. Web support for linear composition would imply that classical benefits of composition, i.e. flexibility, reusability, extensibility and mashup-ability, apply to the construction of Web-based linear media. For example, in the single-device scenario, imagine a linear presentation made from HTML video, some timed meta-information, a SMIL component, a Web Animation, a map with timed georeferenced data, and a timed Twitter widget. Or, in the multi-device scenario, imagine the same components distributed or duplicated across multiple devices in a room or within a social group. In both cases linear composition requires temporal interoperability among heterogeneous linear components, available through precisely coordinated, timed playback.
        </p>
        <p>
          Unfortunately, Web support for linear composition is not optimal. Each media framework tends to define its own custom timing control mechanisms, making it difficult to achieve <a href="#dfn-linear-composition" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linear-composition-1">linear composition</a> in practice. The central purpose of the timing object is thus to simplify interoperability by providing a common basis for timed operation and control in linear media.
        </p>
        <p>
          For a more detailed introduction to linear composition on the Web, see [<cite><a class="bibref" data-link-type="biblio" href="#bib-linearcomposition" title="Multi-device Linear Composition on the Web: Enabling Multi-device Linear Media with HTMLTimingObject and Shared Motion">LINEARCOMPOSITION</a></cite>].
        </p>
      </section>

      <section id="design-goals"><div class="header-wrapper"><h3 id="x1-2-design-goals"><bdi class="secno">1.2 </bdi>Design goals</h3><a class="self-link" href="#design-goals" aria-label="Permalink for Section 1.2"></a></div>
        

        <p>
          The design of the timing object has two main goals:
        </p>
        <ol>
          <li>
            <b>provide a unifying API for timed operation and temporal control</b> that timed components can integrate with. This would include timing sensitive Web applications in general, as well as existing frameworks for timed media — such as <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-1">media elements</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>], Web Animations [<cite><a class="bibref" data-link-type="biblio" href="#bib-web-animations-1" title="Web Animations">WEB-ANIMATIONS-1</a></cite>], Web Audio API [<cite><a class="bibref" data-link-type="biblio" href="#bib-webaudio" title="Web Audio API">WEBAUDIO</a></cite>] and SMIL Timing [<cite><a class="bibref" data-link-type="biblio" href="#bib-smil3" title="Synchronized Multimedia Integration Language (SMIL 3.0)">SMIL3</a></cite>]. The API must support highly precise timing and be expressive enough to support control primitives appropriate for a wide range of media types and applications.
          </li>
          <li> 
            <b>encapsulate complexity of distributed time synchronization</b>, thereby allowing integrating frameworks to be included in precisely timed multi-device operation. In particular, by providing the same API for local and online timing resources, timed components may be used in single-device and multi-device scenarios, without modification. 
          </li>
        </ol>

        <p>
          <a href="#fig-timingobject-overview">Fig. 1</a> illustrates these functions, including an online service to provide multi-device timing. In this example, a timing object is instantiated on each of the three devices, and each instance is connected to a single, shared online timing resource. On each device, the timing object acts as the director for independent, timing-sensitive User Interface (UI) components. This way, a video will aim to present video frames in accordance with the timing resource. Similarly, a timing-sensitive Twitter widget might replay timestamped Tweets. If the timing object pauses, all the connected components are notified and react accordingly. Note that the different UI components may go about their business in complete isolation. There is no need for components to communicate, except indirectly through the timing object. This loose coupling is the key to <a href="#dfn-linear-composition" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linear-composition-2">linear composability</a>.
        </p>

        <figure id="fig-timingobject-overview">
          <img src="overview.png" width="400" alt="The image illustrates the concept of an online timing resource how it used to synchronize HTTPTimingObjects across three different Web clients.">
          <figcaption><a class="self-link" href="#fig-timingobject-overview">Figure <bdi class="figno">1</bdi></a> <span class="fig-title">Timing objects on three devices connected to the same online timing resource</span></figcaption>
        </figure>

        <p>
          Furthermore, when timing objects are connected to an online timing resource, they merely act as local representatives. For example, when requested to pause, the timing object will simply forward the request to the online timing resource. As the online object pauses, notifications will be multicast to all connected clients. The timing object will only update its internal state and notify connected UI components when it receives this notification. For online timing objects, clients can expect update latency of about one round trip time (RTT), whereas local timing resources should have no update latency. Apart from this, online and local timing resources should be hard to distinguish. Note also that the argument made for the independence of timing-sensitive components in the single-device scenario now applies to the multi-device scenario as well. 
        </p>

        <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="4"><span>Note</span></div><p class="">
          This specification describes the integration of timing objects with HTML Media elements and text tracks. Integration with other frameworks for timed operation, such as Web Animation, SMIL, and WebAudio will be covered separately.
        </p></div>
      </section>



      




      <section id="the-timing-object"><div class="header-wrapper"><h3 id="x1-3-the-timing-object"><bdi class="secno">1.3 </bdi>The timing object</h3><a class="self-link" href="#the-timing-object" aria-label="Permalink for Section 1.3"></a></div>
        
        <p>
          The timing object is a very simple object, essentially an advanced stop watch (<a href="#fig-stopwatch">Fig. 2</a>). If started, its value changes predictably in time, until at some point later, it is paused, or perhaps reset. It may be queried for its value at any time. For example, it should take exactly 2.0 seconds for the value to advance from 3.0 to 5.0 when the velocity is 1.0. Such deterministic behavior is required for reliable distributed synchronization. In terms of implementation, the timing object is a fairly thin wrapping around a monotonic system clock (integration with online timing resources adds complexity). The precision of the timing object is limited by the underlying system clock.
        </p>
        <figure id="fig-stopwatch">
          <img src="stopwatch_digital.jpg" width="160" alt="The timing object is essentially an advanced stop watch.">
          <figcaption><a class="self-link" href="#fig-stopwatch">Figure <bdi class="figno">2</bdi></a> <span class="fig-title">The timing object is essentially an advanced stop watch.</span></figcaption>
        </figure>

        <p>
          The timing object is more expressive than a traditional stop watch. It supports any velocity or acceleration, and may jump (instantaneously) to any position on the timeline (<a href="#fig-timeline">Fig. 3</a>). In fact, a timing object essentially implements <em>linear motion along a unidimensional axis</em>. State vectors [<cite><a class="bibref" data-link-type="biblio" href="#bib-msv" title="The Media State Vector: A unifying concept for multi-device media navigation">MSV</a></cite>], based on the classical equations of linear motion under constant acceleration, are used to represent that motion. At any point in time, position, velocity or acceleration may be requested to change. Querying the timing object reveals not only its current position but also its velocity and acceleration at that moment. The expressiveness of this model implies that a wide variety of control primitives can be supported. For example, discrete jumps on the timeline may be used to control a slide show, or velocity may correspond to <code>playbackRate</code> for the control of continuous media. Acceleration may be for instance be required by animation frameworks.
        </p>

        <figure id="fig-timeline">
          <img src="timeline.png" width="400" alt="The timing object is essentially and advanced stop watch.">
          <figcaption><a class="self-link" href="#fig-timeline">Figure <bdi class="figno">3</bdi></a> <span class="fig-title">The timing object visualized as a cursor moving along a time-axis.</span></figcaption>
        </figure>
      </section>

      <section id="programming-with-timing-objects"><div class="header-wrapper"><h3 id="x1-4-programming-with-timing-objects"><bdi class="secno">1.4 </bdi>Programming with timing objects</h3><a class="self-link" href="#programming-with-timing-objects" aria-label="Permalink for Section 1.4"></a></div>
        

        <p>
          Timing objects are resources used by a Web application, and the programmer may define as many as required. What purposes they serve in the application is up to the programmer. If the application needs a shared, multi-device clock, simply starting a timing object (and never stopping it) might be sufficient. If the clock value should represent milliseconds, set the velocity to 1000 (advances the timing object with 1000 milliseconds per second). If the timing object represents media offset, specify the playback position, the velocity, and perhaps a media duration. For videos where offset is measured in seconds or frames, set the velocity accordingly. Or, for musical applications it may be practical to let the timing object represent beats per second. Note also that the timing object may represent time-changes with any kind of floating-point variable. For example, if you have data that is organized according to, say height above sea level, you may want to animate how this data changes as you move vertically. In this case the timing object could represent meters or feet above sea level, and positive and negative velocities would allow you to move gradually both upwards and downwards.
        </p>
        <p>
          In general, the timing object is particularly useful when you have a variable that needs to change predictably in time.
        </p>
      </section>

      <section id="connecting-the-timing-object"><div class="header-wrapper"><h3 id="x1-5-connecting-the-timing-object"><bdi class="secno">1.5 </bdi>Connecting the timing object</h3><a class="self-link" href="#connecting-the-timing-object" aria-label="Permalink for Section 1.5"></a></div>
        

        <p>
          The proposed timing model is one where timed components are <i>connected</i> to <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-1">timing objects</a>, thereby accepting the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-2">timing object</a> as director of timed operation. In other words, the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-3">timing object</a> is the master, and the timed component is the slave. However, the <i>connection</i> is not entirely one-way. Timed components may also enforce control over the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-4">timing object</a> by issuing update requests. This allows interactive components to implement timing control on behalf of end users. For instance, a UI element implementing media controls may both be a slave of a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-5">timing object</a> by slavishly visualizing media offset, while at the same time allow the end user to pause the presentation by clicking a the pause button. Crucially, control enforced on a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-6">timing object</a> applies equally on all <i>connected</i> components.
        </p>

        <p>
          Flexibility is another feature with this timing model. Since the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-7">timing object</a> is an independent object, timed components and <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-8">timing objects</a> may be <i>connected</i> and <i>disconnected</i> dynamically. For example, in the context of live media presentation, flexible switching may be enabled between a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-9">timing object</a> (representing the <i>public, live-head</i> of an experience), and a different <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-10">timing object</a> (representing <i>private, personal, time-shifted</i> experience). Another example would be switching to a different <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-11">timing object</a> in order to join a friend in a co-viewing session. 
        </p>
      
        <p>
          To support this timing model, a clear separation between <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-12">timing object</a> and consuming components is required. Specifically, a pattern emerges where timed components are given a reference to a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-13">timing object</a> through a <code>timingsrc</code> property. On the other hand the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-14">timing object</a> is kept usage agnostic and clean of references to consuming components.
        </p>

        <p>
          Timed components that need to <i>connect</i> with the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-15">timing object</a> broadly fall into two categories: components which already have an internal timing model, and components that do not. Within the first category we specifically have media players and existing media frameworks. For such components <i>connection</i> with the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-16">timing object</a> mainly implies time-alignment of the internal timing model with the external <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-17">timing object</a>. In particular, this document discusses integration with <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-2">media elements</a>, see <a href="#media-elements-and-the-timing-object" class="sec-ref"><bdi class="secno">8. </bdi><span>Media elements</span> and the <span>timing object</span></a>. 
        </p>

        <p>
          Components within the second category do not provide their own timing model, but may be useful for presenting timed data. UI elements such as map and canvas fall into this category. Custom components such as plotting libraries, media controls, subtitle viewers, Twitter widgets etc., may also need to <i>connect</i> with a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-18">timing object</a> (in order to present data consistently in time). In fact, an entire Web page may be considered a timed component, where replacement of both data and presentational elements is directed by a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-19">timing object</a>. All these timed components have a single challenge in common, the need to present or execute timed data at the correct time, i.e. time-aligned with the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-20">timing object</a>. This document addresses this common need by <i>connecting</i> the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-21">timing object</a> with a <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-1">text track</a>, see <a href="#timed-data-and-the-timing-object" class="sec-ref"><bdi class="secno">9. </bdi>Timed data and the timing object</a>.
        </p>

        <p>
          Finally, in order to support precisely timed operation in multi-device applications, the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-22">timing object</a> must be <i>connected</i> with an <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-1">online timing resource</a>. One could imagine future standardization of a protocol between <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-23">timing object</a> and the online timing service. Currently though, the decision is rather to leave space open for innovation among timing providers. The <a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-1"><code>TimingProvider</code></a> interface is introduced, see <a href="#timing-provider-object" class="sec-ref"><bdi class="secno">6. </bdi>Timing Provider Object</a>. The idea is that third-parties may provide different implementations of <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-1">timing provider objects</a> (in JavaScript), to which <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-24">timing objects</a> may then connect. As a result, the <i>connection</i> to a <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-2">timing provider object</a> may be provided by the inclusion of a third-party JavaScript library.
        </p>
        
      </section>


      <section id="media-capture-and-playback"><div class="header-wrapper"><h3 id="x1-6-media-capture-and-playback"><bdi class="secno">1.6 </bdi>Media capture and playback</h3><a class="self-link" href="#media-capture-and-playback" aria-label="Permalink for Section 1.6"></a></div>
        

        <p>
          Two very common uses of the timing object include media capture and playback. For media playback, the  timing object may play the role of director or controls. Multiple independent components, possibly on different devices, may be responsible for timed presentation of timed media. If all components take direction from a single timing object, playback is ensured to be timing-consistent.
        </p>
        <p>
          For media capture, the timing object may represent a shared clock for timestamping various types of captured media in multi-device scenarios. As long as timestamps are sampled from a shared clock and included in the captured media, time-shifted playback is possible. In live capturing scenarios, the timing object should likely just run continuously like a clock, or perhaps be adjusted slightly from time to time to stay in sync with some real-world clock source, e.g. a trusted source for epoch time. On the other hand, media capture in a studio setting may be a much more of an iterative process, recording one track or sample at a time. In such scenarios, the timing object might have to be paused and rewound for each take. The timing object will then play the dual role of playback director for previously captured media, as well as production clock for current capture.
        </p>
      </section>

      <section id="reference-point-in-capture-and-playback"><div class="header-wrapper"><h3 id="x1-7-reference-point-in-capture-and-playback"><bdi class="secno">1.7 </bdi>Reference point in capture and playback</h3><a class="self-link" href="#reference-point-in-capture-and-playback" aria-label="Permalink for Section 1.7"></a></div>
        

        <p>
          The concept of reference point refers to the exact time-alignment of timing object and media in capture and playback. Disagreement about the details of this alignment may be a source of (small) synchronization errors. For this reason, a common definition of reference points for time alignment in capture and playback is helpful.
        </p>
        <p>
          For media capture, media timestamps should reflect the point in time when external, physical signals are received by sensors, i.e. ideally when photons hit the lense or when sound waves hit the microphone. As timestamping activity is delayed relative to this ideal reference point, timestamps picked from the timing object must be adjusted (upstream delay subtracted). This implies that capturing components must know (or figure out) their upstream latency (if significant). If all components are able to do this correctly, variation in processing delay will not produce synchronization errors.
        </p>
        <p>
          For media playback, media timestamps should reflect the point in time when timed media fragments take physical effect. I.e., ideally when pixels are modified on the screen, or when the loudspeaker modifies its vibration frequency. If playback commands are subject to non-negligible delay before they take effect, the playback component must schedule commands earlier. This implies that playback component must know (or figure out) their downstream delay. If all components are able to do this correctly, variation in processing delay will not produce synchronization errors.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="4"><span>Note</span></div><p class="">
          This definition of reference points is in accordance with definitions used in related standardization work, for instance see [<cite><a class="bibref" data-link-type="biblio" href="#bib-dvb-css" title="ETSI TS 103 286-2 V1.1.1 Digital Video Broadcasting (DVB); Companion Screens and Streams; Part 2: Content Identification and Media Synchronization">DVB-CSS</a></cite>] / HbbTV2.0 CSS clause 5.7.2.
        </p></div>
        <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="4"><span>Note</span></div><p class="">
          Strictly speaking, the timing object is usage-agnostic and can not mandate a specific definition for reference point. However, as interoperability of timing-sensitive components (e.g. capture and playback) is a major motivation for the timing object, the above definitions for reference point are recommended.  
        </p></div>
      </section>

       <section id="naming"><div class="header-wrapper"><h3 id="x1-8-naming"><bdi class="secno">1.8 </bdi>Naming</h3><a class="self-link" href="#naming" aria-label="Permalink for Section 1.8"></a></div>
        
        <p>
          With regards to the naming of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-25">timing object</a>, there were multiple options available, e.g. <i>Clock</i>, <i>WebClock</i>, <i>MediaClock</i> or <i>SharedClock</i>. For a descriptive name, we argue that <i>clock</i> (or variations thereof) might be a bit limiting. A <i>clock</i> (in particular a system clock) is mainly a read-only resource (from the perspective of the programmer). <i>Stop-watch</i> would better indicate the interactive nature of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-26">timing object</a>, however, this too would fail to indicate the role of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-27">timing object</a> as <i>controller</i> or <i>director</i> in media. From a purely descriptive point of view, deterministic <i>motion</i> is perhaps the most precise name, matching the implementation and also indicating that linear media is made from two basic constituents - media <i>content</i> and media <i>motion</i>. On the other hand, the term <i>motion</i> is (still) unfamiliar and does not indicate any specific uses. For these reasons it was decided to name the object after its main purpose which is correct timing and temporal control. Something like <i>TemporalControllerObject</i> or <i>TimingDirectorObject</i> would perhaps be most correct. However, as these terms are a bit clunky <i>TimingObject</i> was selected as an acceptable compromise.
        </p>
      </section>

    </section>




    

    <section id="conformance"><div class="header-wrapper"><h2 id="x2-conformance"><bdi class="secno">2. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section 2."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key word <em class="rfc2119">MUST</em> in this document
        is to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p>
      <p>
        Requirements phrased in the imperative as part of algorithms (such as "strip any leading space characters" or "return false and terminate these steps") are to be interpreted with the meaning of the key word ("must", "should", "may", etc.) used in introducing the algorithm.
      </p>

      <p>
        Conformance requirements phrased as algorithms or specific steps may be implemented in any manner, so long as the end result is equivalent. (In particular, the algorithms defined in this specification are intended to be easy to follow, and not intended to be performant).
      </p>

      <p>
        This specification defines conformance criteria for two classes of products:
      </p>

      <ul>
        <li>A <dfn id="dfn-user-agent" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">user agent</dfn> that provides the Web runtime and implements all the interfaces defined in <a href="#timing-object" class="sec-ref"><bdi class="secno">5. </bdi>Timing Object</a>, <a href="#state-vector" class="sec-ref"><bdi class="secno">7. </bdi>State Vector</a>, <a href="#media-elements-and-the-timing-object" class="sec-ref"><bdi class="secno">8. </bdi><span>Media elements</span> and the <span>timing object</span></a> and <a href="#timed-data-and-the-timing-object" class="sec-ref"><bdi class="secno">9. </bdi>Timed data and the timing object</a>.</li>
        <li>A <dfn id="dfn-timing-resource-provider" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">timing resource provider</dfn> that provides necessary logic to associate a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-28">timing object</a> with an online <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-1">timing resource</a>. A <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-1">timing resource provider</a> implements the <code><a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-2"><code>TimingProvider</code></a></code> interface defined in <a href="#timing-provider-object" class="sec-ref"><bdi class="secno">6. </bdi>Timing Provider Object</a>.</li>
      </ul>
    </section>




    

    <section id="terminology"><div class="header-wrapper"><h2 id="x3-terminology"><bdi class="secno">3. </bdi>Terminology</h2><a class="self-link" href="#terminology" aria-label="Permalink for Section 3."></a></div>
      

      <p>
        This specification uses the following terms and procedures defined in —but not exported by— [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>]:
      </p>
      <ul>
        <li><dfn data-lt="media element|media elements" id="dfn-media-element" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#media-element">media element</a></dfn></li>
        <li><dfn id="dfn-effective-playback-rate" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-playbackrate">effective playback rate</a></dfn></li>
        <li><dfn data-lt="text tracks|text track" id="dfn-text-tracks" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#text-track">text track</a></dfn></li>
        <li><dfn data-lt="text track cue|text track cues" id="dfn-text-track-cue" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#text-track-cue">text track cue</a></dfn></li>
        <li><dfn id="dfn-text-track-kind" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#text-track-kind">text track kind</a></dfn></li>
        <li><dfn id="dfn-text-track-label" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#text-track-label">text track label</a></dfn></li>
        <li><dfn id="dfn-text-track-mode" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#text-track-mode">text track mode</a></dfn></li>
        <li><dfn id="dfn-text-track-hidden" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#text-track-hidden">text track hidden</a></dfn></li>
        <li><dfn id="dfn-text-track-loaded" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#text-track-loaded">text track loaded</a></dfn></li>
        <li><dfn id="dfn-text-track-readiness-state" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#text-track-readiness-state">text track readiness state</a></dfn></li>
        <li><dfn id="dfn-text-track-list-of-cues" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#text-track-list-of-cues">text track list of cues</a></dfn></li>
        <li><dfn id="dfn-current-playback-position" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#current-playback-position">current playback position</a></dfn></li>
        <li><dfn id="dfn-time-marches-on" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://html.spec.whatwg.org/multipage/media.html#time-marches-on">time marches on</a></dfn></li>
      </ul>

      <p>
        This specification was also developed to align with the concept of media controller, which used to be defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-html5" title="HTML5">HTML5</a></cite>], and currently depends on the following superseded terms and procedures:
      </p>
      <ul>
        <li><dfn id="dfn-current-media-controller" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/2018/SPSD-html5-20180327/embedded-content-0.html#current-media-controller">current media controller</a></dfn></li>
        <li><dfn id="dfn-slaved-media-elements" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/2018/SPSD-html5-20180327/embedded-content-0.html#slaved-media-elements">slaved media elements</a></dfn></li>
        <li><dfn id="dfn-report-the-controller-state" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><a href="https://www.w3.org/TR/2018/SPSD-html5-20180327/embedded-content-0.html#report-the-controller-state">report the controller state</a></dfn></li>
        <li><dfn id="dfn-mediacontroller" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code><a href="https://www.w3.org/TR/2018/SPSD-html5-20180327/embedded-content-0.html#mediacontroller">MediaController</a></code></dfn></li>
      </ul>

      <p>
        The <dfn id="dfn-internal-clock" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">internal clock</dfn> is based on the precise, high-resolution, and monotonic clock defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-hr-time" title="High Resolution Time">HR-TIME</a></cite>], with values representing <i>seconds</i>, not milliseconds. In essence, the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-1">internal clock</a> is defined as <code>performance.now()/1000.0</code>. All time values refered to by the timing object specification are expressed in <i>seconds</i>. This includes timestamps in <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-1">state vectors</a> as well as <a href="#dfn-skew" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-skew-1">skew</a> estimates communicated from <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-3">timing provider objects</a> to <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-29">timing objects</a>.
      </p>

      <p>
        A <dfn id="dfn-timing-resource" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">timing resource</dfn> is an object. This object essentially implements the abstraction of a <i>linear motion in real time</i>. For example, imagine a <i>point</i> moving along an <i>axis</i>. At a specific moment in time, this <i>point</i> has a specific <i>position</i> on the <i>axis</i>, a specific <i>velocity</i> and a specific <i>acceleration</i>. These three properties (all floating point values) define the state of the <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-2">timing resource</a> at that moment in time.
      </p>
      <p>
        A <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-3">timing resource</a> may either be an <dfn id="dfn-internal-timing-resource" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">internal timing resource</dfn>, an object under the control of a <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-1">user agent</a>, or an <dfn id="dfn-external-timing-resource" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">external timing resource</dfn>, an object under the control of a <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-2">timing resource provider</a>. Both types exist locally in the user agent, but the <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-1">external timing resource</a> may be a proxy object for an <dfn data-lt="online timing resources|online timing resource" id="dfn-online-timing-resources" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">online timing resource</dfn>, i.e. an object hosted remotely by an online service.
      </p>
      <div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="3"><span>Note</span></div><p class="">
        A <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-2">user agent</a> may typically offer native implementations of <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-30">timing objects</a>, especially when the protocol needed is not available to Web applications. For instance, the clock synchronization mechanism defined in DVB for companion screens and streams [<cite><a class="bibref" data-link-type="biblio" href="#bib-dvb-css" title="ETSI TS 103 286-2 V1.1.1 Digital Video Broadcasting (DVB); Companion Screens and Streams; Part 2: Content Identification and Media Synchronization">DVB-CSS</a></cite>] uses a UDP-based protocol. A <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-3">user agent</a> could perhaps expose a <code>DVBCSSTimingObject</code> interface to allow Web applications to connect to a companion screen that supports this protocol.
      </p></div>
      <p>
        This document provides interface definitions using the [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WEBIDL</a></cite>] standard.
      </p>
    </section>











    



    <section class="informative" id="examples"><div class="header-wrapper"><h2 id="x4-examples"><bdi class="secno">4. </bdi>Examples</h2><a class="self-link" href="#examples" aria-label="Permalink for Section 4."></a></div><p><em>This section is non-normative.</em></p>
      
      <p>This section contains a few minimal code examples that show how a timing object may be used.</p>

      <section id="query"><div class="header-wrapper"><h3 id="x4-1-query"><bdi class="secno">4.1 </bdi>Query</h3><a class="self-link" href="#query" aria-label="Permalink for Section 4.1"></a></div>
      
      <div class="example" id="example-read-the-current-position-of-a-timing-object">
        <div class="marker">
    <a class="self-link" href="#example-read-the-current-position-of-a-timing-object">Example<bdi> 1</bdi></a><span class="example-title">: Read the current position of a timing object</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript"><span class="hljs-comment">// Create timing object at position 2</span>
<span class="hljs-comment">// (note velocity and acceleration default to 0)</span>
<span class="hljs-keyword">var</span> to = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingObject</span>({ <span class="hljs-attr">position</span>: <span class="hljs-number">2.0</span> });

<span class="hljs-comment">// Read and report current value to the console</span>
<span class="hljs-comment">// (renders "pos:2 vel:0, acc:0" in this example)</span>
<span class="hljs-keyword">var</span> vector = to.<span class="hljs-title function_">query</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"pos:"</span> + vector.<span class="hljs-property">position</span> +
  <span class="hljs-string">" vel:"</span> + vector.<span class="hljs-property">velocity</span> +
  <span class="hljs-string">" acc:"</span> + vector.<span class="hljs-property">acceleration</span>);</code></pre>
      </div>
      </section>

      <section id="update"><div class="header-wrapper"><h3 id="x4-2-update"><bdi class="secno">4.2 </bdi>Update</h3><a class="self-link" href="#update" aria-label="Permalink for Section 4.2"></a></div>
      
      <div class="example" id="example-play-and-pause-buttons-to-control-a-timing-object">
        <div class="marker">
    <a class="self-link" href="#example-play-and-pause-buttons-to-control-a-timing-object">Example<bdi> 2</bdi></a><span class="example-title">: Play and pause buttons to control a timing object</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript"><span class="hljs-comment">// Pointers to "play" and "pause" buttons in the DOM</span>
<span class="hljs-keyword">var</span> playbutton, pausebutton;

<span class="hljs-comment">// Start/Stop timing object when buttons are clicked</span>
<span class="hljs-keyword">var</span> to = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingObject</span>();
playbutton.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
  to.<span class="hljs-title function_">update</span>({ <span class="hljs-attr">velocity</span>: <span class="hljs-number">1.0</span> });
};
pausebutton.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
  to.<span class="hljs-title function_">update</span>({ <span class="hljs-attr">velocity</span>: <span class="hljs-number">0.0</span> });
};</code></pre>
      </div>
      </section>

      <section id="polling"><div class="header-wrapper"><h3 id="x4-3-polling"><bdi class="secno">4.3 </bdi>Polling</h3><a class="self-link" href="#polling" aria-label="Permalink for Section 4.3"></a></div>
      
      <p>By querying the timing object repeatedly we can refresh time sensitive UI and demonstrate that the value of the timing object is changing predictably in time.</p>
      <div class="example" id="example-poll-and-render-position-periodically">
        <div class="marker">
    <a class="self-link" href="#example-poll-and-render-position-periodically">Example<bdi> 3</bdi></a><span class="example-title">: Poll and render position periodically</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">var</span> elem; <span class="hljs-comment">// DOM Element</span>
<span class="hljs-keyword">var</span> to = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingObject</span>();
<span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
  elem.<span class="hljs-property">innerHTML</span> = to.<span class="hljs-title function_">query</span>().<span class="hljs-property">position</span>;
}, <span class="hljs-number">100</span>);</code></pre>
      </div>

      <p>Alternatively, use the built-in <i>timeupdate</i> event (fixed frequency).</p>
      <div class="example" id="example-render-position-periodically-based-on-timeupdate-event">
        <div class="marker">
    <a class="self-link" href="#example-render-position-periodically-based-on-timeupdate-event">Example<bdi> 4</bdi></a><span class="example-title">: Render position periodically based on timeupdate event</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">var</span> elem; <span class="hljs-comment">// DOM Element</span>
<span class="hljs-keyword">var</span> to = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingObject</span>();
<span class="hljs-keyword">var</span> to.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"timeupdate"</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) {
  elem.<span class="hljs-property">innerHTML</span> = to.<span class="hljs-title function_">query</span>().<span class="hljs-property">position</span>;
});</code></pre>
      </div>
      </section>

      <section id="update-event"><div class="header-wrapper"><h3 id="x4-4-update-event"><bdi class="secno">4.4 </bdi>Update Event</h3><a class="self-link" href="#update-event" aria-label="Permalink for Section 4.4"></a></div>
      
      <p>Update operations cause abrupt changes to the timing object. Register a handler to be notified.</p>
      <div class="example" id="example-report-when-a-timing-object-stops-moving">
        <div class="marker">
    <a class="self-link" href="#example-report-when-a-timing-object-stops-moving">Example<bdi> 5</bdi></a><span class="example-title">: Report when a timing object stops moving</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">var</span> elem; <span class="hljs-comment">// DOM Element</span>
<span class="hljs-keyword">var</span> to = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingObject</span>();
to.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"update"</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) {
  <span class="hljs-keyword">var</span> vector = to.<span class="hljs-title function_">query</span>();
  <span class="hljs-keyword">if</span> (vector.<span class="hljs-property">velocity</span> === <span class="hljs-number">0.0</span> &amp;&amp; vector.<span class="hljs-property">acceleration</span> === <span class="hljs-number">0.0</span>) {
    elem.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">"I'm not moving!"</span>;
  } <span class="hljs-keyword">else</span> {
    elem.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">"I'm moving!"</span>;
  }
});

<span class="hljs-comment">// Make timing object move and then stop it</span>
to.<span class="hljs-title function_">update</span>({ <span class="hljs-attr">velocity</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">acceleration</span>: <span class="hljs-number">1</span> });
to.<span class="hljs-title function_">update</span>({ <span class="hljs-attr">velocity</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">acceleration</span>: <span class="hljs-number">0</span> });</code></pre>
      </div>
      </section>

      <section id="connect-to-a-media-element"><div class="header-wrapper"><h3 id="x4-5-connect-to-a-media-element"><bdi class="secno">4.5 </bdi>Connect to a media element</h3><a class="self-link" href="#connect-to-a-media-element" aria-label="Permalink for Section 4.5"></a></div>
      
      <p>
        A media element connected to a timing object will provide media playback precisely time-aligned with that timing object. In essence, the media element becomes a slave to the timing object. Pausing the timing object implies pausing the media element, etc.
      </p> 
      <div class="example" id="example-use-timing-object-to-control-a-video">
        <div class="marker">
    <a class="self-link" href="#example-use-timing-object-to-control-a-video">Example<bdi> 6</bdi></a><span class="example-title">: Use timing object to control a video</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">var</span> video; <span class="hljs-comment">// Pointer to a video element in the DOM</span>
<span class="hljs-keyword">var</span> to = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingObject</span>();
video.<span class="hljs-property">timingsrc</span> = to; <span class="hljs-comment">// Video now directed by timing object</span>

<span class="hljs-comment">// Start timing object (video seeks and starts by implication)</span>
to.<span class="hljs-title function_">update</span>({ <span class="hljs-attr">position</span>: <span class="hljs-number">5.0</span>, <span class="hljs-attr">velocity</span>: <span class="hljs-number">1.0</span> });</code></pre>
      </div>
      </section>


      <section id="connect-to-a-timing-text-track"><div class="header-wrapper"><h3 id="x4-6-connect-to-a-timing-text-track"><bdi class="secno">4.6 </bdi>Connect to a timing text track</h3><a class="self-link" href="#connect-to-a-timing-text-track" aria-label="Permalink for Section 4.6"></a></div>
      
      <p>A timing text track connected to a timing object will provide enter/exit events for timed data, precisely time-aligned with that timing object. In essence, the timing text track becomes a slave to the timing object. Pausing the timing object implies pausing the timing text track, etc. </p>
      <div class="example" id="example-play-simple-timed-data">
        <div class="marker">
    <a class="self-link" href="#example-play-simple-timed-data">Example<bdi> 7</bdi></a><span class="example-title">: Play simple timed data</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">var</span> elem; <span class="hljs-comment">// DOM element</span>
<span class="hljs-keyword">var</span> to = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingObject</span>();

<span class="hljs-comment">// Create timed data</span>
<span class="hljs-keyword">var</span> track = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingTextTrack</span>(<span class="hljs-string">"metadata"</span>);
<span class="hljs-keyword">var</span> cue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataCue</span>(<span class="hljs-number">12.783</span>, <span class="hljs-number">13.612</span>, <span class="hljs-string">"dog bark"</span>);
track.<span class="hljs-title function_">addCue</span>(cue);
cue.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"enter"</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
  elem.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">"Dog is barking"</span>;
});
cue.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"exit"</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
  elem.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">"Dog is silent"</span>;
});
track.<span class="hljs-property">timingsrc</span> = to; <span class="hljs-comment">// track directed by timing object</span>
to.<span class="hljs-title function_">update</span>({ <span class="hljs-attr">velocity</span>: <span class="hljs-number">1.0</span> }); <span class="hljs-comment">// start playing timed data</span></code></pre>
      </div>
      </section>

      <section id="connect-to-a-timing-provider"><div class="header-wrapper"><h3 id="x4-7-connect-to-a-timing-provider"><bdi class="secno">4.7 </bdi>Connect to a timing provider</h3><a class="self-link" href="#connect-to-a-timing-provider" aria-label="Permalink for Section 4.7"></a></div>
      
      <p>A <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-31">timing object</a> may take its input from a <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-4">timing provider object</a> provided by some third-party provider (or developed by the app developer). <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-5">Timing provider objects</a> will typically act as proxies to online timing resource, thus enabling cross-device synchronization.</p>
      <div class="example" id="example-connect-to-a-timingprovider-object">
        <div class="marker">
    <a class="self-link" href="#example-connect-to-a-timingprovider-object">Example<bdi> 8</bdi></a><span class="example-title">: Connect to a TimingProvider object</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript"><span class="hljs-comment">// TimingProvider object</span>
<span class="hljs-comment">// (constructor and parameters are provider-specific)</span>
<span class="hljs-keyword">var</span> tp;

<span class="hljs-comment">// Create timing object associated with timing provider source</span>
<span class="hljs-keyword">var</span> to = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingObject</span>(tp);
<span class="hljs-keyword">var</span> to.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"timeupdate"</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) {
  <span class="hljs-keyword">var</span> vector = to.<span class="hljs-title function_">query</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"pos:"</span> + vector.<span class="hljs-property">position</span> +
    <span class="hljs-string">" vel:"</span> + vector.<span class="hljs-property">velocity</span> +
    <span class="hljs-string">" acc:"</span> + vector.<span class="hljs-property">acceleration</span>);
});</code></pre>
      </div>
      </section>

    </section>


    



    <section id="timing-object"><div class="header-wrapper"><h2 id="x5-timing-object"><bdi class="secno">5. </bdi>Timing Object</h2><a class="self-link" href="#timing-object" aria-label="Permalink for Section 5."></a></div>
      

      <p>
        A <dfn data-lt="timing object|timing objects" id="dfn-timing-object" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">timing object</dfn> is an object that exposes a <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-4">timing resource</a> represented by a <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-2">state vector</a> to a Web application.
      </p>

      <p>
        A <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-32">timing object</a> can have a <dfn id="dfn-timing-provider-source" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">timing provider source</dfn>, which is a <code><a href="#timing-provider-object">TimingProvider</a></code> object that encapsulates the logic needed to represent an <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-2">external timing resource</a>. The <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-1">timing provider source</a> is initialized once and for all when the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-33">timing object</a> is created.
      </p>

      <p>
        If the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-34">timing object</a> is associated with a <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-6">timing provider object</a>, the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-35">timing object</a> has an <dfn data-lt="clock skew|internal clock skew" id="dfn-clock-skew" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">internal clock skew</dfn>. This represents the current estimate of the skew between the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-2">internal clock</a> and the clock employed by the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-3">timing resource provider</a>. The <a data-lt="clock skew" href="#dfn-clock-skew" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-clock-skew-1">internal clock skew</a> is provided by the <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-7">timing provider object</a>, and defined so that <var>clock<sub>timing provider</sub></var> === <var>clock<sub>user agent</sub></var> + <var>skew</var>, where <var>clock<sub>user agent</sub></var> is the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-3">internal clock</a> of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-36">timing object</a>, expressed in seconds. <a data-lt="clock skew" href="#dfn-clock-skew" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-clock-skew-2">internal clock skew</a> is also expressed in seconds. This equation is used by the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-4">user agent</a> to convert timestamps between the timelines of the two clocks. The <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-5">user agent</a> must ensure monotonic behavior by, if necessary, applying skew changes gradually (see <a href="#calculate-skew-adjustment" class="sec-ref"><bdi class="secno">5.10 </bdi>Calculate skew adjustment</a>). 
      </p>

      <p>
        A <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-37">timing object</a> has an <dfn id="dfn-internal-vector" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">internal vector</dfn> that represents the initial conditions of the current motion. The <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-1">internal vector</a> is used by the <code>query()</code> operation to calculate a snapshot <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-3">state vector</a> of the current motion. If the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-38">timing object</a> is associated with a <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-8">timing provider object</a>, the <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-2">internal vector</a> is provided by the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-4">timing resource provider</a> and therefore includes a timestamp value from the timeline of the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-5">timing resource provider</a>.
      </p>

      <p>
        A <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-39">timing object</a> has a <dfn id="dfn-state" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">state</dfn> property that describes the operational state of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-40">timing object</a>. If the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-41">timing object</a> is associated with a <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-9">timing provider object</a>, the operational <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-1">state</a> will reflect the state of the <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-10">timing provider object</a>, and by implication the underlying communication link. 
      </p>

      <p>
        A <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-42">timing object</a> can have a <dfn id="dfn-start-position" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">start position</dfn> and an <dfn id="dfn-end-position" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">end position</dfn> that together define the <dfn id="dfn-range" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">range</dfn> of positions for the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-43">timing object</a>. Internally, the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-44">timing object</a> must enforce this <a href="#dfn-range" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-range-1">range</a> restriction by updating its <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-3">internal vector</a> if a <a href="#dfn-range" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-range-2">range</a> violation occurs (at the correct moment). The <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-45">timing object</a> will maintain a <dfn id="dfn-current-range-timeout" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">current range timeout</dfn> for this purpose, pointing to a scheduled timeout when set.
      </p>


      <p>A <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-46">timing object</a> implements the following interface:</p>

      <pre class="idl def" id="webidl-448118520"><span class="idlHeader"><a class="self-link" href="#webidl-448118520">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-timingobject" data-title="TimingObject">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
interface <dfn data-export="" data-dfn-type="interface" id="dom-timingobject" data-idl="interface" data-title="TimingObject" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>TimingObject</code></dfn> : <span class="idlSuperclass"><a data-link-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span> {<span data-idl="" class="idlConstructor" id="idl-def-timingobject-constructor-vector-startposition-endposition" data-title="constructor" data-dfn-for="TimingObject">
  <dfn data-export="" data-dfn-type="constructor" id="dom-timingobject-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="TimingObject" data-lt="constructor()|constructor(vector)|constructor(vector, startPosition)|constructor(vector, startPosition, endPosition)" data-local-lt="TimingObject.constructor|TimingObject.constructor()|constructor" tabindex="0" aria-haspopup="dialog"><code>constructor</code></dfn>(optional<span class="idlType"> <a data-link-type="idl" href="#dom-timingstatevectorupdate" class="internalDFN" id="ref-for-dom-timingstatevectorupdate-1"><code>TimingStateVectorUpdate</code></a></span> <span class="idlParamName">vector</span> = {},
              optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <span class="idlParamName">startPosition</span>,
              optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <span class="idlParamName">endPosition</span>);</span><span data-idl="" class="idlConstructor" id="idl-def-timingobject-constructor!overload-1" data-title="constructor!overload-1" data-dfn-for="TimingObject">
  <dfn data-export="" data-dfn-type="constructor" id="dom-timingobject-constructor!overload-1" data-idl="constructor" data-title="constructor" data-dfn-for="TimingObject" data-lt="constructor!overload-1()|constructor!overload-1(provider)" data-local-lt="TimingObject.constructor!overload-1|TimingObject.constructor!overload-1()|constructor!overload-1" tabindex="0" aria-haspopup="dialog"><code>constructor</code></dfn>(<span class="idlType"><a data-link-type="idl" href="#dom-timingprovider" class="internalDFN" id="ref-for-dom-timingprovider-3"><code>TimingProvider</code></a></span> <span class="idlParamName">provider</span>);</span><span data-idl="" class="idlAttribute" id="idl-def-timingobject-timingprovidersource" data-title="timingProviderSource" data-dfn-for="TimingObject">
  readonly    attribute<span class="idlType"> <a data-link-type="idl" href="#dom-timingprovider" class="internalDFN" id="ref-for-dom-timingprovider-4"><code>TimingProvider</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-timingprovidersource" id="ref-for-dom-timingobject-timingprovidersource-1"><code>timingProviderSource</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingobject-readystate" data-title="readyState" data-dfn-for="TimingObject">
  readonly    attribute<span class="idlType"> <a data-link-type="idl" href="#dom-timingobjectstate" class="internalDFN" id="ref-for-dom-timingobjectstate-1"><code>TimingObjectState</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-readystate" id="ref-for-dom-timingobject-readystate-1"><code>readyState</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingobject-startposition" data-title="startPosition" data-dfn-for="TimingObject">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-startposition" id="ref-for-dom-timingobject-startposition-1"><code>startPosition</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingobject-endposition" data-title="endPosition" data-dfn-for="TimingObject">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-endposition" id="ref-for-dom-timingobject-endposition-1"><code>endPosition</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingobject-onreadystatechange" data-title="onreadystatechange" data-dfn-for="TimingObject">
              attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span>      <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-onreadystatechange" id="ref-for-dom-timingobject-onreadystatechange-1"><code>onreadystatechange</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingobject-onchange" data-title="onchange" data-dfn-for="TimingObject">
              attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span>      <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-onchange" id="ref-for-dom-timingobject-onchange-1"><code>onchange</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingobject-ontimeupdate" data-title="ontimeupdate" data-dfn-for="TimingObject">
              attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span>      <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-ontimeupdate" id="ref-for-dom-timingobject-ontimeupdate-1"><code>ontimeupdate</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingobject-onerror" data-title="onerror" data-dfn-for="TimingObject">
              attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span>      <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-onerror" id="ref-for-dom-timingobject-onerror-1"><code>onerror</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-timingobject-query" data-title="query" data-dfn-for="TimingObject"><span class="idlType">
  <a data-link-type="idl" href="#dom-timingstatevector" class="internalDFN" id="ref-for-dom-timingstatevector-1"><code>TimingStateVector</code></a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-timingobject-query" id="ref-for-dom-timingobject-query-1"><code>query</code></a> ();</span><span data-idl="" class="idlMethod" id="idl-def-timingobject-update-newvector" data-title="update" data-dfn-for="TimingObject"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-timingobject-update" id="ref-for-dom-timingobject-update-1"><code>update</code></a> (optional<span class="idlType"> <a data-link-type="idl" href="#dom-timingstatevectorupdate" class="internalDFN" id="ref-for-dom-timingstatevectorupdate-2"><code>TimingStateVectorUpdate</code></a></span> <span class="idlParamName">newVector</span> = {});</span>
};</span></code></pre>

      <div data-dfn-for="TimingObject" data-link-for="TimingObject">
        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingobject-startposition" data-idl="attribute" data-title="startPosition" data-dfn-for="TimingObject" data-type="unrestricted double" data-lt="startPosition" data-local-lt="TimingObject.startPosition" tabindex="0" aria-haspopup="dialog"><code>startPosition</code></dfn> and <dfn data-export="" data-dfn-type="attribute" id="dom-timingobject-endposition" data-idl="attribute" data-title="endPosition" data-dfn-for="TimingObject" data-type="unrestricted double" data-lt="endPosition" data-local-lt="TimingObject.endPosition" tabindex="0" aria-haspopup="dialog"><code>endPosition</code></dfn> attributes <em class="rfc2119">MUST</em> respectively be set to the <a href="#dfn-start-position" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-start-position-1">start position</a> and <a href="#dfn-end-position" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-end-position-1">end position</a> that the <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-4">state vector</a> may take, if any, or <code>-Infinity</code> and <code>Infinity</code> otherwise.
        </p>
        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingobject-readystate" data-idl="attribute" data-title="readyState" data-dfn-for="TimingObject" data-type="TimingObjectState" data-lt="readyState" data-local-lt="TimingObject.readyState" tabindex="0" aria-haspopup="dialog"><code>readyState</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the current state of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-47">timing object</a>. If the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-48">timing object</a> represents an <a href="#dfn-internal-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-timing-resource-1">internal timing resource</a>, this will typically always be <code>connecting</code> or <code>open</code>. The <a href="#dom-timingobject-readystate" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-readystate-2"><code>readyState</code></a> attribute may take other values when the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-49">timing object</a> represents an <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-3">external timing resource</a>.
        </p>
        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingobject-timingprovidersource" data-idl="attribute" data-title="timingProviderSource" data-dfn-for="TimingObject" data-type="TimingProvider" data-lt="timingProviderSource" data-local-lt="TimingObject.timingProviderSource" tabindex="0" aria-haspopup="dialog"><code>timingProviderSource</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-2">timing provider source</a> of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-50">timing object</a>, if any, or null otherwise.
        </p>
      </div>

      <div class="issue" id="issue-container-number-13"><div role="heading" class="issue-title marker" id="h-issue" aria-level="3"><a href="https://github.com/webtiming/timingobject/issues/13"><span class="issue-number">Issue 13</span></a><span class="issue-label">: Chaining timing objects</span></div><p dir="auto">Creating an issue to track this idea that Ingar raised on the mailing-list:<br>
<a href="https://lists.w3.org/Archives/Public/public-webtiming/2015Jul/0006.html" rel="nofollow">https://lists.w3.org/Archives/Public/public-webtiming/2015Jul/0006.html</a></p>
<p dir="auto">Being able to create a hierarchy of <code class="notranslate">TimingObject</code> objects would make it possible to create timing objects that can <em>process and convert</em> the state vector of another timing object, e.g. to convert the position from one unit to another or to shift or skew the position so that it matches a media timeline.</p>
<p dir="auto">The spec should define a few of these <em>processing</em> types of <code class="notranslate">TimingObject</code> objects for that to be useful.</p>
<p dir="auto">I'm not sure how we can create a type of TimingObject that could be associated with custom JavaScript code that does the processing. Without having given it more thoughts, an approach similar to that used in the <code class="notranslate">createAudioWorker</code> method of the Web Audio API [1] where the code runs in a separate Worker could be useful. Incidently, that mechanism is quite similar to the idea of running the timing provider code in a separate JavaScript realm (see issue <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="96610823" data-permission-text="Title is private" data-url="https://github.com/webtiming/timingobject/issues/10" data-hovercard-type="issue" data-hovercard-url="/webtiming/timingobject/issues/10/hovercard" href="https://github.com/webtiming/timingobject/issues/10">#10</a>), so there might be a way to merge the two ideas into one.</p>
<p dir="auto">[1] <a href="http://webaudio.github.io/web-audio-api/#widl-AudioContext-createAudioWorker-Promise-AudioWorker" rel="nofollow">http://webaudio.github.io/web-audio-api/#widl-AudioContext-createAudioWorker-Promise-AudioWorker</a></p></div>
      <div class="issue" id="issue-container-number-14"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="3"><a href="https://github.com/webtiming/timingobject/issues/14"><span class="issue-number">Issue 14</span></a><span class="issue-label">: Add a "paused" state to timing objects?</span></div><p dir="auto">Media elements in HTML5 have a <code class="notranslate">paused</code> flag that is different from setting the <code class="notranslate">playbackRate</code> to <code class="notranslate">0.0</code>. It might be useful to introduce the same concept for <code class="notranslate">TimingObject</code>.</p>
<p dir="auto">From a spec perspective, this woud likely mean to introduce this flag in the definition of the <code class="notranslate">TimingStateVector</code> interface.</p>
<p dir="auto">That does not strike me as a top priority at this stage, just raising the issue to keep track of it.</p></div>

      <section id="create-a-new-timing-object"><div class="header-wrapper"><h3 id="x5-1-create-a-new-timing-object"><bdi class="secno">5.1 </bdi>Create a new timing object</h3><a class="self-link" href="#create-a-new-timing-object" aria-label="Permalink for Section 5.1"></a></div>
        
        <p>
          When the <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-1"><code>TimingObject</code></a></code> constructor that takes an optional vector, a start position and an end position is invoked, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-6">user agent</a> <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>timing</var> be a newly created <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-2"><code>TimingObject</code></a></code>.</li>
          <li>Let <var>t</var> be a fresh timestamp read from the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-4">internal clock</a>, defining the time of creation.
          </li><li>Let <var>vectorInit</var> be the four-tuple <code>(p, v, a, t)</code>, where <code>(p, v, a)</code> are from the constructors first argument, or <code>(0,0,0)</code> if no argument is provided.</li> 
          <li>Let <var>timing</var>'s <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-4">internal vector</a> be a newly constructed <code><a href="#dom-timingstatevector" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingstatevector-2"><code>TimingStateVector</code></a></code> that represents <var>vectorInit</var>.</li>
          <li>Let <var>timing</var>'s <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-3">timing provider source</a> be null.</li>
          <li>Let <var>timing</var>'s <a href="#dfn-start-position" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-start-position-2">start position</a> be the constructor's second argument or <code>-Infinity</code> if not given.</li>
          <li>Let <var>timing</var>'s <a href="#dfn-end-position" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-end-position-2">end position</a> be the constructor's third argument or <code>Infinity</code> if not given.</li>
          <li>If <var>timing</var>'s <a href="#dfn-range" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-range-3">range</a> does not <a href="#dfn-cover" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cover-1">cover</a> the position of the <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-5">internal vector</a>:
            <ol>
              <li>Let <var>timing</var>'s <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-6">internal vector</a>'s position be <a href="#dfn-start-position" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-start-position-3">start position</a> or <a href="#dfn-end-position" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-end-position-3">end position</a>, whichever is closest</li>
              <li>Let <var>timing</var>'s <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-7">internal vector</a>'s velocity and acceleration be <code>0.0</code> if the direction of the motion would make the position leave the <a href="#dfn-range" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-range-4">range</a> immediately.</li>
              <li><a href="#dfn-set-the-internal-timeout" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-set-the-internal-timeout-1">Set the internal timeout</a> of <var>timing</var>.</li>
            </ol>
          </li>
          <li>Let <var>timing</var>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-2">state</a> be <code>open</code>.</li>
          <li><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <code>readystatechange</code> at <var>timing</var>.</li>
          <li>Return <var>timing</var>.</li>
        </ol>
 

        <p>
          When the <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-3"><code>TimingObject</code></a></code> constructor that takes a <code><a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-5"><code>TimingProvider</code></a></code> is invoked, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-7">user agent</a> <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>provider</var> be the constructor's argument.</li>
          <li>Let <var>timing</var> be a newly created <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-4"><code>TimingObject</code></a></code> whose <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-4">timing provider source</a> is <var>provider</var>.</li>
          <li>Let <var>timing</var>'s <a href="#dfn-start-position" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-start-position-4">start position</a> be <var>provider</var>'s <code>startPosition</code> property.</li>
          <li>Let <var>timing</var>'s <a href="#dfn-end-position" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-end-position-4">end position</a> be <var>provider</var>'s <code>endPosition</code> property.</li>
          <li>Let <var>timing</var>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-3">state</a> be <var>provider</var>'s <code>readyState</code> property.</li>
          <li>Let <var>timing</var>'s <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-8">internal vector</a> be <var>provider</var>'s <code>vector</code> property.</li>
          <li>Let <var>timing</var>'s <a data-lt="clock skew" href="#dfn-clock-skew" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-clock-skew-3">internal skew</a> be <var>provider</var>'s <code>skew</code> property.</li>
          <li><a href="#dfn-observe" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-observe-1">Observe</a> <var>provider</var>.</li>
          <li>
            When an update to the <code>readyState</code> property is observed, run the following substeps:
            <ol>
              <li>If the transition from the current <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-4">state</a> of <var>timing</var> to the new value is in the list of <a href="#dfn-allowed-state-transitions" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-allowed-state-transitions-1">allowed state transitions</a>, let <var>timing</var>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-5">state</a> be the new value. Otherwise, let <var>timing</var>'s <code>state</code> be <code>closed</code> and <a href="#dfn-stop-observing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-stop-observing-1">stop observing</a> <var>provider</var>.</li>
              <li>If the <code>error</code> property of <var>provider</var> is not null, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <code>error</code> at <var>timing</var>.</li>
              <li><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <code>readystatechange</code> at <var>timing</var>.</li>
            </ol>
          </li>
          <li>
            When an update to the <code>vector</code> property is observed, run the following substeps:
            <ol>
              <li>Let <var>newVector</var> be the new value of <var>provider</var>'s <code>vector</code> property.</li>
              <li><a href="#dfn-process-vector-change" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-process-vector-change-1">Process vector change</a> with <var>newVector</var> as parameter.</li>
            </ol>
          </li>
          <li>
            When an update to the <code>skew</code> property is observed, run the following substeps:
            <ol>
              <li>Let <var>newSkew</var> be the new value of <var>provider</var>'s <code>skew</code> property.</li>
              <li><a href="#dfn-process-skew-change" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-process-skew-change-1">Process skew change</a> with <var>newSkew</var> as parameter.</li>
            </ol> 
          </li>
          <li>Return <var>timing</var>.</li>
        </ol>

        <p>
          When a <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-8">user agent</a> is required to <dfn id="dfn-observe" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">observe</dfn> an object and run specific steps when an update to a property is detected, it <em class="rfc2119">MUST</em> start to monitor the changes made to that object in the background and run the given steps as soon as the requested change is observed.
        </p>
        <p>
          When a <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-9">user agent</a> is required to <dfn id="dfn-stop-observing" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">stop observing</dfn> an object, it <em class="rfc2119">MUST</em> stop any monitoring that was running on that object in the background.
        </p>
        <div class="issue" id="issue-container-generatedID-4"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="4"><span>Issue</span></div><p class="">
          This <a data-lt="observe" href="#dfn-observe" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-observe-2">observing</a> mechanism is meant to emulate the <code>Object.observe</code> method that is being proposed in EcmaScript 7 to simplify the <code><a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-6"><code>TimingProvider</code></a></code> interface and requirements set on a <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-6">timing resource provider</a>, as well as to work around the fact that <code><a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-7"><code>TimingProvider</code></a></code> cannot inherit <a data-link-type="interface" data-lt="EventTarget" href="https://dom.spec.whatwg.org/#eventtarget"><code>EventTarget</code></a>. The Multi-Device Timing Community Group welcomes feedback as to whether this approach is doable in practice.
        </p></div>
      </section>

      <section id="process-a-query-operation"><div class="header-wrapper"><h3 id="x5-2-process-a-query-operation"><bdi class="secno">5.2 </bdi>Process a query operation</h3><a class="self-link" href="#process-a-query-operation" aria-label="Permalink for Section 5.2"></a></div>
        

        <p>
          The <dfn data-dfn-for="TimingObject" data-export="" data-dfn-type="method" id="dom-timingobject-query" data-idl="operation" data-title="query" data-type="TimingStateVector" data-lt="query()" data-local-lt="TimingObject.query|TimingObject.query()|query" tabindex="0" aria-haspopup="dialog"><code>query</code></dfn> method returns a snapshot derived from the evaluation of <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-9">internal vector</a> against the current timestamp of the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-5">internal clock</a>. When the method is invoked on a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-51">timing object</a> <var>timing</var>, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-10">user agent</a> <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>timing</var> be that <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-5"><code>TimingObject</code></a></code>.</li>
          <li>If the <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-6">state</a> of <var>timing</var> is not <code>open</code>, throw  new <code>InvalidStateError</code> and abort all further steps.</li>
          <li>Let <var>t<sub>u</sub></var> be the reading of the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-6">internal clock</a>, defining the processing time of the operation.</li>
          <li>Let (<var>p<sub>int</sub></var>, <var>v<sub>int</sub></var>, <var>a<sub>int</sub></var>, <var>t<sub>int</sub></var>) represent the <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-10">internal vector</a> of <var>timing</var>.</li>
          <li>If the <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-5">timing provider source</a> of <var>timing</var> is null, let <var>d</var> be <code><var>t<sub>u</sub></var>-<var>t<sub>int</sub></var></code>.</li>
          
          <li>If the <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-6">timing provider source</a> of <var>timing</var> is not null, let <var>d</var> be <code><a href="#dfn-translate_u2p" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-translate_u2p-1"><code>translate_u2p</code></a>(<var>t<sub>u</sub></var>)-<var>t<sub>int</sub></var></code>.</li>
          
          <li>Let <var>p</var> be <var>p<sub>int</sub></var> + <var>v<sub>int</sub></var> * <var>d</var> + 1/2 * <var>a<sub>int</sub></var> * <var>d</var><sup>2</sup></li>
          <li>Let <var>v</var> be <var>v<sub>int</sub></var> + <var>a<sub>int</sub></var> * <var>d</var></li>
          <li>Let <var>a</var> be <var>a<sub>int</sub></var></li>
          <li>Let <var>result</var> be newly created <code><a href="#dom-timingstatevector" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingstatevector-3"><code>TimingStateVector</code></a></code> from four-tuple (<var>p</var>, <var>v</var>, <var>a</var>, <var>t<sub>u</sub></var>)

          </li><li>Range violation is detected. If <var>timing</var>'s <a href="#dfn-range" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-range-5">range</a> does not <a href="#dfn-cover" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cover-2">cover</a> <var>p</var>, run the following substeps:
            <ol>
              <li>Let <var>start</var> be <var>timing</var>'s <code>startPosition</code> property.</li>
              <li>Let <var>end</var> be <var>timing</var>'s <code>endPosition</code> property.</li>
              <li>Let <var>p<sub>modified</sub></var> be either <var>start</var> or <var>end</var>, whichever is closest to <var>p</var>.</li>
              <li>Let <var>vector</var> be newly created <code>TimingStateVectorUpdate</code> that from three-tuple (<var>p<sub>modified</sub></var>, 0, 0).</li>
              <li>Let <var>timing</var>'s <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-11">internal vector</a> be <var>vector</var>.</li>
              <li>Clear the <a href="#dfn-current-range-timeout" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-range-timeout-1">current range timeout</a> of <var>timing</var>.</li>
              <li><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <code>change</code> at the <var>timing</var>.</li>
              <li>Let <var>result</var> be result from invoking <a href="#dom-timingobject-query" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-query-2"><code>query</code></a> method on <var>timing</var> (recursively).</li>
            </ol>
          </li>
          <li>Return <var>result</var>.</li>
        </ol>
      </section>



      <section id="process-an-update-operation"><div class="header-wrapper"><h3 id="x5-3-process-an-update-operation"><bdi class="secno">5.3 </bdi>Process an update operation</h3><a class="self-link" href="#process-an-update-operation" aria-label="Permalink for Section 5.3"></a></div>
        
        <p>
          The <dfn data-dfn-for="TimingObject" data-export="" data-dfn-type="method" id="dom-timingobject-update" data-idl="operation" data-title="update" data-type="Promise" data-lt="update()|update(newVector)" data-local-lt="TimingObject.update|TimingObject.update()|update" tabindex="0" aria-haspopup="dialog"><code>update</code></dfn> method sends a request for the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-52">timing object</a> to update its current motion based on the provided <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-5">state vector</a>, or, if the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-53">timing object</a> is associated with a <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-11">timing provider object</a>, the request is sent to an <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-4">external timing resource</a> via the <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-7">timing provider source</a>. In both cases, a <code>Promise</code> that the update was taken into account is returned. The method supports <code>null</code> or <code>undefined</code> values for the provided <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-6">state vector</a> attributes. This provides a simple mechanism for tying movements together. The idea is to allow one aspect of the movement to be updated while preserving the others. For instance, <code>{position:null, velocity:value, acceleration:null}</code> means <i>update the velocity to the given value while preserving the current position and acceleration</i>. If all attributes of the <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-7">state vector</a> are <code>null</code> or <code>undefined</code>, the method is a noop and returns immediately.
        </p>
        <p>
          When the <a href="#dom-timingobject-update" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-update-2"><code>update</code></a> method is invoked on a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-54">timing object</a> <var>timing</var>, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-11">user agent</a> <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>timing</var> be that <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-6"><code>TimingObject</code></a></code>.</li>
          <li>If the <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-7">state</a> of <var>timing</var> is not <code>open</code>, return a new <code>Promise</code>, reject the promise with <code>InvalidStateError</code> and abort all further steps.</li>

          <li>Let <var>newVector</var> be the method's first parameter.</li>
          <li>If the <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-8">timing provider source</a> of <var>timing</var> is not null, run the following substeps, and abort the remaining steps:
            <ol>
              <li>Let <var>promise<sub>provider</sub></var> be the result of calling <code>update()</code> on the <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-9">timing provider source</a> object with <var>newVector</var> as parameter. If the call throws an exception, return a new <code>Promise</code>, reject the promise with the exception and abort all remaining steps. Similarly, if the call does not return a <code>Promise</code>, return a new <code>Promise</code>, reject the promise with a <code>TypeError</code> and abort all remaining steps.</li>
              <li>Return <var>promise<sub>provider</sub></var>.</li>
            </ol>
          </li>

          <li>Let <var>nowVector</var> be result from invoking <a href="#dom-timingobject-query" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-query-3"><code>query</code></a> method on <var>timing</var>.</li>
          <li>Let <var>intVector</var> be <var>timing</var>'s' <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-12">internal vector</a>.</li> 

          <li>Let (<var>p<sub>new</sub></var>, <var>v<sub>new</sub></var>, <var>a<sub>new</sub></var>) be the three-tuple represented by <var>newVector</var>.</li>
          <li>Let (<var>p<sub>now</sub></var>, <var>v<sub>now</sub></var>, <var>a<sub>now</sub></var>, <var>t<sub>now</sub></var>) be the four-tuple represented <var>nowVector</var>.</li>
          <li>Let (<var>p<sub>int</sub></var>, <var>v<sub>int</sub></var>, <var>a<sub>int</sub></var>, <var>t<sub>int</sub></var>) be the four-tuple represented <var>intVector</var>.</li>

          <li>Let <var>p</var> be <var>p<sub>new</sub></var>, or <var>p<sub>now</sub></var> if <var>p<sub>new</sub></var> is <code>null</code> or <code>undefined</code>.
          </li><li>Let <var>v</var> be <var>v<sub>new</sub></var>, or <var>v<sub>now</sub></var> if <var>v<sub>new</sub></var> is <code>null</code> or <code>undefined</code>.
          </li><li>Let <var>a</var> be <var>a<sub>new</sub></var>, or <var>a<sub>now</sub></var> if <var>a<sub>new</sub></var> is <code>null</code> or <code>undefined</code>.

          </li><li>Avoid range violation on update. Run the following substeps:
            <ol>
              <li>If <var>timing</var>'s <a href="#dfn-range" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-range-6">range</a> does not <a href="#dfn-cover" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cover-3">cover</a> <var>p</var> throw a new <code>IllegalValueError</code> and abort any further steps.</li>
              <li>Let <var>start</var> be <var>timing</var>'s <code>startPosition</code> property.</li>
              <li>If <code><var>p</var> === start &amp;&amp; (<var>v</var> &lt; 0|| (<var>v</var> === 0 &amp;&amp; <var>a</var> &lt; 0))</code> throw a new <code>IllegalValueError</code> and abort any further steps.</li>
              <li>Let <var>end</var> be <var>timing</var>'s <code>endPosition</code> property.</li>
              <li>If <code><var>p</var> === end &amp;&amp; (<var>v</var> &gt; 0 || (<var>v</var> === 0 &amp;&amp; <var>a</var> &gt; 0))</code> throw a new <code>IllegalValueError</code> and abort any further steps.</li>
            </ol>
          </li>
 
          <li>Let <var>vector</var> be a newly created <code><a href="#dom-timingstatevector" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingstatevector-4"><code>TimingStateVector</code></a></code> that represents the four-tuple (<var>p</var>, <var>v</var>, <var>a</var>, <var>t<sub>now</sub></var>).</li>
          <li>Set the <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-13">internal vector</a> of <var>timing</var> to <var>vector</var>.</li>
          <li><a data-lt="set the internal timeout" href="#dfn-set-the-internal-timeout" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-set-the-internal-timeout-2">Set the internal timeout</a> of <var>timing</var>.</li>
          <li><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <code>change</code> at <var>timing</var>.</li>
          <li>Resolve <var>promise</var>.</li>
        </ol>
      </section>

      <section id="set-the-internal-timeout"><div class="header-wrapper"><h3 id="x5-4-set-the-internal-timeout"><bdi class="secno">5.4 </bdi>Set the internal timeout</h3><a class="self-link" href="#set-the-internal-timeout" aria-label="Permalink for Section 5.4"></a></div>
        
        <p>
          If <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-55">timing object</a>'s properties <code>startPosition</code> and <code>endPosition</code> are specified, e.g. <code>[0,123]</code>, the timing object must schedule a future <code>update</code> operation on itself, to ensure that the <a href="#dfn-range" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-range-7">range</a> is not violated.
        </p><p>
        </p><p>
          When the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-12">user agent</a> is required to <dfn id="dfn-set-the-internal-timeout" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">set the internal timeout</dfn> of a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-56">timing object</a>, it must run the following steps:
        </p>
        <ol>
          <li>Let <var>timing</var> be that <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-7"><code>TimingObject</code></a></code>.</li>
          <li>If <var>timing</var>'s <a href="#dfn-current-range-timeout" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-range-timeout-2">current range timeout</a> is not null, cancel the timeout and let <var>timing</var>'s <a href="#dfn-current-range-timeout" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-range-timeout-3">current range timeout</a> be null.</li>
          <li>Let <var>startPos</var> be <var>timing</var>'s <code>startPosition</code>.</li>
          <li>Let <var>endPos</var> be <var>timing</var>'s <code>endPosition</code>.</li>
          <li>Given the current motion, let <var>endpoint</var> be the first of <var>startPos</var> or <var>endPos</var> to be violated first, if any, and let <var>t</var> be the time when this will occur according to the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-7">internal clock</a>.</li>
          <li>If <var>endpoint</var> is null or Infinity or -Infinity, abort all further steps.</li>
          <li>Let <var>vector</var> be the <code>TimingStateVector</code> represented by four-tuple (<var>endpoint</var>, 0, 0, t).</li>
          <li>Let <var>timing</var>'s <a href="#dfn-current-range-timeout" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-range-timeout-4">current range timeout</a> be a newly created timeout to execute an <code>update</code> operation on <var>timing</var> with <var>vector</var> as parameter, at the moment when the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-8">internal clock</a> reaches <var>t</var>.</li> 
        </ol>
      </section>

      <section id="cover-a-position"><div class="header-wrapper"><h3 id="x5-5-cover-a-position"><bdi class="secno">5.5 </bdi>Cover a position</h3><a class="self-link" href="#cover-a-position" aria-label="Permalink for Section 5.5"></a></div>
        
        <p>
          When the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-13">user agent</a> is required to evaluate whether a <a href="#dfn-range" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-range-8">range</a> composed of possibly infinite lower and upper bounds <dfn data-lt="cover|covers" id="dfn-cover" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">covers</dfn> a provided value, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-14">user agent</a> <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol data-link-for="TimingObject">
          <li>Let <var>value</var> be the position to evaluate.</li>
          <li>If <var>value</var> is smaller than the <a href="#dfn-range" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-range-9">range</a>'s lower bound, return <code>false</code>, and abort these steps.</li>
          <li>If <var>value</var> is greater than the <a href="#dfn-range" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-range-10">range</a>'s upper bound, return <code>false</code>, and abort these steps.</li>
          <li>Return true.</li>
        </ol>
      </section>

      <section id="process-vector-change"><div class="header-wrapper"><h3 id="x5-6-process-vector-change"><bdi class="secno">5.6 </bdi>Process Vector Change</h3><a class="self-link" href="#process-vector-change" aria-label="Permalink for Section 5.6"></a></div>
        
        <p>
          When the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-15">user agent</a> is required to <dfn id="dfn-process-vector-change" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">process vector change</dfn> on a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-57">timing object</a>, it <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>timing</var> be that <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-8"><code>TimingObject</code></a></code>.</li>
          <li>Let <var>newVector</var> be the new vector.</li>
          <li>Let <var>timing</var>'s <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-14">internal vector</a> be <var>newVector</var>.</li>
          <li><a data-lt="set the internal timeout" href="#dfn-set-the-internal-timeout" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-set-the-internal-timeout-3">Set the internal timeout</a> of <var>timing</var>.</li>
          <li><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <code>change</code> at <var>timing</var>.</li>
        </ol>
      </section>

      <section id="process-skew-change"><div class="header-wrapper"><h3 id="x5-7-process-skew-change"><bdi class="secno">5.7 </bdi>Process Skew Change</h3><a class="self-link" href="#process-skew-change" aria-label="Permalink for Section 5.7"></a></div>
        
        <p>
          When the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-16">user agent</a> is required to <dfn id="dfn-process-skew-change" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">process skew change</dfn> on a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-58">timing object</a>, it <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>timing</var> be that <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-9"><code>TimingObject</code></a></code>.</li>
          <li>Let <var>newSkew</var> be the new skew.</li>
          <li>Let <var>oldSkew</var> be <var>timing</var>'s <a href="#dfn-clock-skew" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-clock-skew-4">internal clock skew</a>.</li>
          <li>Let <var>timing</var>'s <a href="#dfn-clock-skew" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-clock-skew-5">internal clock skew</a> be <var>newSkew</var>.</li>
          <li>Update variables used by <code><a data-lt="calculate skew adjustment" href="#dfn-calculate_skew_adjustment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-calculate_skew_adjustment-1"><code>calculate_skew_adjustment()</code></a></code> based on <var>newSkew</var> and <var>oldSkew</var></li>
        </ol>
      </section>
     
      <section id="translate-timestamp-from-user-agent-to-timing-resource-provider-timeline"><div class="header-wrapper"><h3 id="x5-8-translate-timestamp-from-user-agent-to-timing-resource-provider-timeline"><bdi class="secno">5.8 </bdi>Translate timestamp from user agent to timing resource provider timeline</h3><a class="self-link" href="#translate-timestamp-from-user-agent-to-timing-resource-provider-timeline" aria-label="Permalink for Section 5.8"></a></div>
        
        <p>
          <dfn data-lt="translate_u2p|tp = translate_u2p(tu)" id="dfn-translate_u2p" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code><var>t<sub>p</sub></var> = translate_u2p(<var>t<sub>u</sub></var>)</code></dfn> translates a timestamp from the timeline of the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-17">user agent</a> (u) to the timeline of the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-7">timing resource provider</a> (p).
        </p>
        <p>
          When the <a href="#dfn-translate_u2p" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-translate_u2p-2"><code>translate_u2p</code></a> method is invoked, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-18">user agent</a> <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>t<sub>u</sub></var> be the first parameter.</li>
          <li>Let <var>skew</var> be the value of <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-10">timing provider source</a>'s <code>skew</code> property.</li>
          <li>Let <var>effectiveskew</var> be the result of <var>skew</var> - <a data-lt="calculate skew adjustment" href="#dfn-calculate_skew_adjustment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-calculate_skew_adjustment-2"><code>calculate_skew_adjustment()</code></a></li>
          <li>Return <var>t<sub>u</sub></var> + <var>effectiveskew</var>.</li>
        </ol>
      </section>


      <section id="translate-timestamp-from-timing-resource-provider-to-user-agent-timeline"><div class="header-wrapper"><h3 id="x5-9-translate-timestamp-from-timing-resource-provider-to-user-agent-timeline"><bdi class="secno">5.9 </bdi>Translate timestamp from timing resource provider to user agent timeline</h3><a class="self-link" href="#translate-timestamp-from-timing-resource-provider-to-user-agent-timeline" aria-label="Permalink for Section 5.9"></a></div>
        
        <p>
          <dfn data-lt="translate_p2u|tu = translate_p2u(tp)" id="dfn-translate_p2u" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code><var>t<sub>u</sub></var> = translate_p2u(<var>t<sub>p</sub></var>)</code></dfn> translates a timestamp from the timeline of the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-8">timing resource provider</a> (p) to the timeline of the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-19">user agent</a> (u).
        </p>
        <p>
          When the <a href="#dfn-translate_p2u" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-translate_p2u-1"><code>translate_p2u</code></a> method is invoked, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-20">user agent</a> <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>t<sub>p</sub></var> be the first parameter.</li>
          <li>Let <var>skew</var> be the value of <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-11">timing provider source</a>'s <code>skew</code> property.</li>
          <li>Let <var>effectiveskew</var> be the result of <var>skew</var> - <a data-lt="calculate skew adjustment" href="#dfn-calculate_skew_adjustment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-calculate_skew_adjustment-3"><code>calculate_skew_adjustment()</code></a></li>
          <li>Return <var>t<sub>p</sub></var> - <var>effectiveskew</var>.</li>
        </ol>
      </section>


      <section id="calculate-skew-adjustment"><div class="header-wrapper"><h3 id="x5-10-calculate-skew-adjustment"><bdi class="secno">5.10 </bdi>Calculate skew adjustment</h3><a class="self-link" href="#calculate-skew-adjustment" aria-label="Permalink for Section 5.10"></a></div>
        
        <p>
          A <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-21">user agent</a> <em class="rfc2119">MUST</em> implement skew changes reported by a <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-12">timing provider object</a> gradually, in order to ensure the monotonicity of <code>timestamp</code> values reported by the <a href="#dom-timingobject-query" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-query-4"><code>query</code></a> method of a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-59">timing object</a>. For example, if the skew estimate increases by 2 ms at one point, one might want to apply this change at a certain rate, for instance 1 ms change per 10ms, so that, after 20ms, the 2ms change is fully applied. To achieve this, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-22">user agent</a> may update the <a href="#dfn-clock-skew" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-clock-skew-6">internal clock skew</a> immediately on skew change, and then define a linear adjustment function that is subtracted from the skew. In the above example the function will subtract the full 2ms initially, 1ms after 10ms, and then 0ms after 20ms. New skew changes must be integrated into the adjustment function.
        </p>
        <p>
          The internal <dfn data-lt="calculate_skew_adjustment|calculate_skew_adjustment()" id="dfn-calculate_skew_adjustment" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code>calculate_skew_adjustment()</code></dfn> method implements this logic. If the method always returns <code>0</code>, skew changes are fully applied as soon as they are received (i.e. not gradually applied). The logic of this method involves some bookkeeping, i.e. how much of the skew changed is already applied at a given point, and how much remains. New skew changes require this information to be re-evaluated. Note that this function is only invoked as part of a query operation. The actual logic of this method is left unspecified.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-4" aria-level="4"><span>Note</span></div><p class="">
          In practice, it is not clear that monotonic behavior at the millisecond scale is required by any of the existing use cases. Monotonic behavior is still included as requirement on the assumption that it may enable future use cases, and that is does not add much complexity. 
        </p></div>
      </section>


      <section id="connection-states"><div class="header-wrapper"><h3 id="x5-11-connection-states"><bdi class="secno">5.11 </bdi>Connection states</h3><a class="self-link" href="#connection-states" aria-label="Permalink for Section 5.11"></a></div>
        
        <p>
          The connection with the <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-5">timing resource</a> that the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-60">timing object</a> represents may take the following states:
        </p>
        <pre class="idl def" id="webidl-2141639081"><span class="idlHeader"><a class="self-link" href="#webidl-2141639081">WebIDL</a></span><code><span data-idl="" class="idlEnum" id="idl-def-timingobjectstate" data-title="TimingObjectState">enum <dfn data-export="" data-dfn-type="enum" id="dom-timingobjectstate" data-idl="enum" data-title="TimingObjectState" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>TimingObjectState</code></dfn> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-timingobjectstate-connecting" id="ref-for-dom-timingobjectstate-connecting-1"><code>connecting</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-timingobjectstate-open" id="ref-for-dom-timingobjectstate-open-1"><code>open</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-timingobjectstate-closing" id="ref-for-dom-timingobjectstate-closing-1"><code>closing</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-timingobjectstate-closed" id="ref-for-dom-timingobjectstate-closed-1"><code>closed</code></a>"</span>
};</span></code></pre>
        <dl data-dfn-for="TimingObjectState">
          <dt><dfn data-export="" data-dfn-type="enum-value" id="dom-timingobjectstate-connecting" data-idl="enum-value" data-title="connecting" data-dfn-for="TimingObjectState" tabindex="0" aria-haspopup="dialog"><code>connecting</code></dfn></dt>
          <dd>The <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-61">timing object</a> is attempting to establish a connection with the <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-6">timing resource</a> it represents. This is the initial state when a new <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-10"><code>TimingObject</code></a></code> is created. This state is also used when a <code><a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-8"><code>TimingProvider</code></a></code> object is associated with the <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-11"><code>TimingObject</code></a></code>.</dd>

          <dt><dfn data-export="" data-dfn-type="enum-value" id="dom-timingobjectstate-open" data-idl="enum-value" data-title="open" data-dfn-for="TimingObjectState" tabindex="0" aria-haspopup="dialog"><code>open</code></dfn></dt>
          <dd>The connection with the <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-7">timing resource</a> is established and communication is possible.</dd>

          <dt><dfn data-export="" data-dfn-type="enum-value" id="dom-timingobjectstate-closing" data-idl="enum-value" data-title="closing" data-dfn-for="TimingObjectState" tabindex="0" aria-haspopup="dialog"><code>closing</code></dfn></dt>
          <dd>The procedure to close down the connection with the <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-8">timing resource</a> has started.</dd>

          <dt><dfn data-export="" data-dfn-type="enum-value" id="dom-timingobjectstate-closed" data-idl="enum-value" data-title="closed" data-dfn-for="TimingObjectState" tabindex="0" aria-haspopup="dialog"><code>closed</code></dfn></dt>
          <dd>The connection with the <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-9">timing resource</a> has been closed or could not be established.</dd>
        </dl>

        <p>
          The <dfn id="dfn-allowed-state-transitions" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">allowed state transitions</dfn> are:
        </p>
        <ul>
          <li>from <code>connecting</code> to any of the other states;</li>
          <li>from <code>open</code> to <code>closing</code> and <code>closed</code>;</li>
          <li>from <code>closing</code> to <code>closed</code>.</li>
        </ul>
      </section>

      <section id="event-handlers"><div class="header-wrapper"><h3 id="x5-12-event-handlers"><bdi class="secno">5.12 </bdi>Event handlers</h3><a class="self-link" href="#event-handlers" aria-label="Permalink for Section 5.12"></a></div>
        

        <p>The following are the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handlers</a> (and their corresponding <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event types</a>) that <em class="rfc2119">MUST</em> be supported as attributes by a <a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-12"><code>TimingObject</code></a> object. All events use the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event">Event</a> interface.</p>

        <table data-dfn-for="TimingObject">
          <thead>
            <tr>
              <th>Event handler</th>
              <th>Event handler event type</th>
              <th>Fired</th>
            </tr>
          </thead>
          <tbody>
 
            <tr>
              <td><dfn data-export="" data-dfn-type="attribute" id="dom-timingobject-onchange" data-idl="attribute" data-title="onchange" data-dfn-for="TimingObject" data-type="EventHandler" data-lt="onchange" data-local-lt="TimingObject.onchange" tabindex="0" aria-haspopup="dialog"><code>onchange</code></dfn></td>
              <td><code>change</code></td>
              <td>The <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-15">internal vector</a> is changed. Fired after the <code>update()</code> method has returned, or when an update is received from the <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-5">external timing resource</a>.</td>
            </tr>
            <tr>
              <td><dfn data-export="" data-dfn-type="attribute" id="dom-timingobject-onreadystatechange" data-idl="attribute" data-title="onreadystatechange" data-dfn-for="TimingObject" data-type="EventHandler" data-lt="onreadystatechange" data-local-lt="TimingObject.onreadystatechange" tabindex="0" aria-haspopup="dialog"><code>onreadystatechange</code></dfn></td>
              <td><code>readystatechange</code></td>
              <td>The <code>readyState</code> attribute changed.<br></td>
            </tr>
            <tr>
              <td><dfn data-export="" data-dfn-type="attribute" id="dom-timingobject-ontimeupdate" data-idl="attribute" data-title="ontimeupdate" data-dfn-for="TimingObject" data-type="EventHandler" data-lt="ontimeupdate" data-local-lt="TimingObject.ontimeupdate" tabindex="0" aria-haspopup="dialog"><code>ontimeupdate</code></dfn></td>
              <td><code>timeupdate</code></td>
              <td>Fires periodically with fixed frequency 5Hz, except when timing object is paused. This is intended as a shorthand alternative for setting up a polling-loop with setInterval, or as an emulation of the pulse-based timing model that programmers are currently used to.</td>
            </tr>
            <tr>
              <td><dfn data-export="" data-dfn-type="attribute" id="dom-timingobject-onerror" data-idl="attribute" data-title="onerror" data-dfn-for="TimingObject" data-type="EventHandler" data-lt="onerror" data-local-lt="TimingObject.onerror" tabindex="0" aria-haspopup="dialog"><code>onerror</code></dfn></td>
              <td><dfn id="dfn-error" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code>error</code></dfn></td>
              <td>Fired when an operation on the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-62">timing object</a> cannot complete for some reason, (e.g. because of a loss of connection with the <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-10">timing resource</a>).</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>







    

    <section id="timing-provider-object"><div class="header-wrapper"><h2 id="x6-timing-provider-object"><bdi class="secno">6. </bdi>Timing Provider Object</h2><a class="self-link" href="#timing-provider-object" aria-label="Permalink for Section 6."></a></div>

      
      <p>
        A <dfn data-lt="timing provider object|timing provider objects" id="dfn-timing-provider-object" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">timing provider object</dfn> is an object exposed by a <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-9">timing resource provider</a> that encapsulates the logic necessary to associate a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-63">timing object</a> with an <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-6">external timing resource</a>.
      </p>
      <p>
        The concept is introduced in order to leave space open for innovation among online timing providers. The purpose is to decouple the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-23">user agent</a> from any particular <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-10">timing resource provider</a>: third-parties may provide different implementations of <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-13">timing provider objects</a> in JavaScript, to which <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-64">timing objects</a> may be connected. In particular, this means that the protocols and logic used to identify, create or destroy an <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-7">external timing resource</a>, synchronize clocks and propagate <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-8">state vectors</a> to connected user agents, are up to the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-11">timing resource provider</a>. Similarly, a <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-12">timing resource provider</a> may require Web applications or users to authenticate themselves before they grant them access to a particular <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-11">timing resource</a>.
      </p>
      <p>
        In practice, a Web application willing to use a particular <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-13">timing resource provider</a> needs to load the corresponding JavaScript library provided by this <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-14">timing resource provider</a>, create a <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-14">timing provider object</a> and pass that object to the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-65">timing object</a> constructor.
      </p>
      <p>
        The <a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-9"><code>TimingProvider</code></a> interface allows the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-66">timing object</a> to exercise control over the <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-15">timing provider object</a>, as well as be notified of state changes as soon as they occur, in particular <a href="#state-vector-synchronization">state vectors</a> and <a href="#clock-synchronization">clock skew estimates</a> are exchanged across this interface.</p>
      <p>
        The <dfn id="dfn-skew" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">skew</dfn> specifies how timestamps may be translated between the timeline of the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-9">internal clock</a> and that used by the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-15">timing resource provider</a>. In the case of <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-2">online timing resources</a>, the <a href="#dfn-skew" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-skew-2">skew</a> is a floating estimate (due to variance in network latency and relative clock drift over time). The <code>query</code> operation on the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-67">timing object</a> should always be resolved based on a fresh <a href="#dfn-skew" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-skew-3">skew</a> estimate received from the <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-16">timing provider object</a>. <a href="#dfn-skew" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-skew-4">Skew</a> is expressed in <i>seconds</i> and defined by the following equation (where <var>clock<sub>user agent</sub></var> is the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-10">internal clock</a>): 
      </p>
      <p>
        <var>clock<sub>timing provider</sub></var> === <var>clock<sub>user agent</sub></var> + <var>skew</var>
      </p>
      <p>
        A <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-17">timing provider object</a> implements the following interface:
      </p>

      <pre class="idl def" id="webidl-890123178"><span class="idlHeader"><a class="self-link" href="#webidl-890123178">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-timingprovider" data-title="TimingProvider">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
interface <dfn data-export="" data-dfn-type="interface" id="dom-timingprovider" data-idl="interface" data-title="TimingProvider" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>TimingProvider</code></dfn> {<span data-idl="" class="idlAttribute" id="idl-def-timingprovider-vector" data-title="vector" data-dfn-for="TimingProvider">
  readonly    attribute<span class="idlType"> <a data-link-type="idl" href="#dom-timingstatevector" class="internalDFN" id="ref-for-dom-timingstatevector-5"><code>TimingStateVector</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingprovider-vector" id="ref-for-dom-timingprovider-vector-1"><code>vector</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingprovider-startposition" data-title="startPosition" data-dfn-for="TimingProvider">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingprovider-startposition" id="ref-for-dom-timingprovider-startposition-1"><code>startPosition</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingprovider-endposition" data-title="endPosition" data-dfn-for="TimingProvider">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingprovider-endposition" id="ref-for-dom-timingprovider-endposition-1"><code>endPosition</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingprovider-readystate" data-title="readyState" data-dfn-for="TimingProvider">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span>         <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingprovider-readystate" id="ref-for-dom-timingprovider-readystate-1"><code>readyState</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingprovider-skew" data-title="skew" data-dfn-for="TimingProvider">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingprovider-skew" id="ref-for-dom-timingprovider-skew-1"><code>skew</code></a>;</span><span data-idl="" class="idlMethod" id="idl-def-timingprovider-update-newvector" data-title="update" data-dfn-for="TimingProvider"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-timingprovider-update" id="ref-for-dom-timingprovider-update-1"><code>update</code></a> (optional<span class="idlType"> <a data-link-type="idl" href="#dom-timingstatevectorupdate" class="internalDFN" id="ref-for-dom-timingstatevectorupdate-3"><code>TimingStateVectorUpdate</code></a></span> <span class="idlParamName">newVector</span> = {});</span>
};</span></code></pre>

      <div data-dfn-for="TimingProvider">
        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingprovider-vector" data-idl="attribute" data-title="vector" data-dfn-for="TimingProvider" data-type="TimingStateVector" data-lt="vector" data-local-lt="TimingProvider.vector" tabindex="0" aria-haspopup="dialog"><code>vector</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-9">state vector</a> that represents the initial conditions of the current motion.
        </p>
        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingprovider-startposition" data-idl="attribute" data-title="startPosition" data-dfn-for="TimingProvider" data-type="unrestricted double" data-lt="startPosition" data-local-lt="TimingProvider.startPosition" tabindex="0" aria-haspopup="dialog"><code>startPosition</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the lower bound that constrains the position of the <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-10">state vector</a>, if any.
        </p>
        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingprovider-endposition" data-idl="attribute" data-title="endPosition" data-dfn-for="TimingProvider" data-type="unrestricted double" data-lt="endPosition" data-local-lt="TimingProvider.endPosition" tabindex="0" aria-haspopup="dialog"><code>endPosition</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the upper bound that constrains the position of the <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-11">state vector</a>, if any.
        </p>
        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingprovider-readystate" data-idl="attribute" data-title="readyState" data-dfn-for="TimingProvider" data-type="DOMString" data-lt="readyState" data-local-lt="TimingProvider.readyState" tabindex="0" aria-haspopup="dialog"><code>readyState</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the current state of the connection with the <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-12">timing resource</a>.
        </p>
        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingprovider-skew" data-idl="attribute" data-title="skew" data-dfn-for="TimingProvider" data-type="unrestricted double" data-lt="skew" data-local-lt="TimingProvider.skew" tabindex="0" aria-haspopup="dialog"><code>skew</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the current estimate of the skew.
        </p>
      </div>

      <div class="issue" id="issue-container-number-10"><div role="heading" class="issue-title marker" id="h-issue-2" aria-level="3"><a href="https://github.com/webtiming/timingobject/issues/10"><span class="issue-number">Issue 10</span></a><span class="issue-label">: Run TimingProvider code in a separate JavaScript realm</span></div><p dir="auto">The proposed <code class="notranslate">TimingProvider</code> interface is intended to allow the inclusion of code maintained by a third-party timing provider. This code would typically need to create a communication channel to a backend server under the control of the timing provider.</p>
<p dir="auto">As things stand, this would require the timing provider to enable CORS for arbitrary origins, which does not seem to be a good thing.</p>
<p dir="auto">WebRTC has a similar need for <a href="http://w3c.github.io/webrtc-pc/#identity-provider-interaction" rel="nofollow">Identity Providers</a>. In practice, WebRTC requires the user agent to instantiate a separate JavaScript realm (some sort of worker in short) that operates <strong>in the origin of the loaded JavaScript</strong> and to load the JavaScript provided by the Identity Provider there. It could be a good idea to apply the same concept to the Timing Object specification.</p>
<p dir="auto">This would have the added benefit that the code provided by the timing provider would not be able to mess with the code owned by the origin of the Web application.</p>
<p dir="auto">Perhaps even more importantly, this would mean that the code of the timing provider would run in its own "thread", meaning that the user agent would be able to interact with it e.g. to retrieve a new timestamp to coordinate video playback in the background (with the current proposal, the user agent would need to queue a task to invoke any method on the TimingProvider object)</p>
<p dir="auto">In practice, this would require to:</p>
<ol dir="auto">
<li>define a <code class="notranslate">TimingProviderRegistrar</code> interface with a "register" method. The user agent would expose one instance of that interface to the TimingProvider code and the timing provider code would call the <code class="notranslate">register</code> method when it loads.</li>
<li>use the URL of the timing provider code rather than a TimingProvider object to associate a TimingObject with a timing provider.</li>
</ol>
<p dir="auto">One possibly important drawback is that, since the TimingProvider object would no longer be exposed to the Web application, additional methods that the timing provider could expose such as mechanism to create/destroy an online timing resource, and authenticate the user, would require out-of-band commuications between the Web Application and the timing provider.</p>
<p dir="auto">What about it?</p></div>

      <section id="process-an-update-operation-0"><div class="header-wrapper"><h3 id="x6-1-process-an-update-operation"><bdi class="secno">6.1 </bdi>Process an update operation</h3><a class="self-link" href="#process-an-update-operation-0" aria-label="Permalink for Section 6.1"></a></div>
        
        <p>
          The <dfn data-dfn-for="TimingProvider" data-export="" data-dfn-type="method" id="dom-timingprovider-update" data-idl="operation" data-title="update" data-type="Promise" data-lt="update()|update(newVector)" data-local-lt="TimingProvider.update|TimingProvider.update()|update" tabindex="0" aria-haspopup="dialog"><code>update</code></dfn> method sends a request to the <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-13">timing resource</a> to have it update the <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-8">external timing resource</a>, based on the provided <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-12">state vector</a>, and returns a <code>Promise</code> that the update was processed by the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-16">timing resource provider</a> (see the <a href="#dom-timingobject-update" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-update-3"><code>update</code></a> method of <a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-13"><code>TimingObject</code></a> objects for more details). When the method is invoked on a <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-18">timing provider object</a> <var>provider</var>, the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-17">timing resource provider</a> <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>promise</var> be a new <code>Promise</code>.</li>
          <li>Return <var>promise</var> and run the following steps in parallel.</li>
          <li>Run whatever logic is necessary to pass the update request to the <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-9">external timing resource</a> that <var>provider</var> represents.</li>
          <li>If this logic succeeds, resolve <var>promise</var>. Otherwise reject <var>promise</var> with an error.</li>
        </ol>
      </section>

      <section id="report-new-conditions-of-the-current-motion"><div class="header-wrapper"><h3 id="x6-2-report-new-conditions-of-the-current-motion"><bdi class="secno">6.2 </bdi>Report new conditions of the current motion</h3><a class="self-link" href="#report-new-conditions-of-the-current-motion" aria-label="Permalink for Section 6.2"></a></div>
        
        <p>
          When the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-18">timing resource provider</a> needs to report an update to the <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-13">state vector</a> (position, velocity or acceleration) of the <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-10">external timing resource</a> that a <code><a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-10"><code>TimingProvider</code></a></code> object encapsulates, it <em class="rfc2119">MUST</em> set its <a href="#dom-timingprovider-vector" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-vector-2"><code>vector</code></a> property to a new <code><a href="#dom-timingstatevector" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingstatevector-6"><code>TimingStateVector</code></a></code> that represents the new conditions.
        </p>
      </section>

      <section id="report-a-state-change"><div class="header-wrapper"><h3 id="x6-3-report-a-state-change"><bdi class="secno">6.3 </bdi>Report a state change</h3><a class="self-link" href="#report-a-state-change" aria-label="Permalink for Section 6.3"></a></div>
        
        <p>
          When the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-19">timing resource provider</a> needs to report a change of connection state with the <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-11">external timing resource</a> that a <code><a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-11"><code>TimingProvider</code></a></code> object encapsulates, it <em class="rfc2119">MUST</em> set its <a href="#dom-timingprovider-readystate" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-readystate-2"><code>readyState</code></a> property to the new value.
        </p>
      </section>

       <section id="report-a-skew-change"><div class="header-wrapper"><h3 id="x6-4-report-a-skew-change"><bdi class="secno">6.4 </bdi>Report a skew change</h3><a class="self-link" href="#report-a-skew-change" aria-label="Permalink for Section 6.4"></a></div>
        
        <p>
          When the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-20">timing resource provider</a> needs to report a change of the skew estimate with the <a href="#dfn-external-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-external-timing-resource-12">external timing resource</a> that a <code><a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-12"><code>TimingProvider</code></a></code> object encapsulates, it <em class="rfc2119">MUST</em> set its <a href="#dom-timingprovider-skew" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-skew-2"><code>skew</code></a> property to the new value.
        </p>
      </section>

      <section id="report-an-error"><div class="header-wrapper"><h3 id="x6-5-report-an-error"><bdi class="secno">6.5 </bdi>Report an error</h3><a class="self-link" href="#report-an-error" aria-label="Permalink for Section 6.5"></a></div>
        
        <p data-link-for="TimingProvider">
          When the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-21">timing resource provider</a> needs to report an unrecoverable error for a <code><a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-13"><code>TimingProvider</code></a></code> object, it <em class="rfc2119">MUST</em> set its <a href="#dfn-error" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-error-1"><code>error</code></a> property to the error and set its <a href="#dom-timingprovider-readystate" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-readystate-3"><code>readyState</code></a> property to <code>closed</code>.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-5" aria-level="4"><span>Note</span></div><p class="">
          This will effectively make any <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-14"><code>TimingObject</code></a></code> object that has this <code><a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-14"><code>TimingProvider</code></a></code> object as <a href="#dfn-timing-provider-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-source-12">timing provider source</a> enter a final <code>closed</code> state.
        </p></div>
      </section>
    </section>







    



    <section id="state-vector"><div class="header-wrapper"><h2 id="x7-state-vector"><bdi class="secno">7. </bdi>State Vector</h2><a class="self-link" href="#state-vector" aria-label="Permalink for Section 7."></a></div>
      

      <p>
        A <dfn data-lt="state vector|state vectors" id="dfn-state-vector" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">state vector</dfn> represents the classical four-tuple <code>(position, velocity, acceleration, timestamp)</code> associated with the mathematical description of linear motion under constant acceleration. A <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-14">state vector</a> is used to represent the motion of a <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-14">timing resource</a>.
      </p>
      <p>
        In particular, the <a href="#dfn-internal-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-vector-16">internal vector</a> of a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-68">timing object</a> is a <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-15">state vector</a>, the <code>query()</code> operation returns a <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-16">state vector</a> and the <code>update()</code> operation takes a <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-17">state vector</a> as parameter.
      </p>

      <p>A <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-18">State vector</a> implements the following interface:</p>

      <pre class="idl def" id="webidl-104903223"><span class="idlHeader"><a class="self-link" href="#webidl-104903223">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-timingstatevectorupdate" data-title="TimingStateVectorUpdate">dictionary <dfn data-export="" data-dfn-type="dictionary" id="dom-timingstatevectorupdate" data-idl="dictionary" data-title="TimingStateVectorUpdate" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>TimingStateVectorUpdate</code></dfn> {<span data-idl="" class="idlMember" id="idl-def-timingstatevectorupdate-position" data-title="position" data-dfn-for="TimingStateVectorUpdate"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-timingstatevectorupdate-position" data-idl="field" data-title="position" data-dfn-for="TimingStateVectorUpdate" data-type="double" class="idlName" tabindex="0" aria-haspopup="dialog"><code>position</code></dfn>;</span><span data-idl="" class="idlMember" id="idl-def-timingstatevectorupdate-velocity" data-title="velocity" data-dfn-for="TimingStateVectorUpdate"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-timingstatevectorupdate-velocity" data-idl="field" data-title="velocity" data-dfn-for="TimingStateVectorUpdate" data-type="double" class="idlName" tabindex="0" aria-haspopup="dialog"><code>velocity</code></dfn>;</span><span data-idl="" class="idlMember" id="idl-def-timingstatevectorupdate-acceleration" data-title="acceleration" data-dfn-for="TimingStateVectorUpdate"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-timingstatevectorupdate-acceleration" data-idl="field" data-title="acceleration" data-dfn-for="TimingStateVectorUpdate" data-type="double" class="idlName" tabindex="0" aria-haspopup="dialog"><code>acceleration</code></dfn>;</span>
};</span><span data-idl="" class="idlDictionary" id="idl-def-timingstatevectorinit" data-title="TimingStateVectorInit">

dictionary <dfn data-export="" data-dfn-type="dictionary" id="dom-timingstatevectorinit" data-idl="dictionary" data-title="TimingStateVectorInit" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>TimingStateVectorInit</code></dfn> : <span class="idlSuperclass"><a data-link-type="idl" href="#dom-timingstatevectorupdate" class="internalDFN" id="ref-for-dom-timingstatevectorupdate-4"><code>TimingStateVectorUpdate</code></a></span> {<span data-idl="" class="idlMember" id="idl-def-timingstatevectorinit-timestamp" data-title="timestamp" data-dfn-for="TimingStateVectorInit"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-timingstatevectorinit-timestamp" data-idl="field" data-title="timestamp" data-dfn-for="TimingStateVectorInit" data-type="double" class="idlName" tabindex="0" aria-haspopup="dialog"><code>timestamp</code></dfn>;</span>
};</span><span data-idl="" class="idlInterface" id="idl-def-timingstatevector" data-title="TimingStateVector">

[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
interface <dfn data-export="" data-dfn-type="interface" id="dom-timingstatevector" data-idl="interface" data-title="TimingStateVector" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>TimingStateVector</code></dfn> {<span data-idl="" class="idlConstructor" id="idl-def-timingstatevector-constructor-vectordict" data-title="constructor" data-dfn-for="TimingStateVector">
  <dfn data-export="" data-dfn-type="constructor" id="dom-timingstatevector-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="TimingStateVector" data-lt="constructor()|constructor(vectorDict)" data-local-lt="TimingStateVector.constructor|TimingStateVector.constructor()|constructor" tabindex="0" aria-haspopup="dialog"><code>constructor</code></dfn>(optional<span class="idlType"> <a data-link-type="idl" href="#dom-timingstatevectorinit" class="internalDFN" id="ref-for-dom-timingstatevectorinit-1"><code>TimingStateVectorInit</code></a></span> <span class="idlParamName">vectorDict</span> = {});</span><span data-idl="" class="idlAttribute" id="idl-def-timingstatevector-position" data-title="position" data-dfn-for="TimingStateVector">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingstatevector-position" id="ref-for-dom-timingstatevector-position-1"><code>position</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingstatevector-velocity" data-title="velocity" data-dfn-for="TimingStateVector">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingstatevector-velocity" id="ref-for-dom-timingstatevector-velocity-1"><code>velocity</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingstatevector-acceleration" data-title="acceleration" data-dfn-for="TimingStateVector">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingstatevector-acceleration" id="ref-for-dom-timingstatevector-acceleration-1"><code>acceleration</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-timingstatevector-timestamp" data-title="timestamp" data-dfn-for="TimingStateVector">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingstatevector-timestamp" id="ref-for-dom-timingstatevector-timestamp-1"><code>timestamp</code></a>;</span>
};</span></code></pre>

      <div data-dfn-for="TimingStateVector" data-link-for="TimingStateVector">
        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingstatevector-position" data-idl="attribute" data-title="position" data-dfn-for="TimingStateVector" data-type="double" data-lt="position" data-local-lt="TimingStateVector.position" tabindex="0" aria-haspopup="dialog"><code>position</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the position of the <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-19">state vector</a> on its unidimensional axis. The position unit is usage specific. The position may for example represent a point in time in seconds, a height in meters, a slide number in a slide show or something else entirely.
        </p>

        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingstatevector-velocity" data-idl="attribute" data-title="velocity" data-dfn-for="TimingStateVector" data-type="double" data-lt="velocity" data-local-lt="TimingStateVector.velocity" tabindex="0" aria-haspopup="dialog"><code>velocity</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the velocity of the <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-20">state vector</a> on its unidimensional axis. The velocity represents the rate of change of the position, measured in position units per second.
        </p>

        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingstatevector-acceleration" data-idl="attribute" data-title="acceleration" data-dfn-for="TimingStateVector" data-type="double" data-lt="acceleration" data-local-lt="TimingStateVector.acceleration" tabindex="0" aria-haspopup="dialog"><code>acceleration</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the acceleration of the <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-21">state vector</a> on its unidimensional axis. The acceleration represents the rate of change of the velocity, measured in position units per second squared.
        </p>

        <p>
          The <dfn data-export="" data-dfn-type="attribute" id="dom-timingstatevector-timestamp" data-idl="attribute" data-title="timestamp" data-dfn-for="TimingStateVector" data-type="double" data-lt="timestamp" data-local-lt="TimingStateVector.timestamp" tabindex="0" aria-haspopup="dialog"><code>timestamp</code></dfn> attribute <em class="rfc2119">MUST</em> be set to the moment in time when <a href="#dom-timingstatevector-position" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingstatevector-position-2"><code>position</code></a>, <a href="#dom-timingstatevector-velocity" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingstatevector-velocity-2"><code>velocity</code></a> and <a href="#dom-timingstatevector-acceleration" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingstatevector-acceleration-2"><code>acceleration</code></a> were|are|will be valid. The <a href="#dom-timingstatevector-timestamp" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingstatevector-timestamp-2"><code>timestamp</code></a> is from the timeline of the user agent defined by the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-11">internal clock</a>, represented in seconds.
        </p>
      </div>

      <section id="create-a-new-state-vector"><div class="header-wrapper"><h3 id="x7-1-create-a-new-state-vector"><bdi class="secno">7.1 </bdi>Create a new state vector</h3><a class="self-link" href="#create-a-new-state-vector" aria-label="Permalink for Section 7.1"></a></div>
        
        <p>
          The <code>TimingStateVector</code> constructor is only intended to be used by the <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-22">timing resource provider</a> to set the <a href="#dom-timingprovider-vector" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-vector-3"><code>vector</code></a> attribute of a <a href="#dom-timingprovider" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingprovider-15"><code>TimingProvider</code></a> object.
        </p>
        <p>
          When the <code>TimingStateVector</code> constructor is called, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-24">user agent</a> <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>vector</var> be a newly created <code><a href="#dom-timingstatevector" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingstatevector-7"><code>TimingStateVector</code></a></code>.</li>
          <li>Let (<var>p<sub>init</sub></var>, <var>v<sub>init</sub></var>, <var>a<sub>init</sub></var>, <var>t<sub>init</sub></var>) be the four-tuple represented by the constructor's first argument.</li>
          <li>Initialize <var>vector</var> so that it represents the four-tuple (<var>p<sub>init</sub></var>, <var>v<sub>init</sub></var>, <var>a<sub>init</sub></var>, <var>t<sub>init</sub></var>).</li>
          <li>Return <var>vector</var>.</li>
        </ol>
      </section>
    </section>




    
    <section id="media-elements-and-the-timing-object"><div class="header-wrapper"><h2 id="x8-media-elements-and-the-timing-object"><bdi class="secno">8. </bdi><a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-3">Media elements</a> and the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-69">timing object</a></h2><a class="self-link" href="#media-elements-and-the-timing-object" aria-label="Permalink for Section 8."></a></div>
      
      <p>
        This section specifies an extension of <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-4">media elements</a> that allows them to use a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-70">timing object</a> as a timing source.
      </p>

      <div class="note" role="note" id="issue-container-generatedID-7"><div role="heading" class="note-title marker" id="h-note-6" aria-level="3"><span>Note</span></div><p class="">
        If this specification progresses along the standardisation track, this section should be merged in a future version of [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>].
      </p></div>

      <section class="informative" id="introduction-0"><div class="header-wrapper"><h3 id="x8-1-introduction"><bdi class="secno">8.1 </bdi>Introduction</h3><a class="self-link" href="#introduction-0" aria-label="Permalink for Section 8.1"></a></div><p><em>This section is non-normative.</em></p>
        

        <p>
          The essential function of the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-5">media element</a> is to provide playback of video and audio data. Playback is typically controlled by end-user interaction (e.g. play, pause, seekTo) as well as the availability of data (e.g. live streaming, buffering). In particular, if the buffer underflows during playback, playback is halted until data becomes available. We call this the <dfn id="dfn-default-playback-mode" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">default playback mode</dfn>.
        </p>
        <p> 
          This section specifies <dfn id="dfn-timed-playback-mode" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">timed playback mode</dfn> as an alternative mode of operation for the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-6">media element</a>. <a href="#dfn-timed-playback-mode" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timed-playback-mode-1">Timed playback mode</a> implies that media playback is directed exclusively by an external <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-71">timing object</a>. The goal is to allow presentation of video and audio frames at the correct time (millisecond scale), relative to a timing object. In other words, in <a href="#dfn-timed-playback-mode" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timed-playback-mode-2">timed playback mode</a> the function of the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-7">media element</a> is to time-align its internal media player with a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-72">timing object</a>. This way, <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-8">media elements</a> may take part in precisely coordinated multi-media presentations, both in single-device and multi-device scenarios. In particular, as errors in time-alignment should be well below 10 ms, use-cases such as echo-less Web radio (multiple devices in a room), multi-track music (on multiple devices) or synchronization with musical instruments should be supported.
        </p>
        <p>
          <a href="#dfn-timed-playback-mode" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timed-playback-mode-3">Timed playback mode</a> and <a href="#dfn-default-playback-mode" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-default-playback-mode-1">default playback mode</a> are different in a few important respects:
        </p>
        <p>
          In <a href="#dfn-timed-playback-mode" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timed-playback-mode-4">timed playback mode</a> there is no obligation to present all the media content. If the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-73">timing object</a> starts playback before the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-9">media element</a> is ready, then a small segment of media will simply not be presented. The <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-10">media element</a> must always focus on time-aligning its presentation with the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-74">timing object</a>. This is equally true on load, after <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-75">timing object</a> change events, or in the event of missing data. If correct data is not available at any given point in time, the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-11">media element</a> simply defaults to presenting a black screen, perhaps decorated with graphics illustrating the advancing offset of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-76">timing object</a> as well as the appropriate error message.
        </p>
        <p>
          The <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-12">media element</a> never halts the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-77">timing object</a> in order to wait for data or other internal processing. Instead, end-users may choose to pause the presentation manually, or navigate back to see missing segments. Crucially, media controls (e.g. interactive buttons and progress bar) associated with the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-13">media element</a> must be applied exclusively to the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-78">timing object</a>. (The internal media player of the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-14">media element</a> will be affected indirectly as a response to change events emitted by the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-79">timing object</a>). This way, manually pausing a <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-15">media element</a> for buffering affects not only the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-16">media element</a> but any other media component connected to the same <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-80">timing object</a>.
        </p>
        <p>
          To achieve precisely time-aligned playback, a <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-17">media element</a> must continuously monitor and adjust its internal media player. Even if the internal media player is perfectly time-aligned with the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-81">timing object</a> at one point in time, media players may slowly drift away from the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-82">timing object</a> over time. To counter this, the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-18">media element</a> must monitor their time-alignment periodically, and adjust as the error grows too large. Using variable playback rate internally is an effective way of implementing adjustments gradually and precisely.
        </p>
        <p>
          <a data-lt="media elements" href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-19">Media elements</a> take direction from a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-83">timing object</a>, but playback capabilities are likely limited when it comes to high velocities, backwards playback or acceleration (supported by the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-84">timing object</a>). Still, <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-20">media elements</a> must accept any state that the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-85">timing object</a> supports, so throwing exceptions in these circumstances is not acceptable. Instead, <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-21">media elements</a> are free to fall back to black screen or graphical illustrations whenever the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-86">timing object</a> specifies motions that are not supported by the internal media player.
        </p>

      </section>


      <section id="procedure-set-the-current-timing-object-for-media-element"><div class="header-wrapper"><h3 id="x8-2-procedure-set-the-current-timing-object-for-media-element"><bdi class="secno">8.2 </bdi>Procedure: Set the current <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-87">timing object</a> for <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-22">media element</a>.</h3><a class="self-link" href="#procedure-set-the-current-timing-object-for-media-element" aria-label="Permalink for Section 8.2"></a></div>
        
        <p>
          From the perspective of a <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-23">media element</a>, a <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-15"><code>TimingObject</code></a></code> plays a role similar to a <code><a href="#dfn-mediacontroller" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-mediacontroller-1"><code>MediaController</code></a></code>.
        </p>
        <p>
          A <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-24">media element</a> in <a href="#dfn-timed-playback-mode" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timed-playback-mode-5">timed playback mode</a> has a <dfn id="dfn-current-timing-source" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">current timing source</dfn> which is a <code><a href="#dom-timingobject" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingobject-16"><code>TimingObject</code></a></code>. The <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-88">timing object</a> imposes the media clock that the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-25">media element</a> uses.
        </p>

        <pre class="idl def" id="webidl-563071718"><span class="idlHeader"><a class="self-link" href="#webidl-563071718">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-htmlmediaelement-partial-1" data-title="HTMLMediaElement">partial interface <a data-idl="partial" data-link-type="interface" data-title="HTMLMediaElement" class="idlID" data-dfn-for="HTMLMediaElement" href="https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement">HTMLMediaElement</a> {<span data-idl="" class="idlAttribute" id="idl-def-htmlmediaelement-timingsrc" data-title="timingsrc" data-dfn-for="HTMLMediaElement">
  attribute<span class="idlType"> <a data-link-type="idl" href="#dom-timingobject" class="internalDFN" id="ref-for-dom-timingobject-17"><code>TimingObject</code></a></span> <dfn data-export="" data-dfn-type="attribute" id="dom-htmlmediaelement-timingsrc" data-idl="attribute" data-title="timingsrc" data-dfn-for="HTMLMediaElement" data-type="TimingObject" data-lt="timingsrc" data-local-lt="HTMLMediaElement.timingsrc" class="idlName" tabindex="0" aria-haspopup="dialog"><code>timingsrc</code></dfn>;</span>
};</span></code></pre>

        <p>
          The <code>timingsrc</code> attribute on a <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-26">media element</a> <em class="rfc2119">MUST</em>, on getting, return the <a href="#dfn-current-timing-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-timing-source-1">current timing source</a>, if any, or null otherwise. On setting, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-25">user agent</a> <em class="rfc2119">MUST</em> <a href="#dfn-set-the-current-timing-object-for-the-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-set-the-current-timing-object-for-the-media-element-1">set the current timing object for the media element</a>.
        </p>
     
        <p>
          When the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-26">user agent</a> is to <dfn id="dfn-set-the-current-timing-object-for-the-media-element" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">set the current timing object for the media element</dfn>, it <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>m</var> be the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-27">media element</a> in question.</li>
          <li>Let <var>old controller</var> be <var>m</var>'s <a href="#dfn-current-media-controller" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-media-controller-1">current media controller</a>, it if currently has one, and null otherwise.</li>
          <li>Let <var>m</var> have no <a href="#dfn-current-media-controller" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-media-controller-2">current media controller</a>, if it currently has one.</li>
          <li>Remove the element's <code>mediagroup</code> content attribute, if any.</li>
          <li>Let <var>m</var> have no <a href="#dfn-current-timing-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-timing-source-2">current timing source</a>, it if currently has one.</li>
          <li>If the provided timing object is null, then jump to the <i>update controller</i> step below.</li>
          <li>Let <var>m</var>'s <a href="#dfn-current-timing-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-timing-source-3">current timing source</a> be the providedtiming object.</li>
          <li>Let <var>new timing</var> be <var>m</var>'s <a href="#dfn-current-timing-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-timing-source-4">current timing source</a>.</li>
          <li><a href="#dfn-check-error-in-time-alignment" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-check-error-in-time-alignment-1">check error in time-alignment</a>.</li>
          <li><i>Update controller</i>: If <var>old controller</var> is not null and still has one or more <a href="#dfn-slaved-media-elements" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-slaved-media-elements-1">slaved media elements</a>, then <a href="#dfn-report-the-controller-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-report-the-controller-state-1">report the controller state</a> for <var>old controller</var>.</li>
        </ol>

        <p>
          When a <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-28">media element</a> has a <a href="#dfn-current-timing-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-timing-source-5">current timing source</a>, its <code>currentTime</code> and <code>playbackRate</code> properties reflect the current state of the internal media player, not the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-89">timing object</a>. This implies backwards compatibility for applications that uses the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-29">media element</a> as timing source. Note that if the velocity of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-90">timing object</a> is 1.0, the <a href="#dfn-effective-playback-rate" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-effective-playback-rate-1">effective playback rate</a> of the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-30">media element</a> might be slightly less or slightly larger than 1.0. An internal playback rate of 1.0 generally does NOT imply that playback offset advances with the exact speed of the system clock. In addition, <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-31">media elements</a> may adjust for error in time-alignment gradually by adjusting their internal playback rate every now and then. 
        </p>
      </section>

      <section id="procedure-set-the-current-media-controller-for-media-element"><div class="header-wrapper"><h3 id="x8-3-procedure-set-the-current-media-controller-for-media-element"><bdi class="secno">8.3 </bdi>Procedure: Set the current media controller for <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-32">media element</a></h3><a class="self-link" href="#procedure-set-the-current-media-controller-for-media-element" aria-label="Permalink for Section 8.3"></a></div>
        
        <p>
          The procedures defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-html5" title="HTML5">HTML5</a></cite>] that update the <a href="#dfn-current-media-controller" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-media-controller-3">current media controller</a> should be updated to include the following step before the <a href="#dfn-current-media-controller" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-media-controller-4">current media controller</a> is set:
        </p>
        <ol>
          <li>Let <var>m</var> have no <a href="#dfn-current-timing-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-timing-source-6">current timing source</a>, if it currently has one.</li>
        </ol>
      </section>

      <section id="procedure-set-the-current-position-for-media-element"><div class="header-wrapper"><h3 id="x8-4-procedure-set-the-current-position-for-media-element"><bdi class="secno">8.4 </bdi>Procedure: Set the current position for <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-33">media element</a></h3><a class="self-link" href="#procedure-set-the-current-position-for-media-element" aria-label="Permalink for Section 8.4"></a></div>
        
        <p>
          The procedure defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-html5" title="HTML5">HTML5</a></cite>] that prevents setting <code>currentTime</code> when the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-34">media element</a> has a <a href="#dfn-current-media-controller" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-media-controller-5">current media controller</a> should be updated to also prevent setting the attribute when the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-35">media element</a> has a <a href="#dfn-current-timing-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-timing-source-7">current timing source</a>.
        </p>
        <div class="issue" id="issue-container-generatedID-8"><div role="heading" class="issue-title marker" id="h-issue-3" aria-level="4"><span>Issue</span></div><p class="">
          An alternative to preventing the setting of <code>currentTime</code> would be to map such a request onto the <a href="#dfn-current-timing-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-timing-source-8">current timing source</a>.
          Following this approach, other media control commands such as <code>play</code> and <code>pause</code> could be mapped similarly.
        </p></div>
        <div class="note" role="note" id="issue-container-generatedID-9"><div role="heading" class="note-title marker" id="h-note-7" aria-level="4"><span>Note</span></div><p class="">
          The <code>playbackRate</code> attribute has no effect when the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-36">media element</a> has a <a href="#dfn-current-timing-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-timing-source-9">current timing source</a>.
          Note also that <code>playbackRate</code> attribute does not trivially map to the current definition of a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-91">timing object</a>. This is because <code>playbackRate</code> is effectively a persistent wish for a specific playbackRate, rather than the actual playbackRate at any time. If needed, the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-92">timing object</a> may easily be extended with this functionality by application code.
        </p></div>
      </section>
      
      <section id="procedure-check-error-in-time-alignment-for-media-element"><div class="header-wrapper"><h3 id="x8-5-procedure-check-error-in-time-alignment-for-media-element"><bdi class="secno">8.5 </bdi>Procedure: Check error in time-alignment for <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-37">media element</a></h3><a class="self-link" href="#procedure-check-error-in-time-alignment-for-media-element" aria-label="Permalink for Section 8.5"></a></div>
        
        <p>
          The user agent must <dfn id="dfn-check-error-in-time-alignment" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">check error in time-alignment</dfn> between <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-93">timing object</a> and the internal player of the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-38">media element</a>, and then make steps to adapt if error are too big. Checking the error involves the following steps:
        </p>
        <ol>
          <li>Let <var>m</var> be that <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-39">media element</a>.</li>
          <li>Let <var>timing</var> be that timing source.</li>
          <li>Let <var>max</var> be the maximum error that is tolerated.</li>       
          <li>Let <var>ideal</var> be the result of <code>timing.query().position</code>.</li>
          <li>Let <var>actual</var> be the currentTime of the internal media player.</li>
          <li>Let <var>error</var> be (<var>ideal</var> - <var>actual</var>).</li>
          <li>If (<var>error</var> &gt; <var>max</var>) start adjust time-alignment with given <var>error</var></li>.
        </ol>
      </section>

   
      <section id="procedure-time-align-media-element-with-timing-object"><div class="header-wrapper"><h3 id="x8-6-procedure-time-align-media-element-with-timing-object"><bdi class="secno">8.6 </bdi>Procedure: Time-align <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-40">media element</a> with <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-94">timing object</a></h3><a class="self-link" href="#procedure-time-align-media-element-with-timing-object" aria-label="Permalink for Section 8.6"></a></div>
        
        <p>
          Below is a rough explanation of how time-alignment may be adjusted. Details are left unspecified. However, a reference implementation of time-alignment, MediaSync [<cite><a class="bibref" data-link-type="biblio" href="#bib-mediasync" title="MediaSync">MEDIASYNC</a></cite>], is provided by the Multi-device Timing Community Group. This is a pure JavaScript implementation where time-alignment is implemented using the public API of the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-41">media element</a>. This demonstrates that time-alignment at the millisecond scale is achievable, even without access to the internals of the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-42">media element</a>. The assumption is that time-alignment may be even more precise and effective if supported by <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-43">media elements</a> internally.     
        </p>
        <p>
          If the error in time-alignment is very large (e.g. after a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-95">timing object</a> update event) adjustments may require one or multiple <code>seekTo(X)</code> operations on the internal media player. The expected time-consumption of seekTo() operations should likely be taken into consideration when calculating <code>X</code>. If the internal media player (media format) supports variable playbackRate, this may be an effective way of implementing smaller adjustments gradually and more precisely. In both cases, adjusting the time-alignment is likely a multi-step process that goes on until the <var>error</var> is acceptible or cannot be further reduced.  
        </p>
      </section>
    

    </section>



    

    <section id="timed-data-and-the-timing-object"><div class="header-wrapper"><h2 id="x9-timed-data-and-the-timing-object"><bdi class="secno">9. </bdi>Timed data and the timing object</h2><a class="self-link" href="#timed-data-and-the-timing-object" aria-label="Permalink for Section 9."></a></div>

      

      <p>
        This section specifies how a timing object may be used to direct timed presentation/execution of timed data.
      </p>

      <section class="informative" id="introduction-1"><div class="header-wrapper"><h3 id="x9-1-introduction"><bdi class="secno">9.1 </bdi>Introduction</h3><a class="self-link" href="#introduction-1" aria-label="Permalink for Section 9.1"></a></div><p><em>This section is non-normative.</em></p>
        

        <p>
          In this document, the process of translating a timed script or timed data into timed execution is broadly referred to as <dfn data-lt="sequencer|sequencing" id="dfn-sequencer" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">sequencing</dfn>. <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-1">Sequencing</a> functionality is already provided by existing media frameworks, for example <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-2">text tracks</a> integrated with <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-44">media elements</a>, audio sample scheduling within the Web Audio API [<cite><a class="bibref" data-link-type="biblio" href="#bib-webaudio" title="Web Audio API">WEBAUDIO</a></cite>], or timegraph traversal within SMIL Timing [<cite><a class="bibref" data-link-type="biblio" href="#bib-smil3" title="Synchronized Multimedia Integration Language (SMIL 3.0)">SMIL3</a></cite>]. 
        </p>
        <p>
          Similarly, the ability to connect <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-2">sequencing</a> logic (e.g. a <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-3">text track</a>) to a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-96">timing object</a> would be very useful. It would allow timed data to be time-aligned (synchronized) with any other timed component, provided only that they are directed by the same <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-97">timing object</a>. Crucially, this would also be true in the multi-device scenario, as distributed <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-98">timing objects</a> may connect to and be directed by the same online timing source. Below we list important design goals for a general purpose <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-3">sequencing</a> mechanism for the Web.  
        </p>
        <ul>
          <li><b>Data-independency.</b> The <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-4">sequencing</a> mechanism should be implemented without reference to any specific data format. This way, timing support for a wide range of data formats can be provided, including application-specific data formats.</li>
          <li><b>UI-independency.</b> The <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-5">sequencing</a> mechanism should not be bundled with any predefined UI elements or UI frameworks. This ensures that programmers are free to exploit it for any purpose, including purposes that require custom UI solutions or no UI at all. General purpose UI components for timed presentation may still be developed and shared independently.</li>
          <li><b>Precise timing.</b> The <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-6">sequencing</a> mechanism should be based on a precise timeout mechanism (e.g. setTimeout) for enter/exit events to be emitted with high precision, ideally correct down to a single millisecond.</li>
          <li><b>Expressive controls.</b> The <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-7">sequencing</a> mechanism should support any motion supported by the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-99">timing object</a>, including fast forward, slow motion, backwards playback, immediate jumps or acceleration. This way, the <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-8">sequencing</a> mechanism may support a variety of media control primitives, appropriate for a wide range of media applications.</li>
          <li><b>Dynamic data.</b> The <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-9">sequencing</a> mechanism should allow modifications of timed data to safely occur at any time, with immediate and consistent effects, and without introducing any added complexity for the programmer. This would enable both live authoring and live viewing of dynamic timed media, applicable in both single-device and collaborative, multi-device scenarios.</li> 
          <li><b>Simple usage</b></li>
        </ul>
     
        <p>
          In short, the <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-10">sequencing</a> mechanism should be made available as a generic programming concept/tool. This would presumably benefit both individual programmers as well as developers of advanced media frameworks. This specification extends the concept of <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-4">text track</a> to achieve this result so that application developers that already use <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-5">text tracks</a> driven by <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-45">media elements</a> may easily start using <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-1">timing text tracks</a> driven by a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-100">timing object</a>.
        </p>

        <div class="note" role="note" id="issue-container-generatedID-10"><div role="heading" class="note-title marker" id="h-note-8" aria-level="4"><span>Note</span></div><p class="">
          An open-source JavaScript implementation of a <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-11">sequencing</a> mechanism is available [<cite><a class="bibref" data-link-type="biblio" href="#bib-sequencer" title="Open-source sequencer library">SEQUENCER</a></cite>] to allow developers to quickly start exploring the benefits of <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-12">sequencing</a> driven by a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-101">timing object</a>. Please note that interfaces used in that implementation are not entirely aligned with those defined in this specification.
        </p></div>
      </section>

      <section id="timing-text-track"><div class="header-wrapper"><h3 id="x9-2-timing-text-track"><bdi class="secno">9.2 </bdi>Timing text track</h3><a class="self-link" href="#timing-text-track" aria-label="Permalink for Section 9.2"></a></div>
        
    
        <p>
          A <dfn data-lt="timing text tracks|timing text track" id="dfn-timing-text-tracks" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">timing text track</dfn> is a <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-6">text track</a> that is directed by a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-102">timing object</a>. The <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-2">timing text track</a> includes <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-13">sequencing</a> logic for the set of <a href="#dfn-text-track-cue" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-track-cue-1">text track cues</a> that composes the <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-7">text track</a>. As such, a <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-3">timing text track</a> has a <dfn id="dfn-current-sequencer" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">current sequencer</dfn> which is the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-103">timing object</a>.
        </p>
    
        <pre class="idl def" id="webidl-1681600935"><span class="idlHeader"><a class="self-link" href="#webidl-1681600935">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-timingtexttrack" data-title="TimingTextTrack">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
interface <dfn data-export="" data-dfn-type="interface" id="dom-timingtexttrack" data-idl="interface" data-title="TimingTextTrack" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>TimingTextTrack</code></dfn> : <span class="idlSuperclass"><a data-link-type="interface" href="https://html.spec.whatwg.org/multipage/media.html#texttrack">TextTrack</a></span> {<span data-idl="" class="idlConstructor" id="idl-def-timingtexttrack-constructor-kind-label-language" data-title="constructor" data-dfn-for="TimingTextTrack">
  <dfn data-export="" data-dfn-type="constructor" id="dom-timingtexttrack-constructor" data-idl="constructor" data-title="constructor" data-dfn-for="TimingTextTrack" data-lt="constructor()|constructor(kind)|constructor(kind, label)|constructor(kind, label, language)" data-local-lt="TimingTextTrack.constructor|TimingTextTrack.constructor()|constructor" tabindex="0" aria-haspopup="dialog"><code>constructor</code></dfn>(<span class="idlType"><a data-link-type="enum" href="https://html.spec.whatwg.org/multipage/media.html#texttrackkind">TextTrackKind</a></span> <span class="idlParamName">kind</span>, optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">label</span> = "", optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">language</span> = "");</span><span data-idl="" class="idlAttribute" id="idl-def-timingtexttrack-timingsrc" data-title="timingsrc" data-dfn-for="TimingTextTrack">
  attribute<span class="idlType"> <a data-link-type="idl" href="#dom-timingobject" class="internalDFN" id="ref-for-dom-timingobject-18"><code>TimingObject</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingtexttrack-timingsrc" id="ref-for-dom-timingtexttrack-timingsrc-1"><code>timingsrc</code></a>;</span>
};</span></code></pre>

        <p>
          The <dfn data-dfn-for="TimingTextTrack" data-export="" data-dfn-type="attribute" id="dom-timingtexttrack-timingsrc" data-idl="attribute" data-title="timingsrc" data-type="TimingObject" data-lt="timingsrc" data-local-lt="TimingTextTrack.timingsrc" tabindex="0" aria-haspopup="dialog"><code>timingsrc</code></dfn> attribute <em class="rfc2119">MUST</em>, on getting, return the <a href="#dfn-current-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-sequencer-1">current sequencer</a> of the <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-4">timing text track</a>, if any, or null otherwise. On setting, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-27">user agent</a> <em class="rfc2119">MUST</em> <a href="#dfn-associate-the-track-with-a-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-associate-the-track-with-a-timing-object-1">associate the track with a timing object</a>.
        </p>

        <div class="note" role="note" id="issue-container-generatedID-11"><div role="heading" class="note-title marker" id="h-note-9" aria-level="4"><span>Note</span></div><p class="">
          As opposed to a <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-8">text track</a>, a <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-5">timing text track</a> is not and cannot be associated with a <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-46">media element</a>.
        </p></div>
        <div class="issue" id="issue-container-generatedID-12"><div role="heading" class="issue-title marker" id="h-issue-4" aria-level="4"><span>Issue</span></div><p class="">
          Is inheriting from <a data-link-type="interface" data-lt="TextTrack" href="https://html.spec.whatwg.org/multipage/media.html#texttrack"><code>TextTrack</code></a> as proposed above the right approach? An alternative approach would be to extend <a data-link-type="interface" data-lt="TextTrack" href="https://html.spec.whatwg.org/multipage/media.html#texttrack"><code>TextTrack</code></a> as done for the <a data-link-type="interface" data-lt="HTMLMediaElement" href="https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement"><code>HTMLMediaElement</code></a>. The problem with this appraoch is that <a data-link-type="interface" data-lt="TextTrack" href="https://html.spec.whatwg.org/multipage/media.html#texttrack"><code>TextTrack</code></a> does not expose a constructor, so the only way to create a <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-6">timing text track</a> would be to add an <code>addTextTrack</code> method to the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-104">timing object</a> (similar to the one on <a data-link-type="interface" data-lt="HTMLMediaElement" href="https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement"><code>HTMLMediaElement</code></a>). However, this is undesireable, as we would like to maintain a clean separation between <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-105">timing object</a> and objects that take direction from it. For instance, a clear separation ensures the flexibility to dynamically switch <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-106">timing object</a> for the <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-7">timing text track</a>. 
        </p></div>
        <div class="issue" id="issue-container-generatedID-13"><div role="heading" class="issue-title marker" id="h-issue-5" aria-level="4"><span>Issue</span></div><p class="">
          Note also that the <a data-link-type="interface" data-lt="TextTrack" href="https://html.spec.whatwg.org/multipage/media.html#texttrack"><code>TextTrack</code></a> design bear witness of close integration with <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-47">media elements</a>. For example, as the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-48">media element</a> must provide UI support for <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-9">text track</a> visualization, it requires meta information such as track type (kind) and language. However, this meta information may quickly become irrelevant in a context where programmers are making custom timed presentations from application-specific data formats. Furthermore, as the programming of timed presentation is made very easy and flexible using the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-107">timing object</a> combined with a general purpose <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-14">sequencing</a> mechanism, programmers will be much less dependent on the limited UI support for subtitles and captions, that is currently provided by <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-49">media elements</a>. In this perspective it seems odd to insist that all <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-8">timing text tracks</a> must be of a specific kind and declare a language. 
        </p></div>
        <div class="issue" id="issue-container-generatedID-14"><div role="heading" class="issue-title marker" id="h-issue-6" aria-level="4"><span>Issue</span></div><p class="">
          A <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-50">media element</a> acts as <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-15">sequencer</a> for a list of <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-10">text tracks</a>. It is not clear that <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-9">timing text tracks</a> similarly need to be managed within a container. If such a container object is deemed necessary (e.g. for consistency with existing standards), such a container object must be defined in this document, say a <strong>Timing Track</strong>. The <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-16">sequencing</a> logic (<a href="#dfn-track-marches-on" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-track-marches-on-1">track marches on</a>) would then be provided by that container object rather than by <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-10">timing text tracks</a> individually.
        </p></div>
        <div class="issue" id="issue-container-generatedID-15"><div role="heading" class="issue-title marker" id="h-issue-7" aria-level="4"><span>Issue</span></div><p class="">
          There is a tradeoff with respect to how much we want <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-11">timing text tracks</a> to divert from regular <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-11">text tracks</a>. Keeping it true to its origins may be awkward in some respects. Taking it too far away may be confusing, possibly suggesting that a clean sheets approach with a new sequencer object might be preferable. Note also that programmers may use regular <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-12">text tracks</a> with a <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-51">media element</a>, a then let the <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-52">media element</a> be directed by a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-108">timing object</a>.
        </p></div>
      </section>


      <section id="procedure-create-a-new-timing-text-track"><div class="header-wrapper"><h3 id="x9-3-procedure-create-a-new-timing-text-track"><bdi class="secno">9.3 </bdi>Procedure: Create a new <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-12">timing text track</a></h3><a class="self-link" href="#procedure-create-a-new-timing-text-track" aria-label="Permalink for Section 9.3"></a></div>
        
        <p>
          When the <code><a href="#dom-timingtexttrack" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingtexttrack-1"><code>TimingTextTrack</code></a></code> constructor is invoked, the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-28">user agent</a> <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Create a new <code><a href="#dom-timingtexttrack" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingtexttrack-2"><code>TimingTextTrack</code></a></code> object.</li>
          <li>Create a new <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-13">timing text track</a> corresponding to the new object, and sets its <a href="#dfn-text-track-kind" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-track-kind-1">text track kind</a> to <var>kind</var>, its <a href="#dfn-text-track-label" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-track-label-1">text track label</a> to <var>label</var>, its <var>text track language</var> to language, its <a href="#dfn-text-track-readiness-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-track-readiness-state-1">text track readiness state</a> to the <a href="#dfn-text-track-loaded" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-track-loaded-1">text track loaded</a> state, its <a href="#dfn-text-track-mode" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-track-mode-1">text track mode</a> to the <a href="#dfn-text-track-hidden" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-track-hidden-1">text track hidden</a> mode, and its <a href="#dfn-text-track-list-of-cues" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-track-list-of-cues-1">text track list of cues</a> to an empty list.</li>
          <li>Return the new <code><a href="#dom-timingtexttrack" class="internalDFN" data-link-type="idl" id="ref-for-dom-timingtexttrack-3"><code>TimingTextTrack</code></a></code> object.</li>
        </ol>
      </section>

      <section id="procedure-associate-timing-text-track-with-a-timing-object"><div class="header-wrapper"><h3 id="x9-4-procedure-associate-timing-text-track-with-a-timing-object"><bdi class="secno">9.4 </bdi>Procedure: Associate <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-14">timing text track</a> with a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-109">timing object</a></h3><a class="self-link" href="#procedure-associate-timing-text-track-with-a-timing-object" aria-label="Permalink for Section 9.4"></a></div>
        
        <p>
          When the <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-29">user agent</a> is required to <dfn id="dfn-associate-the-track-with-a-timing-object" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">associate the track with a timing object</dfn>, it <em class="rfc2119">MUST</em> run the following steps:
        </p>
        <ol>
          <li>Let <var>track</var> be the <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-15">timing text track</a> in question.</li>
          <li>Let <var>track</var>'s <a href="#dfn-current-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-sequencer-2">current sequencer</a> be the new value.</li>
          <li>Run the <a href="#dfn-track-marches-on" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-track-marches-on-2">track marches on</a> algorithm of <var>track</var>.</li>
        </ol>

        <div class="example" id="example-timed-visualization-of-subtitles">
        <div class="marker">
    <a class="self-link" href="#example-timed-visualization-of-subtitles">Example<bdi> 9</bdi></a><span class="example-title">: Timed visualization of subtitles</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript"><span class="hljs-keyword">var</span> elem; <span class="hljs-comment">// DOM element that renders subtitles</span>
<span class="hljs-keyword">var</span> subtitles = [ <span class="hljs-comment">// Timed data</span>
  {<span class="hljs-attr">text</span>: <span class="hljs-string">"Zed's dead baby"</span>, <span class="hljs-attr">start</span>: <span class="hljs-number">12.2</span>, <span class="hljs-attr">end</span>: <span class="hljs-number">17.4</span>},
  {<span class="hljs-attr">text</span>: <span class="hljs-string">"Zed's dead"</span>, <span class="hljs-attr">start</span>: <span class="hljs-number">19.7</span>, <span class="hljs-attr">end</span>: <span class="hljs-number">22.5</span>}
];
<span class="hljs-keyword">var</span> track = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingTextTrack</span>(<span class="hljs-string">"metadata"</span>);
subtitles.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">subtitle</span>) {
  <span class="hljs-keyword">var</span> cue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataCue</span>(subtitle.<span class="hljs-property">start</span>, subtitle.<span class="hljs-property">end</span>, subtitle.<span class="hljs-property">text</span>));
  track.<span class="hljs-title function_">addCue</span>(cue);
});
<span class="hljs-keyword">var</span> timing = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimingObject</span>(); 
track.<span class="hljs-property">timingsrc</span> = timing; <span class="hljs-comment">// Associate timed data with timing object</span>

<span class="hljs-comment">// React to cue changes (assuming only one active subtitle)</span>
track.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"cuechange"</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
  <span class="hljs-keyword">var</span> cue = (track.<span class="hljs-property">activeCues</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) ? track.<span class="hljs-property">activeCues</span>[<span class="hljs-number">0</span>] : <span class="hljs-literal">null</span>;
  elem.<span class="hljs-property">innerHTML</span> = cue ? cue.<span class="hljs-property">data</span> : <span class="hljs-string">""</span>;
});
timing.<span class="hljs-title function_">update</span>({ <span class="hljs-attr">velocity</span>: <span class="hljs-number">1.0</span> }); <span class="hljs-comment">// Start playback</span></code></pre>
      </div>
      </section>

      <section id="procedure-track-marches-on"><div class="header-wrapper"><h3 id="x9-5-procedure-track-marches-on"><bdi class="secno">9.5 </bdi>Procedure: Track marches on</h3><a class="self-link" href="#procedure-track-marches-on" aria-label="Permalink for Section 9.5"></a></div>
        
        <p>The <dfn id="dfn-track-marches-on" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">track marches on</dfn> procedure evaluates the state of the <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-16">timing text track</a> at a specific point in time. The procedure may cause events to be emitted, and it may also cause a timeout to be created for the next execution of the procedure. The user agent must run this procedure whenever:
        </p>
        <ul>
         <li>the <a href="#dfn-current-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-sequencer-3">current sequencer</a> is set.</li>
         <li>the <a href="#dfn-current-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-sequencer-4">current sequencer</a> emits a change event.</li>
         <li>a <a href="#dfn-text-track-cue" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-track-cue-2">text track cue</a> is added, modified or removed to the <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-17">timing text track</a>.</li>
         <li>an internal timeout signals that the procedure must be executed.</li>
        </ul>
        <p> 
          The specification does not detail the exact implementation of this procedure, except to note that the <a href="#dfn-track-marches-on" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-track-marches-on-3">track marches on</a> steps for the <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-18">timing text track</a> are essentially the same steps as the <a href="#dfn-time-marches-on" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-time-marches-on-1">time marches on</a> steps for a <a href="#dfn-media-element" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-media-element-53">media element</a>, replacing the <a href="#dfn-current-playback-position" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-current-playback-position-1">current playback position</a> by the <code>position</code> property of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-110">timing object</a> as returned by a call to <code>query().position</code> at the time of evaluation, and noting that <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-19">timing text tracks</a> do not have rules for updating the <a href="#dfn-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-text-tracks-13">text track</a> rendering, since the <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-20">timing text track</a> is UI-independent. Alternatively, the implementation of the <a href="#dfn-timing-text-tracks" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-text-tracks-21">timing text track</a> may be based on the <a href="#dfn-sequencer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-sequencer-17">sequencer</a> reference implementation. 
        </p>
      </section>

    </section>






    <section class="informative appendix" id="implementation-guidelines-multi-device-synchronization"><div class="header-wrapper"><h2 id="a-implementation-guidelines-multi-device-synchronization"><bdi class="secno">A. </bdi>Implementation guidelines multi-device synchronization</h2><a class="self-link" href="#implementation-guidelines-multi-device-synchronization" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
        Distributed synchronization is a main use case that a <a href="#dfn-user-agent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-user-agent-30">user agent</a> or a <a href="#dfn-timing-resource-provider" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-provider-23">timing resource provider</a> may enable. <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-111">Timing objects</a> running on different devices will be synchronized if they are associated with the same online <a href="#dfn-timing-resource" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-resource-15">timing resource</a>. To achieve precise and reliable synchronization across the Internet, the implementation needs to address two distinct issues: the synchronization of <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-22">state vectors</a> and the synchronization of clocks. A brief introduction to a specific solution is given below. Details are available in [<cite><a class="bibref" data-link-type="biblio" href="#bib-msv" title="The Media State Vector: A unifying concept for multi-device media navigation">MSV</a></cite>].
      </p>
      <div class="note" role="note" id="issue-container-generatedID-16"><div role="heading" class="note-title marker" id="h-note-10" aria-level="3"><span>Note</span></div><p class="">
        The guideline discusses communication between an <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-3">online timing resource</a> and a <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-112">timing object</a>. In reality though, these two entities do not communicate directly, but indirectly through a mediating <a href="#timing-provider-object">timing provider object</a> running on the user agent. In the perspective of the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-113">timing object</a> the <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-19">timing provider object</a> is a proxy object for the <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-4">online timing resource</a>.
      </p></div>

      <section id="state-vector-synchronization"><div class="header-wrapper"><h3 id="a-1-state-vector-synchronization"><bdi class="secno">A.1 </bdi>State vector synchronization</h3><a class="self-link" href="#state-vector-synchronization" aria-label="Permalink for Appendix A.1"></a></div>
        
        <p>
          If an <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-5">online timing resource</a> is updated, effects must apply equally to all connected <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-114">timing objects</a> as quickly as possible, including the <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-115">timing object</a> on which the update request might have been issued. This has implications for the processing of update requests. Local timing objects should simply forward the request, i.e. a new <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-23">state vector</a>), across the network to the <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-6">online timing resource</a>, where the request will be processed. Effects (i.e. the resulting <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-24">state vector</a>) will be multicast by the <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-7">online timing resource</a> to all connected <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-116">timing objects</a>, finally triggering a <code>change</code> event on these objects. Queries are always resolved locally, using the last <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-25">state vector</a> received from the <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-8">online timing resource</a>.
        </p>
        <p>
          Note that this strategy does not guarantee that <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-117">timing objects</a> emit <code>change</code> events exactly at the same time. It is possible to achieve this by adding additional delay (thereby masking the differences in network latency). This would be a trade-off against the responsiveness of the user experience.
        </p>
      </section>

      <section id="clock-synchronization"><div class="header-wrapper"><h3 id="a-2-clock-synchronization"><bdi class="secno">A.2 </bdi>Clock synchronization</h3><a class="self-link" href="#clock-synchronization" aria-label="Permalink for Appendix A.2"></a></div>
        
        <p>
          Ideally, if multiple <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-118">timing objects</a> (e.g. on different devices) connected to the same <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-9">online timing resource</a> are queried at the exact same moment, they should ideally return the same <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-26">state vector</a> (same position, velocity and acceleration). This requires that <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-27">state vectors</a> are synchronized, and that the clock skew between <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-10">online timing resource</a> is zero (synchronized clocks) or known (so that it can be compensated).
        </p>
        <p>
          As synchronized system clocks is not a valid assumption in the Web environment, it follows that clock skew estimation must be resolved as part of the communication between <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-119">timing objects</a> and the <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-11">online timing resource</a>. To do this, <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-120">timing objects</a> (or <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-20">timing provider objects</a>) should maintain a software clock that is continuously synchronized with the clock used by the <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-12">online timing resource</a>. This may be achieved through periodic exchange with the <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-13">online timing resource</a> to evaluate the clock skew, taking into account the round-trip time (RTT) of these exchanges to improve the measurements. Using this evaluation, <a href="#dfn-timing-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-object-121">timing objects</a> can tranform <a href="#dfn-state-vector" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-vector-28">state vectors</a> into the timeframe of their own local clock, i.e. the <a href="#dfn-internal-clock" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-internal-clock-12">internal clock</a>.
        </p>
        <p>
          Clock synchronization can be very fast. Stable estimates may be reached within fractions of a second. Implementations may for instance use an open Web sockets [<cite><a class="bibref" data-link-type="biblio" href="#bib-websockets" title="WebSockets Standard">WEBSOCKETS</a></cite>] connection to minimize the latency between <a href="#dfn-timing-provider-object" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-timing-provider-object-21">timing provider objects</a> and the <a href="#dfn-online-timing-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-online-timing-resources-14">online timing resource</a>. If implemented correctly on both ends, this approach provides a basis to achieve &lt; 10ms media synchronization across the Internet.
        </p>
      </section>
    </section>










    


    <section class="informative appendix" id="use-cases-and-requirements"><div class="header-wrapper"><h2 id="b-use-cases-and-requirements"><bdi class="secno">B. </bdi>Use cases and requirements</h2><a class="self-link" href="#use-cases-and-requirements" aria-label="Permalink for Appendix B."></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        Precise timing has wide applicability in both single-device and multi-device applications. Here we identify some common use cases.
      </p>


      <section id="social-viewing-and-media-control"><div class="header-wrapper"><h3 id="b-1-social-viewing-and-media-control"><bdi class="secno">B.1 </bdi> Social Viewing and Media Control</h3><a class="self-link" href="#social-viewing-and-media-control" aria-label="Permalink for Appendix B.1"></a></div>
      
      <p>
        Allow people to enjoy the same content at the same time. Alice and Bob would like to watch the next episode together, even if Alice is on a train and Bob stays at home. If Alice pauses the video while briefly speaking with the conductor, Bob's video pauses too. Alice and Bob may always trust the other to see the exact same thing, making it very easy for them to maintain a conversation, for instance by using a chat service or the phone. It would also be possible for Alice and Bob to split temporarily. Alice would see Bob moving along the progress line without her, and Bob would see Alice staying behind. When Alice is ready to resume viewing a bit later, she may continue on her own, play doublespeed or skip to catch up with Bob, or convice Bob to wait for her or jump back to see the segment again with her.      
      </p>
      <p>
        This use case is based on <a href="https://www.w3.org/2011/webtv/wiki/New_Ideas">UC2-3 Identical Media Stream Synchronization</a>, a use case defined by the <a href="https://www.w3.org/2011/webtv/">W3C Web and TV Interest Group</a>
      </p>
      <p>
        This use case requires the management and sharing of multiple timing objects, at least one for Alice and one for Bob. Precision requirements for video synchronization are quite coarse as the use case is described. However, Alice and Bob might also choose to use this application in circumstances where they are sitting next to eachother, or they might hook their devices on to projectors in order to show a movie to a larger audience. Sub-framerate precision is required in order to avoid echo from device speakers. 
      </p>
      </section>

      <section id="broadcasting-time-consistent-live-web-productions"><div class="header-wrapper"><h3 id="b-2-broadcasting-time-consistent-live-web-productions"><bdi class="secno">B.2 </bdi> Broadcasting - Time-consistent, Live Web Productions </h3><a class="self-link" href="#broadcasting-time-consistent-live-web-productions" aria-label="Permalink for Appendix B.2"></a></div>
      
      <p>
        The BBC provides live coverage of popular sport events such as the FIFA World Cup. Modern Web presentations of this kind tend to include many independent media streams. For example, there might be multiple video streams for different camera angles, visualizations of players on the field, player statistics, and there might be commentary from studio as well as viewers. Earlier, Bob was annoyed that user comments could sometimes ruin the experience by shouting "GOAL!" 20 seconds before the goal appeared in the video stream. However, after BBC started timeshifting live Web content to match distribution latency in their video backend, this problem seems to be a thing of the past.
      </p>
      <p>
        This requires figuring out the estimated latency of the slowest distribution mechanism, and then to define a timing resource from which all parts of a presentation takes direction. In effect, early spoilers will be delayed (buffered) by the Web browsers and applied to UI components at the correct moment in time.
      </p>
      </section>

      <section id="broadcasting-time-shifted-live-web-productions"><div class="header-wrapper"><h3 id="b-3-broadcasting-time-shifted-live-web-productions"><bdi class="secno">B.3 </bdi> Broadcasting - Time-shifted, Live Web productions </h3><a class="self-link" href="#broadcasting-time-shifted-live-web-productions" aria-label="Permalink for Appendix B.3"></a></div>
      
      <p>
        A commercial media provider offers live Web content supplementing live broadcast of F1 races. Sometimes, as F1 races are held in different time zones, the provider will re-broadcast nightly races in the morning. As a keen F1 enthusiast, Alice is discontent that the Web content can not be time-shifted along with the re-broadcast of the race. So is Bob, the media provider's head of marketing, as he would like to sell time sensitive, Web-based ads for F1 races, and have the ads be presented correctly for both live and time-shifted broadcasts, as well as later on demand viewers.
      </p>
      <p>
        This requires timestamping of live Web production so that is may be time-shifted correctly and aligned with a time-shifted broadcast.
      </p>
      </section>

      <section id="broadcasting-timed-web-based-secondary-device"><div class="header-wrapper"><h3 id="b-4-broadcasting-timed-web-based-secondary-device"><bdi class="secno">B.4 </bdi> Broadcasting - Timed, Web-based Secondary Device </h3><a class="self-link" href="#broadcasting-timed-web-based-secondary-device" aria-label="Permalink for Appendix B.4"></a></div>
      
      <p>
        Alice opens the BBC Sport Web page on her iPad during the olympic games. The backend service consults Alice's profile and learns that she is already watching figure skating from the iPlayer on her laptop computer. As a result, the BBC Sports Web page is personalized with an offer to load BBC's Web-based extra material for figure skating. Alice accepts, and the iPad goes on to present stats, images, infographics, commentary and alternative camera angles, all precisely timed with the iPlayer. Alice notices that other viewers have already highlighted a Chinese athlete performing a bit earlier. She clicks to see it, and both the iPlayer (on the laptop) and the timed Web presentation (on the iPad) immediately skip back. After having seen the athlete's performance, now with added commentary provided by excited viewers, Alice contributes by giving it a thumbs up, and then clicks the back-to-live button. Both the laptop and the iPad snap back to presenting the live action.
      </p>
      <p>
        This use case is based on <a href="https://www.w3.org/2011/webtv/wiki/New_Ideas">UC2-4 Related Media Stream Synchronization</a>, a use case defined by the <a href="https://www.w3.org/2011/webtv/">W3C Web and TV Interest Group</a>
      </p>
      <p>
        This use case requires managing personal timing resources for individual viewers, as well as a common timing resource representing the live clock. Both iPlayer and Web-based secondary device offerings must take direction from online timing resources, and allow dynamic switching of timing objects based on user input. Presenting alternative camera angles as part of secondary device offerings requires precise synchronization.   
      </p>
      </section>


      <section id="online-education-timed-multi-device-web-presentations"><div class="header-wrapper"><h3 id="b-5-online-education-timed-multi-device-web-presentations"><bdi class="secno">B.5 </bdi> Online Education - Timed, Multi-device Web Presentations </h3><a class="self-link" href="#online-education-timed-multi-device-web-presentations" aria-label="Permalink for Appendix B.5"></a></div>
      
      <p>
        Alice teaches an online course for international students from across the globe. Every week she goes through a new Web-based slide set. Just before the session, she makes two links available for her students on the class Web page, links for the primary and the secondary view of the presentation. When the time is there she connects on an audio link and requests the first slide to be presented. Slides are presented on her view and on all the views of her connected students, at exactly the same time. This way, Alice can be sure that what she says on the audio link is always backed up with the correct illustrations. In effect, Alice remotely controls the Web browsers of all her students. Alice also has included a video in one of the slides. She plays the video for all the students on the primary view, while presenting some related bullet points on the secondary view. Alice pauses the video at a certain point in order to highlight an important aspect. Beforehand she has prepared some bookmarks in the video, allowing her to effectively skip to the interesting parts. At some point one of the students has a question related to the movie. Alice temporarily gives the student access to control the video, and the student rewinds it to explain the origin of his question. Afterwards, Alice withdraws the controls from the student and continues. The entire event is recorded and timestamped, allowing students that missed the class to replay the audio with and the slide presentation precisely as it was given. This review also provides synchronized presentations of timed comments provided by students as well as text-based search capabilities allowing efficient navigation within the presentation.         
      </p>
      <p>
        Multi-device slide show navigation requires a single shared timing resource, where position represents slide number. Videos require additional timing resources. Finally, timestamping of audio, slide navigation, video navigation, students commentary etc., require an addition timing resource as shared clock. Later individual replay might also require new timing resources.  
      </p>
      </section>


      <section id="multi-screen-data-visualization"><div class="header-wrapper"><h3 id="b-6-multi-screen-data-visualization"><bdi class="secno">B.6 </bdi> Multi-Screen Data Visualization </h3><a class="self-link" href="#multi-screen-data-visualization" aria-label="Permalink for Appendix B.6"></a></div>
      
      <p>
        Bob is heading a research project responsible for collecting and presenting a variety of data series related to climate changes in the Arctic. A Web-based approach to visualization makes for a very dynamic and extensible visualization system. Multiple screens may be used to present and align very different timed visualizations, making it easier to detect temporal patterns and possible correlations. The different visualizations may be navigated in unison. For instance, Bob may slow down the presentation speed for the heavy melting days to co-present this with measurements of salinity levels in the ocean water. Bob may also search his data to find the day with the highest temperature. By clicking on the result, all screens immediately display the relevant data for that day. Alice is recognized as an international expert in this area. Bob shares the link with Alice in an email, they may co-view the presentation even though they are stationed in different continents, and Alice may explore the visualization herself before giving her opinion of Bob's finding. 
      </p>
      <p>
        A shared timing resource is required to support playback of timed data streams on multiple screens. The utility is not limited to Web-based visualization. For instance, native visualization frameworks (e.g. 3D) may also interact with multi-device timing resources, thus enabling very different visualization systems to cooperate in presenting a common data model. 
      </p>
      </section>



      <section id="seamless-workflows"><div class="header-wrapper"><h3 id="b-7-seamless-workflows"><bdi class="secno">B.7 </bdi> Seamless Workflows </h3><a class="self-link" href="#seamless-workflows" aria-label="Permalink for Appendix B.7"></a></div>
      
      <p>
        Bob is watching a Netflix show using Chromecast on the TV when Alice interrupts and demands access to the living room big screen for herself and her friends. Bob reluctantly agrees to finish the show in his bedroom. Though, before he gets up he opens Netflix on his iPad. Netflix, well aware that Bob is already actively watching something, defaults to presenting the exact same thing, in perfect synchrony with the TV. Ensured that the transition was smooth, Bob leaves for his bedroom while staring at his iPad.
      </p>
      <p>
        The use case requires online timing resources and content resources to be tied to login information. So, when an already logged in user enters a VoD service with a second device, the default action could be to resolve which show is already playing and what timing resource is being used, and then to set up the new view with the exact same resources. 
      </p>
      </section>


      <section id="alternative-soundtracks"><div class="header-wrapper"><h3 id="b-8-alternative-soundtracks"><bdi class="secno">B.8 </bdi> Alternative Soundtracks </h3><a class="self-link" href="#alternative-soundtracks" aria-label="Permalink for Appendix B.8"></a></div>
      
      <p>
        Alice's Portuguese mother has a hearing deficiency, so as the two of them sit down to watch a movie together, Alice hooks her smart phone up with the Portuguese audio track and lets her mother adjust the sound volume. Any issues with lip-sync should be due to the dubbing, not the audio synchronization.
      </p>
      <p>
        This use case is based on <a href="https://www.w3.org/2011/webtv/wiki/New_Ideas">UC2-6 Clean Audio</a>, a use case defined by the <a href="https://www.w3.org/2011/webtv/">W3C Web and TV Interest Group</a>
      </p>
      <p>
        This requires lip-synch precision between video and audio. 
      </p>
      </section>


      <section id="timing-interoperability-between-independent-providers"><div class="header-wrapper"><h3 id="b-9-timing-interoperability-between-independent-providers"><bdi class="secno">B.9 </bdi> Timing Interoperability between Independent Providers </h3><a class="self-link" href="#timing-interoperability-between-independent-providers" aria-label="Permalink for Appendix B.9"></a></div>
      
      <p>
        Bob watches soccer. Unfortunately, the clueless commentator is constantly pissing him off as he clearly favours the other team. Bob turns to a dedicated Web radio channel for an alternative commentary. The new commentator is better, but he is out of sync. Bob chooses the <i>SyncWith</i> option in the radio channel Web page and selects his TV provider. After confirming his credentials, the radio channel Web page is able to connect to the same timing resource used by the TV provider, and the Web radio is immediately in sync with his TV.
      </p>
      <p>
        This use case requires media providers to give access to timing resources associated with a given user, also when that user is requesting access from an external service. Synchronization of audio and video requires lip-synch precision.
      </p>
      </section>
 

      <section id="linear-content-adaptation"><div class="header-wrapper"><h3 id="b-10-linear-content-adaptation"><bdi class="secno">B.10 </bdi> Linear Content Adaptation </h3><a class="self-link" href="#linear-content-adaptation" aria-label="Permalink for Appendix B.10"></a></div>
      
      <p>
        Bob is watching cricket, but he and Alice soon need to get in the car to start the long drive to visit Bob's parents. He would like to keep following the cricket game on his smart phone, but does not have the bandwidth nor the money to enjoy HD content. Instead, Bob selects the timed HTML option. The audio goes on undisturbed, but the HD video is immediately terminated and replaced with a light-weight, timed animation of the cricket field. Alice is behind the wheels, and Bob may continue to enjoy the cricket match through audio and full support from all the HTML-based extra information. 
      </p>
      <p>
        Shared timing resources allow smooth and dynamic switching from HD to timed-based HTML.   
      </p>
      </section>

      <section id="distributed-capture-and-replayability"><div class="header-wrapper"><h3 id="b-11-distributed-capture-and-replayability"><bdi class="secno">B.11 </bdi> Distributed Capture and Replayability </h3><a class="self-link" href="#distributed-capture-and-replayability" aria-label="Permalink for Appendix B.11"></a></div>
      
      <p>
        Web browsers are increasingly useful for capturing user generated data. The trivial example is basic interaction, where users manually post comments or upload media. More interestingly, browser integration with peripheral devices such as Web-cameras and microphones allow Web browsers to become input devices for live, distributed media productions. Also, mobil devices come with a range of built-in sensors. All this imput data may become even more valuable if it is timestamped according to the same clock. The timing objects, with support for multi-device synchronization enables precise timestamping of media capture for distributed phenomena. Furthermore, the same data may be replayed time-shifted in multi-screen presentations using the timing object as playback director.
      </p>
      <p>
        Shared timing resources enables timed capture and preservation of timing relations in the distributed scenario.
      </p>
      </section>

      <section id="distributed-music-production-and-playback"><div class="header-wrapper"><h3 id="b-12-distributed-music-production-and-playback"><bdi class="secno">B.12 </bdi> Distributed Music Production and Playback  </h3><a class="self-link" href="#distributed-music-production-and-playback" aria-label="Permalink for Appendix B.12"></a></div>
      
      <p>
        Musical productions are naturally distributed when multiple instruments play together. In the domain of music orchestration, the MIDI protocol has been uses as a carrier of tempo and rythm among electronic instruments. However, as MIDI signals are broadcast over physical (and wireless) links, higher latency reduces the synchronization. For this reason, the use of MIDI orchestration is typically limited to in-house setups. In contrast, the timing object with support for online synchronization supports millisecond precision globally, opening up for innovative distributed musical experiences. It also allows the involvement of visual components and devices that are not instruments. Support for MIDI instruments can still be achieved by synchronization of MIDI controllers using the timing object.   
      </p>
      <p>
        Shared timing resources closes the gap between the world of musical orchestration and multi-device orchestration in the Web.
      </p>
      </section>

      <section id="ad-insertion-and-time-sensitive-ads"><div class="header-wrapper"><h3 id="b-13-ad-insertion-and-time-sensitive-ads"><bdi class="secno">B.13 </bdi> Ad-insertion and Time-sensitive Ads </h3><a class="self-link" href="#ad-insertion-and-time-sensitive-ads" aria-label="Permalink for Appendix B.13"></a></div>
      
      <p>
        Seamless switching between video content and inserted segments of Ads is identified as an important use case for commercial interests. <a href="https://www.w3.org/wiki/HTML/Media_Task_Force/MSE_Ad_Insertion_Use_Cases">Media Task Force Ad Insertion Use Cases</a>. Support for precisely timed playback of video elements is the basis for seamless switching. The timing object object may define a common timeline for both main content and ads, and timed text track support may be used to schedule videos in and out at the correct time, possibly with cross-fading implememted in css. The timing text track may even be used to implement pre-loading of videos, so that they are ready to play content just before a video switch. Using a timing object as director of media playback like this additionally opens up the possibility of presenting time-sensitive ads at the right time, possibly on a secondary device.
      </p>
      <p>
        The timing object enables seamless, dynamic switching between different sources of timed media, and opens up for timed advertisements on multiple devices.
      </p>
      </section>
    </section>

    <section id="idl-index" class="appendix"><div class="header-wrapper"><h2 id="c-idl-index"><bdi class="secno">C. </bdi>IDL Index</h2><a class="self-link" href="#idl-index" aria-label="Permalink for Appendix C."></a></div>
  

<pre class="idl def" id="actual-idl-index"><span class="idlHeader"><a class="self-link" href="#actual-idl-index">WebIDL</a></span><code><span data-idl="" class="idlInterface" data-title="TimingObject">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
interface <dfn data-export="" data-dfn-type="interface" data-idl="interface" data-title="TimingObject" data-dfn-for="" class="idlID"><code>TimingObject</code></dfn> : <span class="idlSuperclass"><a data-link-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="TimingObject">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="TimingObject" data-lt="constructor()|constructor(vector)|constructor(vector, startPosition)|constructor(vector, startPosition, endPosition)" data-local-lt="TimingObject.constructor|TimingObject.constructor()|constructor"><code>constructor</code></dfn>(optional<span class="idlType"> <a data-link-type="idl" href="#dom-timingstatevectorupdate" class="internalDFN" id="ref-for-dom-timingstatevectorupdate-5"><code>TimingStateVectorUpdate</code></a></span> <span class="idlParamName">vector</span> = {},
              optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <span class="idlParamName">startPosition</span>,
              optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <span class="idlParamName">endPosition</span>);</span><span data-idl="" class="idlConstructor" data-title="constructor!overload-1" data-dfn-for="TimingObject">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="TimingObject" data-lt="constructor!overload-1()|constructor!overload-1(provider)" data-local-lt="TimingObject.constructor!overload-1|TimingObject.constructor!overload-1()|constructor!overload-1"><code>constructor</code></dfn>(<span class="idlType"><a data-link-type="idl" href="#dom-timingprovider" class="internalDFN" id="ref-for-dom-timingprovider-16"><code>TimingProvider</code></a></span> <span class="idlParamName">provider</span>);</span><span data-idl="" class="idlAttribute" data-title="timingProviderSource" data-dfn-for="TimingObject">
  readonly    attribute<span class="idlType"> <a data-link-type="idl" href="#dom-timingprovider" class="internalDFN" id="ref-for-dom-timingprovider-17"><code>TimingProvider</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-timingprovidersource" id="ref-for-dom-timingobject-timingprovidersource-2"><code>timingProviderSource</code></a>;</span><span data-idl="" class="idlAttribute" data-title="readyState" data-dfn-for="TimingObject">
  readonly    attribute<span class="idlType"> <a data-link-type="idl" href="#dom-timingobjectstate" class="internalDFN" id="ref-for-dom-timingobjectstate-2"><code>TimingObjectState</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-readystate" id="ref-for-dom-timingobject-readystate-3"><code>readyState</code></a>;</span><span data-idl="" class="idlAttribute" data-title="startPosition" data-dfn-for="TimingObject">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-startposition" id="ref-for-dom-timingobject-startposition-2"><code>startPosition</code></a>;</span><span data-idl="" class="idlAttribute" data-title="endPosition" data-dfn-for="TimingObject">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-endposition" id="ref-for-dom-timingobject-endposition-2"><code>endPosition</code></a>;</span><span data-idl="" class="idlAttribute" data-title="onreadystatechange" data-dfn-for="TimingObject">
              attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span>      <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-onreadystatechange" id="ref-for-dom-timingobject-onreadystatechange-2"><code>onreadystatechange</code></a>;</span><span data-idl="" class="idlAttribute" data-title="onchange" data-dfn-for="TimingObject">
              attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span>      <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-onchange" id="ref-for-dom-timingobject-onchange-2"><code>onchange</code></a>;</span><span data-idl="" class="idlAttribute" data-title="ontimeupdate" data-dfn-for="TimingObject">
              attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span>      <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-ontimeupdate" id="ref-for-dom-timingobject-ontimeupdate-2"><code>ontimeupdate</code></a>;</span><span data-idl="" class="idlAttribute" data-title="onerror" data-dfn-for="TimingObject">
              attribute<span class="idlType"> <a data-link-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span>      <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingobject-onerror" id="ref-for-dom-timingobject-onerror-2"><code>onerror</code></a>;</span><span data-idl="" class="idlMethod" data-title="query" data-dfn-for="TimingObject"><span class="idlType">
  <a data-link-type="idl" href="#dom-timingstatevector" class="internalDFN" id="ref-for-dom-timingstatevector-8"><code>TimingStateVector</code></a></span> <a class="internalDFN idlName" data-link-type="method" href="#dom-timingobject-query" id="ref-for-dom-timingobject-query-5"><code>query</code></a> ();</span><span data-idl="" class="idlMethod" data-title="update" data-dfn-for="TimingObject"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-timingobject-update" id="ref-for-dom-timingobject-update-4"><code>update</code></a> (optional<span class="idlType"> <a data-link-type="idl" href="#dom-timingstatevectorupdate" class="internalDFN" id="ref-for-dom-timingstatevectorupdate-6"><code>TimingStateVectorUpdate</code></a></span> <span class="idlParamName">newVector</span> = {});</span>
};</span>

<span data-idl="" class="idlEnum" data-title="TimingObjectState">enum <dfn data-export="" data-dfn-type="enum" data-idl="enum" data-title="TimingObjectState" data-dfn-for="" class="idlID"><code>TimingObjectState</code></dfn> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-timingobjectstate-connecting" id="ref-for-dom-timingobjectstate-connecting-2"><code>connecting</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-timingobjectstate-open" id="ref-for-dom-timingobjectstate-open-2"><code>open</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-timingobjectstate-closing" id="ref-for-dom-timingobjectstate-closing-2"><code>closing</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-timingobjectstate-closed" id="ref-for-dom-timingobjectstate-closed-2"><code>closed</code></a>"</span>
};</span>

<span data-idl="" class="idlInterface" data-title="TimingProvider">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
interface <dfn data-export="" data-dfn-type="interface" data-idl="interface" data-title="TimingProvider" data-dfn-for="" class="idlID"><code>TimingProvider</code></dfn> {<span data-idl="" class="idlAttribute" data-title="vector" data-dfn-for="TimingProvider">
  readonly    attribute<span class="idlType"> <a data-link-type="idl" href="#dom-timingstatevector" class="internalDFN" id="ref-for-dom-timingstatevector-9"><code>TimingStateVector</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingprovider-vector" id="ref-for-dom-timingprovider-vector-4"><code>vector</code></a>;</span><span data-idl="" class="idlAttribute" data-title="startPosition" data-dfn-for="TimingProvider">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingprovider-startposition" id="ref-for-dom-timingprovider-startposition-2"><code>startPosition</code></a>;</span><span data-idl="" class="idlAttribute" data-title="endPosition" data-dfn-for="TimingProvider">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingprovider-endposition" id="ref-for-dom-timingprovider-endposition-2"><code>endPosition</code></a>;</span><span data-idl="" class="idlAttribute" data-title="readyState" data-dfn-for="TimingProvider">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span>         <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingprovider-readystate" id="ref-for-dom-timingprovider-readystate-4"><code>readyState</code></a>;</span><span data-idl="" class="idlAttribute" data-title="skew" data-dfn-for="TimingProvider">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unrestricted-double">unrestricted double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingprovider-skew" id="ref-for-dom-timingprovider-skew-3"><code>skew</code></a>;</span><span data-idl="" class="idlMethod" data-title="update" data-dfn-for="TimingProvider"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined">undefined</a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-timingprovider-update" id="ref-for-dom-timingprovider-update-2"><code>update</code></a> (optional<span class="idlType"> <a data-link-type="idl" href="#dom-timingstatevectorupdate" class="internalDFN" id="ref-for-dom-timingstatevectorupdate-7"><code>TimingStateVectorUpdate</code></a></span> <span class="idlParamName">newVector</span> = {});</span>
};</span>

<span data-idl="" class="idlDictionary" data-title="TimingStateVectorUpdate">dictionary <dfn data-export="" data-dfn-type="dictionary" data-idl="dictionary" data-title="TimingStateVectorUpdate" data-dfn-for="" class="idlID"><code>TimingStateVectorUpdate</code></dfn> {<span data-idl="" class="idlMember" data-title="position" data-dfn-for="TimingStateVectorUpdate"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <dfn data-export="" data-dfn-type="dict-member" data-idl="field" data-title="position" data-dfn-for="TimingStateVectorUpdate" data-type="double" class="idlName"><code>position</code></dfn>;</span><span data-idl="" class="idlMember" data-title="velocity" data-dfn-for="TimingStateVectorUpdate"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <dfn data-export="" data-dfn-type="dict-member" data-idl="field" data-title="velocity" data-dfn-for="TimingStateVectorUpdate" data-type="double" class="idlName"><code>velocity</code></dfn>;</span><span data-idl="" class="idlMember" data-title="acceleration" data-dfn-for="TimingStateVectorUpdate"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <dfn data-export="" data-dfn-type="dict-member" data-idl="field" data-title="acceleration" data-dfn-for="TimingStateVectorUpdate" data-type="double" class="idlName"><code>acceleration</code></dfn>;</span>
};</span><span data-idl="" class="idlDictionary" data-title="TimingStateVectorInit">

dictionary <dfn data-export="" data-dfn-type="dictionary" data-idl="dictionary" data-title="TimingStateVectorInit" data-dfn-for="" class="idlID"><code>TimingStateVectorInit</code></dfn> : <span class="idlSuperclass"><a data-link-type="idl" href="#dom-timingstatevectorupdate" class="internalDFN" id="ref-for-dom-timingstatevectorupdate-8"><code>TimingStateVectorUpdate</code></a></span> {<span data-idl="" class="idlMember" data-title="timestamp" data-dfn-for="TimingStateVectorInit"><span class="idlType">
  <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <dfn data-export="" data-dfn-type="dict-member" data-idl="field" data-title="timestamp" data-dfn-for="TimingStateVectorInit" data-type="double" class="idlName"><code>timestamp</code></dfn>;</span>
};</span><span data-idl="" class="idlInterface" data-title="TimingStateVector">

[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
interface <dfn data-export="" data-dfn-type="interface" data-idl="interface" data-title="TimingStateVector" data-dfn-for="" class="idlID"><code>TimingStateVector</code></dfn> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="TimingStateVector">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="TimingStateVector" data-lt="constructor()|constructor(vectorDict)" data-local-lt="TimingStateVector.constructor|TimingStateVector.constructor()|constructor"><code>constructor</code></dfn>(optional<span class="idlType"> <a data-link-type="idl" href="#dom-timingstatevectorinit" class="internalDFN" id="ref-for-dom-timingstatevectorinit-2"><code>TimingStateVectorInit</code></a></span> <span class="idlParamName">vectorDict</span> = {});</span><span data-idl="" class="idlAttribute" data-title="position" data-dfn-for="TimingStateVector">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingstatevector-position" id="ref-for-dom-timingstatevector-position-3"><code>position</code></a>;</span><span data-idl="" class="idlAttribute" data-title="velocity" data-dfn-for="TimingStateVector">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingstatevector-velocity" id="ref-for-dom-timingstatevector-velocity-3"><code>velocity</code></a>;</span><span data-idl="" class="idlAttribute" data-title="acceleration" data-dfn-for="TimingStateVector">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingstatevector-acceleration" id="ref-for-dom-timingstatevector-acceleration-3"><code>acceleration</code></a>;</span><span data-idl="" class="idlAttribute" data-title="timestamp" data-dfn-for="TimingStateVector">
  readonly    attribute<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-double">double</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingstatevector-timestamp" id="ref-for-dom-timingstatevector-timestamp-3"><code>timestamp</code></a>;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="HTMLMediaElement">partial interface <a data-idl="partial" data-link-type="interface" data-title="HTMLMediaElement" class="idlID" data-dfn-for="HTMLMediaElement" href="https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement">HTMLMediaElement</a> {<span data-idl="" class="idlAttribute" data-title="timingsrc" data-dfn-for="HTMLMediaElement">
  attribute<span class="idlType"> <a data-link-type="idl" href="#dom-timingobject" class="internalDFN" id="ref-for-dom-timingobject-19"><code>TimingObject</code></a></span> <dfn data-export="" data-dfn-type="attribute" data-idl="attribute" data-title="timingsrc" data-dfn-for="HTMLMediaElement" data-type="TimingObject" data-lt="timingsrc" data-local-lt="HTMLMediaElement.timingsrc" class="idlName"><code>timingsrc</code></dfn>;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="TimingTextTrack">[<span class="extAttr"><a data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=Window</span>]
interface <dfn data-export="" data-dfn-type="interface" data-idl="interface" data-title="TimingTextTrack" data-dfn-for="" class="idlID"><code>TimingTextTrack</code></dfn> : <span class="idlSuperclass"><a data-link-type="interface" href="https://html.spec.whatwg.org/multipage/media.html#texttrack">TextTrack</a></span> {<span data-idl="" class="idlConstructor" data-title="constructor" data-dfn-for="TimingTextTrack">
  <dfn data-export="" data-dfn-type="constructor" data-idl="constructor" data-title="constructor" data-dfn-for="TimingTextTrack" data-lt="constructor()|constructor(kind)|constructor(kind, label)|constructor(kind, label, language)" data-local-lt="TimingTextTrack.constructor|TimingTextTrack.constructor()|constructor"><code>constructor</code></dfn>(<span class="idlType"><a data-link-type="enum" href="https://html.spec.whatwg.org/multipage/media.html#texttrackkind">TextTrackKind</a></span> <span class="idlParamName">kind</span>, optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">label</span> = "", optional<span class="idlType"> <a data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">language</span> = "");</span><span data-idl="" class="idlAttribute" data-title="timingsrc" data-dfn-for="TimingTextTrack">
  attribute<span class="idlType"> <a data-link-type="idl" href="#dom-timingobject" class="internalDFN" id="ref-for-dom-timingobject-20"><code>TimingObject</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-timingtexttrack-timingsrc" id="ref-for-dom-timingtexttrack-timingsrc-2"><code>timingsrc</code></a>;</span>
};</span></code></pre></section><section id="references" class="appendix"><div class="header-wrapper"><h2 id="d-references"><bdi class="secno">D. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix D."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="d-1-normative-references"><bdi class="secno">D.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix D.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-dom">[dom]</dt><dd>
      <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
    </dd><dt id="bib-hr-time">[HR-TIME]</dt><dd>
      <a href="https://www.w3.org/TR/hr-time-3/"><cite>High Resolution Time</cite></a>. Yoav Weiss.  W3C. 7 November 2024. W3C Working Draft. URL: <a href="https://www.w3.org/TR/hr-time-3/">https://www.w3.org/TR/hr-time-3/</a>
    </dd><dt id="bib-html">[HTML]</dt><dd>
      <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Dominic Farolino; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
    </dd><dt id="bib-html5">[HTML5]</dt><dd>
      <a href="https://www.w3.org/TR/html5/"><cite>HTML5</cite></a>. Ian Hickson; Robin Berjon; Steve Faulkner; Travis Leithead; Erika Doyle Navara; Theresa O'Connor; Silvia Pfeiffer.  W3C. 27 March 2018. W3C Recommendation. URL: <a href="https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>
    </dd><dt id="bib-mediasync">[MEDIASYNC]</dt><dd>
      <a href="https://github.com/webtiming/mediasync"><cite>MediaSync</cite></a>. URL: <a href="https://github.com/webtiming/mediasync">https://github.com/webtiming/mediasync</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-webidl">[WEBIDL]</dt><dd>
      <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Edgar Chen; Timothy Gu.  WHATWG. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="d-2-informative-references"><bdi class="secno">D.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix D.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-dvb-css">[DVB-CSS]</dt><dd>
      <a href="https://www.etsi.org/deliver/etsi_ts/103200_103299/10328602/01.01.01_60/ts_10328602v010101p.pdf"><cite>ETSI TS 103 286-2 V1.1.1 Digital Video Broadcasting (DVB); Companion Screens and Streams; Part 2: Content Identification and Media Synchronization</cite></a>. URL: <a href="https://www.etsi.org/deliver/etsi_ts/103200_103299/10328602/01.01.01_60/ts_10328602v010101p.pdf">https://www.etsi.org/deliver/etsi_ts/103200_103299/10328602/01.01.01_60/ts_10328602v010101p.pdf</a>
    </dd><dt id="bib-linearcomposition">[LINEARCOMPOSITION]</dt><dd>
      <a href="https://sites.google.com/site/mediasynchronization/Paper4_Arntzen_webComposition_CR.pdf?attredirects=0&amp;d=1"><cite>Multi-device Linear Composition on the Web: Enabling Multi-device Linear Media with HTMLTimingObject and Shared Motion</cite></a>. Ingar M. Arntzen; Njål T. Borch; François Daoust; Dominique Hazaël-Massieux. URL: <a href="https://sites.google.com/site/mediasynchronization/Paper4_Arntzen_webComposition_CR.pdf?attredirects=0&amp;d=1">https://sites.google.com/site/mediasynchronization/Paper4_Arntzen_webComposition_CR.pdf?attredirects=0&amp;d=1</a>
    </dd><dt id="bib-msv">[MSV]</dt><dd>
      <a href="https://dl.acm.org/citation.cfm?doid=2457413.2457427"><cite>The Media State Vector: A unifying concept for multi-device media navigation</cite></a>. Ingar M. Arntzen; Njål T. Borch; Christopher P. Needham. URL: <a href="https://dl.acm.org/citation.cfm?doid=2457413.2457427">https://dl.acm.org/citation.cfm?doid=2457413.2457427</a>
    </dd><dt id="bib-sequencer">[SEQUENCER]</dt><dd>
      <a href="https://github.com/webtiming/sequencer"><cite>Open-source sequencer library</cite></a>. URL: <a href="https://github.com/webtiming/sequencer">https://github.com/webtiming/sequencer</a>
    </dd><dt id="bib-smil3">[SMIL3]</dt><dd>
      <a href="https://www.w3.org/TR/SMIL3/"><cite>Synchronized Multimedia Integration Language (SMIL 3.0)</cite></a>. Dick Bulterman.  W3C. 1 December 2008. W3C Recommendation. URL: <a href="https://www.w3.org/TR/SMIL3/">https://www.w3.org/TR/SMIL3/</a>
    </dd><dt id="bib-web-animations-1">[WEB-ANIMATIONS-1]</dt><dd>
      <a href="https://www.w3.org/TR/web-animations-1/"><cite>Web Animations</cite></a>. Brian Birtles; Robert Flack; Stephen McGruer; Antoine Quint.  W3C. 5 June 2023. W3C Working Draft. URL: <a href="https://www.w3.org/TR/web-animations-1/">https://www.w3.org/TR/web-animations-1/</a>
    </dd><dt id="bib-webaudio">[WEBAUDIO]</dt><dd>
      <a href="https://www.w3.org/TR/webaudio-1.0/"><cite>Web Audio API</cite></a>. Paul Adenot; Hongchan Choi.  W3C. 17 June 2021. W3C Recommendation. URL: <a href="https://www.w3.org/TR/webaudio-1.0/">https://www.w3.org/TR/webaudio-1.0/</a>
    </dd><dt id="bib-websockets">[WEBSOCKETS]</dt><dd>
      <a href="https://websockets.spec.whatwg.org/"><cite>WebSockets Standard</cite></a>. Adam Rice.  WHATWG. Living Standard. URL: <a href="https://websockets.spec.whatwg.org/">https://websockets.spec.whatwg.org/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-linear-composition" aria-label="Links in this document to definition: Linear composition">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-linear-composition" aria-label="Permalink for definition: Linear composition. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-linear-composition-1" title="§ 1.1 Linear composition">§ 1.1 Linear composition</a> 
    </li><li>
      <a href="#ref-for-dfn-linear-composition-2" title="§ 1.2 Design goals">§ 1.2 Design goals</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-temporal-composition" aria-label="Links in this document to definition: temporal composition">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-temporal-composition" aria-label="Permalink for definition: temporal composition. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-user-agent" aria-label="Links in this document to definition: user agent">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-user-agent" aria-label="Permalink for definition: user agent. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-user-agent-1" title="§ 3. Terminology">§ 3. Terminology</a> <a href="#ref-for-dfn-user-agent-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-user-agent-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-4" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-user-agent-5" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-6" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> <a href="#ref-for-dfn-user-agent-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-user-agent-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-user-agent-9" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-10" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-11" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-12" title="§ 5.4 Set the internal timeout">§ 5.4 Set the internal timeout</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-13" title="§ 5.5 Cover a position">§ 5.5 Cover a position</a> <a href="#ref-for-dfn-user-agent-14" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-15" title="§ 5.6 Process Vector Change">§ 5.6 Process Vector Change</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-16" title="§ 5.7 Process Skew Change">§ 5.7 Process Skew Change</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-17" title="§ 5.8 Translate timestamp from user agent to timing resource provider timeline">§ 5.8 Translate timestamp from user agent to timing resource provider timeline</a> <a href="#ref-for-dfn-user-agent-18" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-19" title="§ 5.9 Translate timestamp from timing resource provider to user agent timeline">§ 5.9 Translate timestamp from timing resource provider to user agent timeline</a> <a href="#ref-for-dfn-user-agent-20" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-21" title="§ 5.10 Calculate skew adjustment">§ 5.10 Calculate skew adjustment</a> <a href="#ref-for-dfn-user-agent-22" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-23" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-24" title="§ 7.1 Create a new state vector">§ 7.1 Create a new state vector</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-25" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> <a href="#ref-for-dfn-user-agent-26" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-27" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-28" title="§ 9.3 Procedure: Create a new timing text track">§ 9.3 Procedure: Create a new timing text track</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-29" title="§ 9.4 Procedure: Associate timing text track with a timing object">§ 9.4 Procedure: Associate timing text track with a timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-user-agent-30" title="§ A. Implementation guidelines multi-device synchronization">§ A. Implementation guidelines multi-device synchronization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-timing-resource-provider" aria-label="Links in this document to definition: timing resource provider">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-timing-resource-provider" aria-label="Permalink for definition: timing resource provider. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-timing-resource-provider-1" title="§ 2. Conformance">§ 2. Conformance</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-2" title="§ 3. Terminology">§ 3. Terminology</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-3" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-timing-resource-provider-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-resource-provider-5" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-6" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-7" title="§ 5.8 Translate timestamp from user agent to timing resource provider timeline">§ 5.8 Translate timestamp from user agent to timing resource provider timeline</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-8" title="§ 5.9 Translate timestamp from timing resource provider to user agent timeline">§ 5.9 Translate timestamp from timing resource provider to user agent timeline</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-9" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> <a href="#ref-for-dfn-timing-resource-provider-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-resource-provider-11" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-resource-provider-12" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-resource-provider-13" title="Reference 5">(5)</a> <a href="#ref-for-dfn-timing-resource-provider-14" title="Reference 6">(6)</a> <a href="#ref-for-dfn-timing-resource-provider-15" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-16" title="§ 6.1 Process an update operation">§ 6.1 Process an update operation</a> <a href="#ref-for-dfn-timing-resource-provider-17" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-18" title="§ 6.2 Report new conditions of the current motion">§ 6.2 Report new conditions of the current motion</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-19" title="§ 6.3 Report a state change">§ 6.3 Report a state change</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-20" title="§ 6.4 Report a skew change">§ 6.4 Report a skew change</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-21" title="§ 6.5 Report an error">§ 6.5 Report an error</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-22" title="§ 7.1 Create a new state vector">§ 7.1 Create a new state vector</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-provider-23" title="§ A. Implementation guidelines multi-device synchronization">§ A. Implementation guidelines multi-device synchronization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-media-element" aria-label="Links in this document to definition: media element">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-media-element" aria-label="Permalink for definition: media element. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-media-element-1" title="§ 1.2 Design goals">§ 1.2 Design goals</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-2" title="§ 1.5 Connecting the timing object">§ 1.5 Connecting the timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-3" title="§ 8. Media elements and the timing object">§ 8. Media elements and the timing object</a> <a href="#ref-for-dfn-media-element-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-5" title="§ 8.1 Introduction">§ 8.1 Introduction</a> <a href="#ref-for-dfn-media-element-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-media-element-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-media-element-8" title="Reference 4">(4)</a> <a href="#ref-for-dfn-media-element-9" title="Reference 5">(5)</a> <a href="#ref-for-dfn-media-element-10" title="Reference 6">(6)</a> <a href="#ref-for-dfn-media-element-11" title="Reference 7">(7)</a> <a href="#ref-for-dfn-media-element-12" title="Reference 8">(8)</a> <a href="#ref-for-dfn-media-element-13" title="Reference 9">(9)</a> <a href="#ref-for-dfn-media-element-14" title="Reference 10">(10)</a> <a href="#ref-for-dfn-media-element-15" title="Reference 11">(11)</a> <a href="#ref-for-dfn-media-element-16" title="Reference 12">(12)</a> <a href="#ref-for-dfn-media-element-17" title="Reference 13">(13)</a> <a href="#ref-for-dfn-media-element-18" title="Reference 14">(14)</a> <a href="#ref-for-dfn-media-element-19" title="Reference 15">(15)</a> <a href="#ref-for-dfn-media-element-20" title="Reference 16">(16)</a> <a href="#ref-for-dfn-media-element-21" title="Reference 17">(17)</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-22" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> <a href="#ref-for-dfn-media-element-23" title="Reference 2">(2)</a> <a href="#ref-for-dfn-media-element-24" title="Reference 3">(3)</a> <a href="#ref-for-dfn-media-element-25" title="Reference 4">(4)</a> <a href="#ref-for-dfn-media-element-26" title="Reference 5">(5)</a> <a href="#ref-for-dfn-media-element-27" title="Reference 6">(6)</a> <a href="#ref-for-dfn-media-element-28" title="Reference 7">(7)</a> <a href="#ref-for-dfn-media-element-29" title="Reference 8">(8)</a> <a href="#ref-for-dfn-media-element-30" title="Reference 9">(9)</a> <a href="#ref-for-dfn-media-element-31" title="Reference 10">(10)</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-32" title="§ 8.3 Procedure: Set the current media controller for media element">§ 8.3 Procedure: Set the current media controller for media element</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-33" title="§ 8.4 Procedure: Set the current position for media element">§ 8.4 Procedure: Set the current position for media element</a> <a href="#ref-for-dfn-media-element-34" title="Reference 2">(2)</a> <a href="#ref-for-dfn-media-element-35" title="Reference 3">(3)</a> <a href="#ref-for-dfn-media-element-36" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-37" title="§ 8.5 Procedure: Check error in time-alignment for media element">§ 8.5 Procedure: Check error in time-alignment for media element</a> <a href="#ref-for-dfn-media-element-38" title="Reference 2">(2)</a> <a href="#ref-for-dfn-media-element-39" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-40" title="§ 8.6 Procedure: Time-align media element with timing object">§ 8.6 Procedure: Time-align media element with timing object</a> <a href="#ref-for-dfn-media-element-41" title="Reference 2">(2)</a> <a href="#ref-for-dfn-media-element-42" title="Reference 3">(3)</a> <a href="#ref-for-dfn-media-element-43" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-44" title="§ 9.1 Introduction">§ 9.1 Introduction</a> <a href="#ref-for-dfn-media-element-45" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-46" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> <a href="#ref-for-dfn-media-element-47" title="Reference 2">(2)</a> <a href="#ref-for-dfn-media-element-48" title="Reference 3">(3)</a> <a href="#ref-for-dfn-media-element-49" title="Reference 4">(4)</a> <a href="#ref-for-dfn-media-element-50" title="Reference 5">(5)</a> <a href="#ref-for-dfn-media-element-51" title="Reference 6">(6)</a> <a href="#ref-for-dfn-media-element-52" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dfn-media-element-53" title="§ 9.5 Procedure: Track marches on">§ 9.5 Procedure: Track marches on</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-effective-playback-rate" aria-label="Links in this document to definition: effective playback rate">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-effective-playback-rate" aria-label="Permalink for definition: effective playback rate. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-effective-playback-rate-1" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-text-tracks" aria-label="Links in this document to definition: text track">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-text-tracks" aria-label="Permalink for definition: text track. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-text-tracks-1" title="§ 1.5 Connecting the timing object">§ 1.5 Connecting the timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-text-tracks-2" title="§ 9.1 Introduction">§ 9.1 Introduction</a> <a href="#ref-for-dfn-text-tracks-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-text-tracks-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-text-tracks-5" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-text-tracks-6" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> <a href="#ref-for-dfn-text-tracks-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-text-tracks-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-text-tracks-9" title="Reference 4">(4)</a> <a href="#ref-for-dfn-text-tracks-10" title="Reference 5">(5)</a> <a href="#ref-for-dfn-text-tracks-11" title="Reference 6">(6)</a> <a href="#ref-for-dfn-text-tracks-12" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dfn-text-tracks-13" title="§ 9.5 Procedure: Track marches on">§ 9.5 Procedure: Track marches on</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-text-track-cue" aria-label="Links in this document to definition: text track cue">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-text-track-cue" aria-label="Permalink for definition: text track cue. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-text-track-cue-1" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> 
    </li><li>
      <a href="#ref-for-dfn-text-track-cue-2" title="§ 9.5 Procedure: Track marches on">§ 9.5 Procedure: Track marches on</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-text-track-kind" aria-label="Links in this document to definition: text track kind">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-text-track-kind" aria-label="Permalink for definition: text track kind. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-text-track-kind-1" title="§ 9.3 Procedure: Create a new timing text track">§ 9.3 Procedure: Create a new timing text track</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-text-track-label" aria-label="Links in this document to definition: text track label">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-text-track-label" aria-label="Permalink for definition: text track label. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-text-track-label-1" title="§ 9.3 Procedure: Create a new timing text track">§ 9.3 Procedure: Create a new timing text track</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-text-track-mode" aria-label="Links in this document to definition: text track mode">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-text-track-mode" aria-label="Permalink for definition: text track mode. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-text-track-mode-1" title="§ 9.3 Procedure: Create a new timing text track">§ 9.3 Procedure: Create a new timing text track</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-text-track-hidden" aria-label="Links in this document to definition: text track hidden">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-text-track-hidden" aria-label="Permalink for definition: text track hidden. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-text-track-hidden-1" title="§ 9.3 Procedure: Create a new timing text track">§ 9.3 Procedure: Create a new timing text track</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-text-track-loaded" aria-label="Links in this document to definition: text track loaded">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-text-track-loaded" aria-label="Permalink for definition: text track loaded. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-text-track-loaded-1" title="§ 9.3 Procedure: Create a new timing text track">§ 9.3 Procedure: Create a new timing text track</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-text-track-readiness-state" aria-label="Links in this document to definition: text track readiness state">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-text-track-readiness-state" aria-label="Permalink for definition: text track readiness state. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-text-track-readiness-state-1" title="§ 9.3 Procedure: Create a new timing text track">§ 9.3 Procedure: Create a new timing text track</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-text-track-list-of-cues" aria-label="Links in this document to definition: text track list of cues">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-text-track-list-of-cues" aria-label="Permalink for definition: text track list of cues. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-text-track-list-of-cues-1" title="§ 9.3 Procedure: Create a new timing text track">§ 9.3 Procedure: Create a new timing text track</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-current-playback-position" aria-label="Links in this document to definition: current playback position">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-current-playback-position" aria-label="Permalink for definition: current playback position. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-current-playback-position-1" title="§ 9.5 Procedure: Track marches on">§ 9.5 Procedure: Track marches on</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-time-marches-on" aria-label="Links in this document to definition: time marches on">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-time-marches-on" aria-label="Permalink for definition: time marches on. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-time-marches-on-1" title="§ 9.5 Procedure: Track marches on">§ 9.5 Procedure: Track marches on</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-current-media-controller" aria-label="Links in this document to definition: current media controller">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-current-media-controller" aria-label="Permalink for definition: current media controller. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-current-media-controller-1" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> <a href="#ref-for-dfn-current-media-controller-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-current-media-controller-3" title="§ 8.3 Procedure: Set the current media controller for media element">§ 8.3 Procedure: Set the current media controller for media element</a> <a href="#ref-for-dfn-current-media-controller-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-current-media-controller-5" title="§ 8.4 Procedure: Set the current position for media element">§ 8.4 Procedure: Set the current position for media element</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-slaved-media-elements" aria-label="Links in this document to definition: slaved media elements">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-slaved-media-elements" aria-label="Permalink for definition: slaved media elements. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-slaved-media-elements-1" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-report-the-controller-state" aria-label="Links in this document to definition: report the controller state">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-report-the-controller-state" aria-label="Permalink for definition: report the controller state. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-report-the-controller-state-1" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-mediacontroller" aria-label="Links in this document to definition: MediaController">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-mediacontroller" aria-label="Permalink for definition: MediaController. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-mediacontroller-1" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-internal-clock" aria-label="Links in this document to definition: internal clock">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-internal-clock" aria-label="Permalink for definition: internal clock. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-internal-clock-1" title="§ 3. Terminology">§ 3. Terminology</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-clock-2" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-internal-clock-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-clock-4" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-clock-5" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> <a href="#ref-for-dfn-internal-clock-6" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-clock-7" title="§ 5.4 Set the internal timeout">§ 5.4 Set the internal timeout</a> <a href="#ref-for-dfn-internal-clock-8" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-clock-9" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> <a href="#ref-for-dfn-internal-clock-10" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-clock-11" title="§ 7. State Vector">§ 7. State Vector</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-clock-12" title="§ A.2 Clock synchronization">§ A.2 Clock synchronization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-timing-resource" aria-label="Links in this document to definition: timing resource">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-timing-resource" aria-label="Permalink for definition: timing resource. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-timing-resource-1" title="§ 2. Conformance">§ 2. Conformance</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-2" title="§ 3. Terminology">§ 3. Terminology</a> <a href="#ref-for-dfn-timing-resource-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-4" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-5" title="§ 5.11 Connection states">§ 5.11 Connection states</a> <a href="#ref-for-dfn-timing-resource-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-resource-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-resource-8" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-resource-9" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-10" title="§ 5.12 Event handlers">§ 5.12 Event handlers</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-11" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> <a href="#ref-for-dfn-timing-resource-12" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-13" title="§ 6.1 Process an update operation">§ 6.1 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-14" title="§ 7. State Vector">§ 7. State Vector</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-resource-15" title="§ A. Implementation guidelines multi-device synchronization">§ A. Implementation guidelines multi-device synchronization</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-internal-timing-resource" aria-label="Links in this document to definition: internal timing resource">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-internal-timing-resource" aria-label="Permalink for definition: internal timing resource. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-internal-timing-resource-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-external-timing-resource" aria-label="Links in this document to definition: external timing resource">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-external-timing-resource" aria-label="Permalink for definition: external timing resource. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-external-timing-resource-1" title="§ 3. Terminology">§ 3. Terminology</a> 
    </li><li>
      <a href="#ref-for-dfn-external-timing-resource-2" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-external-timing-resource-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-external-timing-resource-4" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dfn-external-timing-resource-5" title="§ 5.12 Event handlers">§ 5.12 Event handlers</a> 
    </li><li>
      <a href="#ref-for-dfn-external-timing-resource-6" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> <a href="#ref-for-dfn-external-timing-resource-7" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-external-timing-resource-8" title="§ 6.1 Process an update operation">§ 6.1 Process an update operation</a> <a href="#ref-for-dfn-external-timing-resource-9" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-external-timing-resource-10" title="§ 6.2 Report new conditions of the current motion">§ 6.2 Report new conditions of the current motion</a> 
    </li><li>
      <a href="#ref-for-dfn-external-timing-resource-11" title="§ 6.3 Report a state change">§ 6.3 Report a state change</a> 
    </li><li>
      <a href="#ref-for-dfn-external-timing-resource-12" title="§ 6.4 Report a skew change">§ 6.4 Report a skew change</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-online-timing-resources" aria-label="Links in this document to definition: online timing resource">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-online-timing-resources" aria-label="Permalink for definition: online timing resource. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-online-timing-resources-1" title="§ 1.5 Connecting the timing object">§ 1.5 Connecting the timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-online-timing-resources-2" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dfn-online-timing-resources-3" title="§ A. Implementation guidelines multi-device synchronization">§ A. Implementation guidelines multi-device synchronization</a> <a href="#ref-for-dfn-online-timing-resources-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-online-timing-resources-5" title="§ A.1 State vector synchronization">§ A.1 State vector synchronization</a> <a href="#ref-for-dfn-online-timing-resources-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-online-timing-resources-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-online-timing-resources-8" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-online-timing-resources-9" title="§ A.2 Clock synchronization">§ A.2 Clock synchronization</a> <a href="#ref-for-dfn-online-timing-resources-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-online-timing-resources-11" title="Reference 3">(3)</a> <a href="#ref-for-dfn-online-timing-resources-12" title="Reference 4">(4)</a> <a href="#ref-for-dfn-online-timing-resources-13" title="Reference 5">(5)</a> <a href="#ref-for-dfn-online-timing-resources-14" title="Reference 6">(6)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-timing-object" aria-label="Links in this document to definition: timing object">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-timing-object" aria-label="Permalink for definition: timing object. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-timing-object-1" title="§ 1.5 Connecting the timing object">§ 1.5 Connecting the timing object</a> <a href="#ref-for-dfn-timing-object-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-object-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-object-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-timing-object-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-timing-object-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-timing-object-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-timing-object-9" title="Reference 9">(9)</a> <a href="#ref-for-dfn-timing-object-10" title="Reference 10">(10)</a> <a href="#ref-for-dfn-timing-object-11" title="Reference 11">(11)</a> <a href="#ref-for-dfn-timing-object-12" title="Reference 12">(12)</a> <a href="#ref-for-dfn-timing-object-13" title="Reference 13">(13)</a> <a href="#ref-for-dfn-timing-object-14" title="Reference 14">(14)</a> <a href="#ref-for-dfn-timing-object-15" title="Reference 15">(15)</a> <a href="#ref-for-dfn-timing-object-16" title="Reference 16">(16)</a> <a href="#ref-for-dfn-timing-object-17" title="Reference 17">(17)</a> <a href="#ref-for-dfn-timing-object-18" title="Reference 18">(18)</a> <a href="#ref-for-dfn-timing-object-19" title="Reference 19">(19)</a> <a href="#ref-for-dfn-timing-object-20" title="Reference 20">(20)</a> <a href="#ref-for-dfn-timing-object-21" title="Reference 21">(21)</a> <a href="#ref-for-dfn-timing-object-22" title="Reference 22">(22)</a> <a href="#ref-for-dfn-timing-object-23" title="Reference 23">(23)</a> <a href="#ref-for-dfn-timing-object-24" title="Reference 24">(24)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-25" title="§ 1.8 Naming">§ 1.8 Naming</a> <a href="#ref-for-dfn-timing-object-26" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-27" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-28" title="§ 2. Conformance">§ 2. Conformance</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-29" title="§ 3. Terminology">§ 3. Terminology</a> <a href="#ref-for-dfn-timing-object-30" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-31" title="§ 4.7 Connect to a timing provider">§ 4.7 Connect to a timing provider</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-32" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-timing-object-33" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-34" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-object-35" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-object-36" title="Reference 5">(5)</a> <a href="#ref-for-dfn-timing-object-37" title="Reference 6">(6)</a> <a href="#ref-for-dfn-timing-object-38" title="Reference 7">(7)</a> <a href="#ref-for-dfn-timing-object-39" title="Reference 8">(8)</a> <a href="#ref-for-dfn-timing-object-40" title="Reference 9">(9)</a> <a href="#ref-for-dfn-timing-object-41" title="Reference 10">(10)</a> <a href="#ref-for-dfn-timing-object-42" title="Reference 11">(11)</a> <a href="#ref-for-dfn-timing-object-43" title="Reference 12">(12)</a> <a href="#ref-for-dfn-timing-object-44" title="Reference 13">(13)</a> <a href="#ref-for-dfn-timing-object-45" title="Reference 14">(14)</a> <a href="#ref-for-dfn-timing-object-46" title="Reference 15">(15)</a> <a href="#ref-for-dfn-timing-object-47" title="Reference 16">(16)</a> <a href="#ref-for-dfn-timing-object-48" title="Reference 17">(17)</a> <a href="#ref-for-dfn-timing-object-49" title="Reference 18">(18)</a> <a href="#ref-for-dfn-timing-object-50" title="Reference 19">(19)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-51" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-52" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> <a href="#ref-for-dfn-timing-object-53" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-54" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-55" title="§ 5.4 Set the internal timeout">§ 5.4 Set the internal timeout</a> <a href="#ref-for-dfn-timing-object-56" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-57" title="§ 5.6 Process Vector Change">§ 5.6 Process Vector Change</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-58" title="§ 5.7 Process Skew Change">§ 5.7 Process Skew Change</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-59" title="§ 5.10 Calculate skew adjustment">§ 5.10 Calculate skew adjustment</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-60" title="§ 5.11 Connection states">§ 5.11 Connection states</a> <a href="#ref-for-dfn-timing-object-61" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-62" title="§ 5.12 Event handlers">§ 5.12 Event handlers</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-63" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> <a href="#ref-for-dfn-timing-object-64" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-65" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-object-66" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-object-67" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-68" title="§ 7. State Vector">§ 7. State Vector</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-69" title="§ 8. Media elements and the timing object">§ 8. Media elements and the timing object</a> <a href="#ref-for-dfn-timing-object-70" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-71" title="§ 8.1 Introduction">§ 8.1 Introduction</a> <a href="#ref-for-dfn-timing-object-72" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-73" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-object-74" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-object-75" title="Reference 5">(5)</a> <a href="#ref-for-dfn-timing-object-76" title="Reference 6">(6)</a> <a href="#ref-for-dfn-timing-object-77" title="Reference 7">(7)</a> <a href="#ref-for-dfn-timing-object-78" title="Reference 8">(8)</a> <a href="#ref-for-dfn-timing-object-79" title="Reference 9">(9)</a> <a href="#ref-for-dfn-timing-object-80" title="Reference 10">(10)</a> <a href="#ref-for-dfn-timing-object-81" title="Reference 11">(11)</a> <a href="#ref-for-dfn-timing-object-82" title="Reference 12">(12)</a> <a href="#ref-for-dfn-timing-object-83" title="Reference 13">(13)</a> <a href="#ref-for-dfn-timing-object-84" title="Reference 14">(14)</a> <a href="#ref-for-dfn-timing-object-85" title="Reference 15">(15)</a> <a href="#ref-for-dfn-timing-object-86" title="Reference 16">(16)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-87" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> <a href="#ref-for-dfn-timing-object-88" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-89" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-object-90" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-91" title="§ 8.4 Procedure: Set the current position for media element">§ 8.4 Procedure: Set the current position for media element</a> <a href="#ref-for-dfn-timing-object-92" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-93" title="§ 8.5 Procedure: Check error in time-alignment for media element">§ 8.5 Procedure: Check error in time-alignment for media element</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-94" title="§ 8.6 Procedure: Time-align media element with timing object">§ 8.6 Procedure: Time-align media element with timing object</a> <a href="#ref-for-dfn-timing-object-95" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-96" title="§ 9.1 Introduction">§ 9.1 Introduction</a> <a href="#ref-for-dfn-timing-object-97" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-98" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-object-99" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-object-100" title="Reference 5">(5)</a> <a href="#ref-for-dfn-timing-object-101" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-102" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> <a href="#ref-for-dfn-timing-object-103" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-104" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-object-105" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-object-106" title="Reference 5">(5)</a> <a href="#ref-for-dfn-timing-object-107" title="Reference 6">(6)</a> <a href="#ref-for-dfn-timing-object-108" title="Reference 7">(7)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-109" title="§ 9.4 Procedure: Associate timing text track with a timing object">§ 9.4 Procedure: Associate timing text track with a timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-110" title="§ 9.5 Procedure: Track marches on">§ 9.5 Procedure: Track marches on</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-111" title="§ A. Implementation guidelines multi-device synchronization">§ A. Implementation guidelines multi-device synchronization</a> <a href="#ref-for-dfn-timing-object-112" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-113" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-114" title="§ A.1 State vector synchronization">§ A.1 State vector synchronization</a> <a href="#ref-for-dfn-timing-object-115" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-116" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-object-117" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-object-118" title="§ A.2 Clock synchronization">§ A.2 Clock synchronization</a> <a href="#ref-for-dfn-timing-object-119" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-object-120" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-object-121" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-timing-provider-source" aria-label="Links in this document to definition: timing provider source">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-timing-provider-source" aria-label="Permalink for definition: timing provider source. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-timing-provider-source-1" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-timing-provider-source-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-source-3" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> <a href="#ref-for-dfn-timing-provider-source-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-source-5" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> <a href="#ref-for-dfn-timing-provider-source-6" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-source-7" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> <a href="#ref-for-dfn-timing-provider-source-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-provider-source-9" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-source-10" title="§ 5.8 Translate timestamp from user agent to timing resource provider timeline">§ 5.8 Translate timestamp from user agent to timing resource provider timeline</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-source-11" title="§ 5.9 Translate timestamp from timing resource provider to user agent timeline">§ 5.9 Translate timestamp from timing resource provider to user agent timeline</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-source-12" title="§ 6.5 Report an error">§ 6.5 Report an error</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-clock-skew" aria-label="Links in this document to definition: internal clock skew">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-clock-skew" aria-label="Permalink for definition: internal clock skew. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-clock-skew-1" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-clock-skew-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-clock-skew-3" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-clock-skew-4" title="§ 5.7 Process Skew Change">§ 5.7 Process Skew Change</a> <a href="#ref-for-dfn-clock-skew-5" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-clock-skew-6" title="§ 5.10 Calculate skew adjustment">§ 5.10 Calculate skew adjustment</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-internal-vector" aria-label="Links in this document to definition: internal vector">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-internal-vector" aria-label="Permalink for definition: internal vector. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-internal-vector-1" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-internal-vector-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-internal-vector-3" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-vector-4" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> <a href="#ref-for-dfn-internal-vector-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-internal-vector-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-internal-vector-7" title="Reference 4">(4)</a> <a href="#ref-for-dfn-internal-vector-8" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-vector-9" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> <a href="#ref-for-dfn-internal-vector-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-internal-vector-11" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-vector-12" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> <a href="#ref-for-dfn-internal-vector-13" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-vector-14" title="§ 5.6 Process Vector Change">§ 5.6 Process Vector Change</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-vector-15" title="§ 5.12 Event handlers">§ 5.12 Event handlers</a> 
    </li><li>
      <a href="#ref-for-dfn-internal-vector-16" title="§ 7. State Vector">§ 7. State Vector</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-state" aria-label="Links in this document to definition: state">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-state" aria-label="Permalink for definition: state. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-state-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dfn-state-2" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> <a href="#ref-for-dfn-state-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-state-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-state-5" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-state-6" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> 
    </li><li>
      <a href="#ref-for-dfn-state-7" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-start-position" aria-label="Links in this document to definition: start position">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-start-position" aria-label="Permalink for definition: start position. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-start-position-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dfn-start-position-2" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> <a href="#ref-for-dfn-start-position-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-start-position-4" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-end-position" aria-label="Links in this document to definition: end position">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-end-position" aria-label="Permalink for definition: end position. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-end-position-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dfn-end-position-2" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> <a href="#ref-for-dfn-end-position-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-end-position-4" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-range" aria-label="Links in this document to definition: range">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-range" aria-label="Permalink for definition: range. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-range-1" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-range-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-range-3" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> <a href="#ref-for-dfn-range-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-range-5" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> 
    </li><li>
      <a href="#ref-for-dfn-range-6" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dfn-range-7" title="§ 5.4 Set the internal timeout">§ 5.4 Set the internal timeout</a> 
    </li><li>
      <a href="#ref-for-dfn-range-8" title="§ 5.5 Cover a position">§ 5.5 Cover a position</a> <a href="#ref-for-dfn-range-9" title="Reference 2">(2)</a> <a href="#ref-for-dfn-range-10" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-current-range-timeout" aria-label="Links in this document to definition: current range timeout">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-current-range-timeout" aria-label="Permalink for definition: current range timeout. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-current-range-timeout-1" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> 
    </li><li>
      <a href="#ref-for-dfn-current-range-timeout-2" title="§ 5.4 Set the internal timeout">§ 5.4 Set the internal timeout</a> <a href="#ref-for-dfn-current-range-timeout-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-current-range-timeout-4" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject" aria-label="Links in this document to definition: TimingObject">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject" aria-label="Permalink for definition: TimingObject. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-1" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> <a href="#ref-for-dom-timingobject-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-timingobject-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-timingobject-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-5" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-6" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-7" title="§ 5.4 Set the internal timeout">§ 5.4 Set the internal timeout</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-8" title="§ 5.6 Process Vector Change">§ 5.6 Process Vector Change</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-9" title="§ 5.7 Process Skew Change">§ 5.7 Process Skew Change</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-10" title="§ 5.11 Connection states">§ 5.11 Connection states</a> <a href="#ref-for-dom-timingobject-11" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-12" title="§ 5.12 Event handlers">§ 5.12 Event handlers</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-13" title="§ 6.1 Process an update operation">§ 6.1 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-14" title="§ 6.5 Report an error">§ 6.5 Report an error</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-15" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> <a href="#ref-for-dom-timingobject-16" title="Reference 2">(2)</a> <a href="#ref-for-dom-timingobject-17" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-18" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-19" title="§ C. IDL Index">§ C. IDL Index</a> <a href="#ref-for-dom-timingobject-20" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-constructor" aria-label="Links in this document to definition: constructor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-constructor" aria-label="Permalink for definition: constructor. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-constructor!overload-1" aria-label="Links in this document to definition: constructor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-constructor!overload-1" aria-label="Permalink for definition: constructor. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-startposition" aria-label="Links in this document to definition: startPosition">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-startposition" aria-label="Permalink for definition: startPosition. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-448118520">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-startposition-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-startposition-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-endposition" aria-label="Links in this document to definition: endPosition">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-endposition" aria-label="Permalink for definition: endPosition. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-448118520">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-endposition-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-endposition-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-readystate" aria-label="Links in this document to definition: readyState">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-readystate" aria-label="Permalink for definition: readyState. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-448118520">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-readystate-1" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dom-timingobject-readystate-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-readystate-3" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-timingprovidersource" aria-label="Links in this document to definition: timingProviderSource">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-timingprovidersource" aria-label="Permalink for definition: timingProviderSource. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-448118520">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-timingprovidersource-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-timingprovidersource-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-observe" aria-label="Links in this document to definition: observe">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-observe" aria-label="Permalink for definition: observe. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-observe-1" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> <a href="#ref-for-dfn-observe-2" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-stop-observing" aria-label="Links in this document to definition: stop observing">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-stop-observing" aria-label="Permalink for definition: stop observing. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-stop-observing-1" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-query" aria-label="Links in this document to definition: query">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-query" aria-label="Permalink for definition: query. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-448118520">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-query-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-query-2" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-query-3" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-query-4" title="§ 5.10 Calculate skew adjustment">§ 5.10 Calculate skew adjustment</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-query-5" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-update" aria-label="Links in this document to definition: update">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-update" aria-label="Permalink for definition: update. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-448118520">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-update-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-update-2" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-update-3" title="§ 6.1 Process an update operation">§ 6.1 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-update-4" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-set-the-internal-timeout" aria-label="Links in this document to definition: set the internal timeout">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-set-the-internal-timeout" aria-label="Permalink for definition: set the internal timeout. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-set-the-internal-timeout-1" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-set-the-internal-timeout-2" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dfn-set-the-internal-timeout-3" title="§ 5.6 Process Vector Change">§ 5.6 Process Vector Change</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cover" aria-label="Links in this document to definition: covers">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-cover" aria-label="Permalink for definition: covers. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-cover-1" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-cover-2" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> 
    </li><li>
      <a href="#ref-for-dfn-cover-3" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-process-vector-change" aria-label="Links in this document to definition: process vector change">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-process-vector-change" aria-label="Permalink for definition: process vector change. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-process-vector-change-1" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-process-skew-change" aria-label="Links in this document to definition: process skew change">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-process-skew-change" aria-label="Permalink for definition: process skew change. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-process-skew-change-1" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-translate_u2p" aria-label="Links in this document to definition: tp = translate_u2p(tu)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-translate_u2p" aria-label="Permalink for definition: tp = translate_u2p(tu). Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-translate_u2p-1" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> 
    </li><li>
      <a href="#ref-for-dfn-translate_u2p-2" title="§ 5.8 Translate timestamp from user agent to timing resource provider timeline">§ 5.8 Translate timestamp from user agent to timing resource provider timeline</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-translate_p2u" aria-label="Links in this document to definition: tu = translate_p2u(tp)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-translate_p2u" aria-label="Permalink for definition: tu = translate_p2u(tp). Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-translate_p2u-1" title="§ 5.9 Translate timestamp from timing resource provider to user agent timeline">§ 5.9 Translate timestamp from timing resource provider to user agent timeline</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-calculate_skew_adjustment" aria-label="Links in this document to definition: calculate_skew_adjustment()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-calculate_skew_adjustment" aria-label="Permalink for definition: calculate_skew_adjustment(). Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-calculate_skew_adjustment-1" title="§ 5.7 Process Skew Change">§ 5.7 Process Skew Change</a> 
    </li><li>
      <a href="#ref-for-dfn-calculate_skew_adjustment-2" title="§ 5.8 Translate timestamp from user agent to timing resource provider timeline">§ 5.8 Translate timestamp from user agent to timing resource provider timeline</a> 
    </li><li>
      <a href="#ref-for-dfn-calculate_skew_adjustment-3" title="§ 5.9 Translate timestamp from timing resource provider to user agent timeline">§ 5.9 Translate timestamp from timing resource provider to user agent timeline</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobjectstate" aria-label="Links in this document to definition: TimingObjectState">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobjectstate" aria-label="Permalink for definition: TimingObjectState. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobjectstate-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingobjectstate-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobjectstate-connecting" aria-label="Links in this document to definition: connecting">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobjectstate-connecting" aria-label="Permalink for definition: connecting. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-2141639081">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobjectstate-connecting-1" title="§ 5.11 Connection states">§ 5.11 Connection states</a> 
    </li><li>
      <a href="#ref-for-dom-timingobjectstate-connecting-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobjectstate-open" aria-label="Links in this document to definition: open">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobjectstate-open" aria-label="Permalink for definition: open. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-2141639081">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobjectstate-open-1" title="§ 5.11 Connection states">§ 5.11 Connection states</a> 
    </li><li>
      <a href="#ref-for-dom-timingobjectstate-open-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobjectstate-closing" aria-label="Links in this document to definition: closing">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobjectstate-closing" aria-label="Permalink for definition: closing. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-2141639081">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobjectstate-closing-1" title="§ 5.11 Connection states">§ 5.11 Connection states</a> 
    </li><li>
      <a href="#ref-for-dom-timingobjectstate-closing-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobjectstate-closed" aria-label="Links in this document to definition: closed">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobjectstate-closed" aria-label="Permalink for definition: closed. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-2141639081">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobjectstate-closed-1" title="§ 5.11 Connection states">§ 5.11 Connection states</a> 
    </li><li>
      <a href="#ref-for-dom-timingobjectstate-closed-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-allowed-state-transitions" aria-label="Links in this document to definition: allowed state transitions">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-allowed-state-transitions" aria-label="Permalink for definition: allowed state transitions. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-allowed-state-transitions-1" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-onchange" aria-label="Links in this document to definition: onchange">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-onchange" aria-label="Permalink for definition: onchange. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-448118520">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-onchange-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-onchange-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-onreadystatechange" aria-label="Links in this document to definition: onreadystatechange">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-onreadystatechange" aria-label="Permalink for definition: onreadystatechange. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-448118520">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-onreadystatechange-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-onreadystatechange-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-ontimeupdate" aria-label="Links in this document to definition: ontimeupdate">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-ontimeupdate" aria-label="Permalink for definition: ontimeupdate. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-448118520">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-ontimeupdate-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-ontimeupdate-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingobject-onerror" aria-label="Links in this document to definition: onerror">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingobject-onerror" aria-label="Permalink for definition: onerror. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-448118520">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingobject-onerror-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingobject-onerror-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-error" aria-label="Links in this document to definition: error">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-error" aria-label="Permalink for definition: error. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-error-1" title="§ 6.5 Report an error">§ 6.5 Report an error</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-timing-provider-object" aria-label="Links in this document to definition: timing provider object">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-timing-provider-object" aria-label="Permalink for definition: timing provider object. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-timing-provider-object-1" title="§ 1.5 Connecting the timing object">§ 1.5 Connecting the timing object</a> <a href="#ref-for-dfn-timing-provider-object-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-object-3" title="§ 3. Terminology">§ 3. Terminology</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-object-4" title="§ 4.7 Connect to a timing provider">§ 4.7 Connect to a timing provider</a> <a href="#ref-for-dfn-timing-provider-object-5" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-object-6" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-timing-provider-object-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-provider-object-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-provider-object-9" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-provider-object-10" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-object-11" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-object-12" title="§ 5.10 Calculate skew adjustment">§ 5.10 Calculate skew adjustment</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-object-13" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> <a href="#ref-for-dfn-timing-provider-object-14" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-provider-object-15" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-provider-object-16" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-provider-object-17" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-object-18" title="§ 6.1 Process an update operation">§ 6.1 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-object-19" title="§ A. Implementation guidelines multi-device synchronization">§ A. Implementation guidelines multi-device synchronization</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-provider-object-20" title="§ A.2 Clock synchronization">§ A.2 Clock synchronization</a> <a href="#ref-for-dfn-timing-provider-object-21" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-skew" aria-label="Links in this document to definition: skew">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-skew" aria-label="Permalink for definition: skew. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-skew-1" title="§ 3. Terminology">§ 3. Terminology</a> 
    </li><li>
      <a href="#ref-for-dfn-skew-2" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> <a href="#ref-for-dfn-skew-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-skew-4" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingprovider" aria-label="Links in this document to definition: TimingProvider">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingprovider" aria-label="Permalink for definition: TimingProvider. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingprovider-1" title="§ 1.5 Connecting the timing object">§ 1.5 Connecting the timing object</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-2" title="§ 2. Conformance">§ 2. Conformance</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-3" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dom-timingprovider-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-5" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> <a href="#ref-for-dom-timingprovider-6" title="Reference 2">(2)</a> <a href="#ref-for-dom-timingprovider-7" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-8" title="§ 5.11 Connection states">§ 5.11 Connection states</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-9" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-10" title="§ 6.2 Report new conditions of the current motion">§ 6.2 Report new conditions of the current motion</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-11" title="§ 6.3 Report a state change">§ 6.3 Report a state change</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-12" title="§ 6.4 Report a skew change">§ 6.4 Report a skew change</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-13" title="§ 6.5 Report an error">§ 6.5 Report an error</a> <a href="#ref-for-dom-timingprovider-14" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-15" title="§ 7.1 Create a new state vector">§ 7.1 Create a new state vector</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-16" title="§ C. IDL Index">§ C. IDL Index</a> <a href="#ref-for-dom-timingprovider-17" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingprovider-vector" aria-label="Links in this document to definition: vector">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingprovider-vector" aria-label="Permalink for definition: vector. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-890123178">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingprovider-vector-1" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-vector-2" title="§ 6.2 Report new conditions of the current motion">§ 6.2 Report new conditions of the current motion</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-vector-3" title="§ 7.1 Create a new state vector">§ 7.1 Create a new state vector</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-vector-4" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingprovider-startposition" aria-label="Links in this document to definition: startPosition">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingprovider-startposition" aria-label="Permalink for definition: startPosition. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-890123178">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingprovider-startposition-1" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-startposition-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingprovider-endposition" aria-label="Links in this document to definition: endPosition">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingprovider-endposition" aria-label="Permalink for definition: endPosition. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-890123178">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingprovider-endposition-1" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-endposition-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingprovider-readystate" aria-label="Links in this document to definition: readyState">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingprovider-readystate" aria-label="Permalink for definition: readyState. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-890123178">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingprovider-readystate-1" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-readystate-2" title="§ 6.3 Report a state change">§ 6.3 Report a state change</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-readystate-3" title="§ 6.5 Report an error">§ 6.5 Report an error</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-readystate-4" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingprovider-skew" aria-label="Links in this document to definition: skew">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingprovider-skew" aria-label="Permalink for definition: skew. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-890123178">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingprovider-skew-1" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-skew-2" title="§ 6.4 Report a skew change">§ 6.4 Report a skew change</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-skew-3" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingprovider-update" aria-label="Links in this document to definition: update">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingprovider-update" aria-label="Permalink for definition: update. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-890123178">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingprovider-update-1" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingprovider-update-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-state-vector" aria-label="Links in this document to definition: state vector">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-state-vector" aria-label="Permalink for definition: state vector. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-state-vector-1" title="§ 3. Terminology">§ 3. Terminology</a> 
    </li><li>
      <a href="#ref-for-dfn-state-vector-2" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dfn-state-vector-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-state-vector-4" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-state-vector-5" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> <a href="#ref-for-dfn-state-vector-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-state-vector-7" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-state-vector-8" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> <a href="#ref-for-dfn-state-vector-9" title="Reference 2">(2)</a> <a href="#ref-for-dfn-state-vector-10" title="Reference 3">(3)</a> <a href="#ref-for-dfn-state-vector-11" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-state-vector-12" title="§ 6.1 Process an update operation">§ 6.1 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dfn-state-vector-13" title="§ 6.2 Report new conditions of the current motion">§ 6.2 Report new conditions of the current motion</a> 
    </li><li>
      <a href="#ref-for-dfn-state-vector-14" title="§ 7. State Vector">§ 7. State Vector</a> <a href="#ref-for-dfn-state-vector-15" title="Reference 2">(2)</a> <a href="#ref-for-dfn-state-vector-16" title="Reference 3">(3)</a> <a href="#ref-for-dfn-state-vector-17" title="Reference 4">(4)</a> <a href="#ref-for-dfn-state-vector-18" title="Reference 5">(5)</a> <a href="#ref-for-dfn-state-vector-19" title="Reference 6">(6)</a> <a href="#ref-for-dfn-state-vector-20" title="Reference 7">(7)</a> <a href="#ref-for-dfn-state-vector-21" title="Reference 8">(8)</a> 
    </li><li>
      <a href="#ref-for-dfn-state-vector-22" title="§ A. Implementation guidelines multi-device synchronization">§ A. Implementation guidelines multi-device synchronization</a> 
    </li><li>
      <a href="#ref-for-dfn-state-vector-23" title="§ A.1 State vector synchronization">§ A.1 State vector synchronization</a> <a href="#ref-for-dfn-state-vector-24" title="Reference 2">(2)</a> <a href="#ref-for-dfn-state-vector-25" title="Reference 3">(3)</a> 
    </li><li>
      <a href="#ref-for-dfn-state-vector-26" title="§ A.2 Clock synchronization">§ A.2 Clock synchronization</a> <a href="#ref-for-dfn-state-vector-27" title="Reference 2">(2)</a> <a href="#ref-for-dfn-state-vector-28" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevectorupdate" aria-label="Links in this document to definition: TimingStateVectorUpdate">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevectorupdate" aria-label="Permalink for definition: TimingStateVectorUpdate. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingstatevectorupdate-1" title="§ 5. Timing Object">§ 5. Timing Object</a> <a href="#ref-for-dom-timingstatevectorupdate-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevectorupdate-3" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevectorupdate-4" title="§ 7. State Vector">§ 7. State Vector</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevectorupdate-5" title="§ C. IDL Index">§ C. IDL Index</a> <a href="#ref-for-dom-timingstatevectorupdate-6" title="Reference 2">(2)</a> <a href="#ref-for-dom-timingstatevectorupdate-7" title="Reference 3">(3)</a> <a href="#ref-for-dom-timingstatevectorupdate-8" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevectorupdate-position" aria-label="Links in this document to definition: position">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevectorupdate-position" aria-label="Permalink for definition: position. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevectorupdate-velocity" aria-label="Links in this document to definition: velocity">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevectorupdate-velocity" aria-label="Permalink for definition: velocity. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevectorupdate-acceleration" aria-label="Links in this document to definition: acceleration">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevectorupdate-acceleration" aria-label="Permalink for definition: acceleration. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevectorinit" aria-label="Links in this document to definition: TimingStateVectorInit">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevectorinit" aria-label="Permalink for definition: TimingStateVectorInit. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingstatevectorinit-1" title="§ 7. State Vector">§ 7. State Vector</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevectorinit-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevectorinit-timestamp" aria-label="Links in this document to definition: timestamp">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevectorinit-timestamp" aria-label="Permalink for definition: timestamp. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevector" aria-label="Links in this document to definition: TimingStateVector">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevector" aria-label="Permalink for definition: TimingStateVector. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingstatevector-1" title="§ 5. Timing Object">§ 5. Timing Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-2" title="§ 5.1 Create a new timing object">§ 5.1 Create a new timing object</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-3" title="§ 5.2 Process a query operation">§ 5.2 Process a query operation</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-4" title="§ 5.3 Process an update operation">§ 5.3 Process an update operation</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-5" title="§ 6. Timing Provider Object">§ 6. Timing Provider Object</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-6" title="§ 6.2 Report new conditions of the current motion">§ 6.2 Report new conditions of the current motion</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-7" title="§ 7.1 Create a new state vector">§ 7.1 Create a new state vector</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-8" title="§ C. IDL Index">§ C. IDL Index</a> <a href="#ref-for-dom-timingstatevector-9" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevector-constructor" aria-label="Links in this document to definition: constructor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevector-constructor" aria-label="Permalink for definition: constructor. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevector-position" aria-label="Links in this document to definition: position">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevector-position" aria-label="Permalink for definition: position. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-104903223">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingstatevector-position-1" title="§ 7. State Vector">§ 7. State Vector</a> <a href="#ref-for-dom-timingstatevector-position-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-position-3" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevector-velocity" aria-label="Links in this document to definition: velocity">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevector-velocity" aria-label="Permalink for definition: velocity. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-104903223">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingstatevector-velocity-1" title="§ 7. State Vector">§ 7. State Vector</a> <a href="#ref-for-dom-timingstatevector-velocity-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-velocity-3" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevector-acceleration" aria-label="Links in this document to definition: acceleration">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevector-acceleration" aria-label="Permalink for definition: acceleration. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-104903223">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingstatevector-acceleration-1" title="§ 7. State Vector">§ 7. State Vector</a> <a href="#ref-for-dom-timingstatevector-acceleration-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-acceleration-3" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingstatevector-timestamp" aria-label="Links in this document to definition: timestamp">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingstatevector-timestamp" aria-label="Permalink for definition: timestamp. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-104903223">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingstatevector-timestamp-1" title="§ 7. State Vector">§ 7. State Vector</a> <a href="#ref-for-dom-timingstatevector-timestamp-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dom-timingstatevector-timestamp-3" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-default-playback-mode" aria-label="Links in this document to definition: default playback mode">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-default-playback-mode" aria-label="Permalink for definition: default playback mode. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-default-playback-mode-1" title="§ 8.1 Introduction">§ 8.1 Introduction</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-timed-playback-mode" aria-label="Links in this document to definition: timed playback mode">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-timed-playback-mode" aria-label="Permalink for definition: timed playback mode. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-timed-playback-mode-1" title="§ 8.1 Introduction">§ 8.1 Introduction</a> <a href="#ref-for-dfn-timed-playback-mode-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timed-playback-mode-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timed-playback-mode-4" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-timed-playback-mode-5" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-current-timing-source" aria-label="Links in this document to definition: current timing source">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-current-timing-source" aria-label="Permalink for definition: current timing source. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-current-timing-source-1" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> <a href="#ref-for-dfn-current-timing-source-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-current-timing-source-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-current-timing-source-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-current-timing-source-5" title="Reference 5">(5)</a> 
    </li><li>
      <a href="#ref-for-dfn-current-timing-source-6" title="§ 8.3 Procedure: Set the current media controller for media element">§ 8.3 Procedure: Set the current media controller for media element</a> 
    </li><li>
      <a href="#ref-for-dfn-current-timing-source-7" title="§ 8.4 Procedure: Set the current position for media element">§ 8.4 Procedure: Set the current position for media element</a> <a href="#ref-for-dfn-current-timing-source-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-current-timing-source-9" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-htmlmediaelement-timingsrc" aria-label="Links in this document to definition: timingsrc">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-htmlmediaelement-timingsrc" aria-label="Permalink for definition: timingsrc. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-set-the-current-timing-object-for-the-media-element" aria-label="Links in this document to definition: set the current timing object for the media element">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-set-the-current-timing-object-for-the-media-element" aria-label="Permalink for definition: set the current timing object for the media element. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-set-the-current-timing-object-for-the-media-element-1" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-check-error-in-time-alignment" aria-label="Links in this document to definition: check error in time-alignment">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-check-error-in-time-alignment" aria-label="Permalink for definition: check error in time-alignment. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-check-error-in-time-alignment-1" title="§ 8.2 Procedure: Set the current timing object for media element.">§ 8.2 Procedure: Set the current timing object for media element.</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-sequencer" aria-label="Links in this document to definition: sequencing">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-sequencer" aria-label="Permalink for definition: sequencing. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-sequencer-1" title="§ 9.1 Introduction">§ 9.1 Introduction</a> <a href="#ref-for-dfn-sequencer-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-sequencer-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-sequencer-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-sequencer-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-sequencer-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-sequencer-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-sequencer-8" title="Reference 8">(8)</a> <a href="#ref-for-dfn-sequencer-9" title="Reference 9">(9)</a> <a href="#ref-for-dfn-sequencer-10" title="Reference 10">(10)</a> <a href="#ref-for-dfn-sequencer-11" title="Reference 11">(11)</a> <a href="#ref-for-dfn-sequencer-12" title="Reference 12">(12)</a> 
    </li><li>
      <a href="#ref-for-dfn-sequencer-13" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> <a href="#ref-for-dfn-sequencer-14" title="Reference 2">(2)</a> <a href="#ref-for-dfn-sequencer-15" title="Reference 3">(3)</a> <a href="#ref-for-dfn-sequencer-16" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-sequencer-17" title="§ 9.5 Procedure: Track marches on">§ 9.5 Procedure: Track marches on</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-timing-text-tracks" aria-label="Links in this document to definition: timing text track">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-timing-text-tracks" aria-label="Permalink for definition: timing text track. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-timing-text-tracks-1" title="§ 9.1 Introduction">§ 9.1 Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-text-tracks-2" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> <a href="#ref-for-dfn-timing-text-tracks-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-text-tracks-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-text-tracks-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-text-tracks-6" title="Reference 5">(5)</a> <a href="#ref-for-dfn-timing-text-tracks-7" title="Reference 6">(6)</a> <a href="#ref-for-dfn-timing-text-tracks-8" title="Reference 7">(7)</a> <a href="#ref-for-dfn-timing-text-tracks-9" title="Reference 8">(8)</a> <a href="#ref-for-dfn-timing-text-tracks-10" title="Reference 9">(9)</a> <a href="#ref-for-dfn-timing-text-tracks-11" title="Reference 10">(10)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-text-tracks-12" title="§ 9.3 Procedure: Create a new timing text track">§ 9.3 Procedure: Create a new timing text track</a> <a href="#ref-for-dfn-timing-text-tracks-13" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-text-tracks-14" title="§ 9.4 Procedure: Associate timing text track with a timing object">§ 9.4 Procedure: Associate timing text track with a timing object</a> <a href="#ref-for-dfn-timing-text-tracks-15" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-timing-text-tracks-16" title="§ 9.5 Procedure: Track marches on">§ 9.5 Procedure: Track marches on</a> <a href="#ref-for-dfn-timing-text-tracks-17" title="Reference 2">(2)</a> <a href="#ref-for-dfn-timing-text-tracks-18" title="Reference 3">(3)</a> <a href="#ref-for-dfn-timing-text-tracks-19" title="Reference 4">(4)</a> <a href="#ref-for-dfn-timing-text-tracks-20" title="Reference 5">(5)</a> <a href="#ref-for-dfn-timing-text-tracks-21" title="Reference 6">(6)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-current-sequencer" aria-label="Links in this document to definition: current sequencer">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-current-sequencer" aria-label="Permalink for definition: current sequencer. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-current-sequencer-1" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> 
    </li><li>
      <a href="#ref-for-dfn-current-sequencer-2" title="§ 9.4 Procedure: Associate timing text track with a timing object">§ 9.4 Procedure: Associate timing text track with a timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-current-sequencer-3" title="§ 9.5 Procedure: Track marches on">§ 9.5 Procedure: Track marches on</a> <a href="#ref-for-dfn-current-sequencer-4" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingtexttrack" aria-label="Links in this document to definition: TimingTextTrack">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingtexttrack" aria-label="Permalink for definition: TimingTextTrack. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingtexttrack-1" title="§ 9.3 Procedure: Create a new timing text track">§ 9.3 Procedure: Create a new timing text track</a> <a href="#ref-for-dom-timingtexttrack-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-timingtexttrack-3" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingtexttrack-constructor" aria-label="Links in this document to definition: constructor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingtexttrack-constructor" aria-label="Permalink for definition: constructor. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-timingtexttrack-timingsrc" aria-label="Links in this document to definition: timingsrc">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-timingtexttrack-timingsrc" aria-label="Permalink for definition: timingsrc. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1681600935">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dom-timingtexttrack-timingsrc-1" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> 
    </li><li>
      <a href="#ref-for-dom-timingtexttrack-timingsrc-2" title="§ C. IDL Index">§ C. IDL Index</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-associate-the-track-with-a-timing-object" aria-label="Links in this document to definition: associate the track with a timing object">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-associate-the-track-with-a-timing-object" aria-label="Permalink for definition: associate the track with a timing object. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-associate-the-track-with-a-timing-object-1" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-track-marches-on" aria-label="Links in this document to definition: track marches on">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-track-marches-on" aria-label="Permalink for definition: track marches on. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-track-marches-on-1" title="§ 9.2 Timing text track">§ 9.2 Timing text track</a> 
    </li><li>
      <a href="#ref-for-dfn-track-marches-on-2" title="§ 9.4 Procedure: Associate timing text track with a timing object">§ 9.4 Procedure: Associate timing text track with a timing object</a> 
    </li><li>
      <a href="#ref-for-dfn-track-marches-on-3" title="§ 9.5 Procedure: Track marches on">§ 9.5 Procedure: Track marches on</a> 
    </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>